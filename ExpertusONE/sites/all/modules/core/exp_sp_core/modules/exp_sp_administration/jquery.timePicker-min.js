(function(e){e.fn.timePicker=function(h){var i=e.extend({},e.fn.timePicker.defaults,h);return this.each(function(){e.timePicker(this,i);});};e.timePicker=function(j,h){var i=e(j)[0];return i.timePicker||(i.timePicker=new jQuery._timePicker(i,h));};e.timePicker.version="0.3";e._timePicker=function(s,n){var w=false;var u=false;var l=d(n.startTime,n);var q=d(n.endTime,n);var h="selected";var t="li."+h;e(s).attr("autocomplete","OFF");var k=[];var m=new Date(l);while(m<=q){k[k.length]=g(m,n);m=new Date(m.setMinutes(m.getMinutes()+n.step));}var v=e('<div class="time-picker'+(n.show24Hours?"":" time-picker-12hours")+'"></div>');var o=e("<ul></ul>");for(var p=0;p<k.length;p++){o.append("<li>"+k[p]+"</li>");}v.append(o);v.appendTo("body").hide();v.mouseover(function(){w=true;}).mouseout(function(){w=false;});e("li",o).mouseover(function(){if(!u){e(t,v).removeClass(h);e(this).addClass(h);}}).mousedown(function(){w=true;}).click(function(){f(s,this,v,n);w=false;});var r=function(){if(v.is(":visible")){return false;
}e("li",v).removeClass(h);var z=e(s).offset();v.css({top:z.top+s.offsetHeight,left:z.left});v.show();var B=s.value?b(s.value,n):l;var A=l.getHours()*60+l.getMinutes();var y=(B.getHours()*60+B.getMinutes())-A;var i=Math.round(y/n.step);var x=a(new Date(0,0,0,0,(i*n.step+A),0));x=(l<x&&x<=q)?x:l;var C=e("li:contains("+g(x,n)+")",v);if(C.length){C.addClass(h);v[0].scrollTop=C[0].offsetTop;}return true;};e(s).focus(r).click(r);e(s).blur(function(){if(!w){v.hide();}});var j=(e.browser.opera||e.browser.mozilla)?"keypress":"keydown";e(s)[j](function(B){var i;u=true;var A=v[0].scrollTop;switch(B.keyCode){case 38:if(r()){return false;}i=e(t,o);var y=i.prev().addClass(h)[0];if(y){i.removeClass(h);if(y.offsetTop<A){v[0].scrollTop=A-y.offsetHeight;}}else{i.removeClass(h);y=e("li:last",o).addClass(h)[0];v[0].scrollTop=y.offsetTop-y.offsetHeight;}return false;break;case 40:if(r()){return false;}i=e(t,o);var x=i.next().addClass(h)[0];if(x){i.removeClass(h);if(x.offsetTop+x.offsetHeight>A+v[0].offsetHeight){v[0].scrollTop=A+x.offsetHeight;
}}else{i.removeClass(h);x=e("li:first",o).addClass(h)[0];v[0].scrollTop=0;}return false;break;case 13:if(v.is(":visible")){var z=e(t,o)[0];f(s,z,v,n);}return false;break;case 27:v.hide();return false;break;}return true;});e(s).keyup(function(i){u=false;});this.getTime=function(){return b(s.value,n);};this.setTime=function(i){s.value=g(d(i,n),n);e(s).change();};};e.fn.timePicker.defaults={step:30,startTime:new Date(0,0,0,0,0,0),endTime:new Date(0,0,0,23,30,0),separator:":",show24Hours:true};function f(k,j,h,i){k.value=e(j).text();e(k).change();if(!e.browser.msie){k.focus();}h.hide();}function g(m,l){var k=m.getHours();var i=l.show24Hours?k:(((k+11)%12)+1);var j=m.getMinutes();return c(i)+l.separator+c(j)+(l.show24Hours?"":((k<12)?" AM":" PM"));}function c(h){return(h<10?"0":"")+h;}function d(h,i){return(typeof h=="object")?a(h):b(h,i);}function b(i,k){if(i){var m=i.split(k.separator);var h=parseFloat(m[0]);var j=parseFloat(m[1]);if(!k.show24Hours){if(h===12&&i.indexOf("AM")!==-1){h=0;}else{if(h!==12&&i.indexOf("PM")!==-1){h+=12;
}}}var l=new Date(0,0,0,h,j,0);return a(l);}return null;}function a(h){h.setFullYear(2001);h.setMonth(0);h.setDate(0);return h;}})(jQuery);