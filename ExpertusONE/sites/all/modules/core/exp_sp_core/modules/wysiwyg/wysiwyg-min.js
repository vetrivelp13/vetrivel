(function(a){Drupal.wysiwygInit=function(){if(/KDE/.test(navigator.vendor)){return;}jQuery.each(Drupal.wysiwyg.editor.init,function(b){this(jQuery.extend(true,{},Drupal.settings.wysiwyg.configs[b]));});};Drupal.behaviors.attachWysiwyg={attach:function(b,c){if(/KDE/.test(navigator.vendor)){return;}a(".wysiwyg",b).once("wysiwyg",function(){if(!this.id||typeof Drupal.settings.wysiwyg.triggers[this.id]==="undefined"){return;}var e=a(this);var f=Drupal.settings.wysiwyg.triggers[this.id];for(var d in f){f[d].format=d;f[d].trigger=this.id;f[d].field=f.field;}var d="format"+this.value;if(e.is(":input")){Drupal.wysiwygAttach(b,f[d]);a(document).ready(function(){setTimeout(function(){jQuery("#"+f.field+"_parent").show();if(jQuery("#"+f.field).hasClass("error")){a("table#"+f.field+"_tbl .mceIframeContainer").css("border-color","#f00");a("table#"+f.field+"_tbl .mceToolbar").css("border-color","#f00");a("table#"+f.field+"_tbl .mceLayout").css("border-color","#f00");}},30);});}if(e.is("select")){e.change(function(){Drupal.wysiwygDetach(b,f[d]);
d="format"+this.value;Drupal.wysiwygAttach(b,f[d]);a(document).ready(function(){setTimeout(function(){jQuery("#"+f.field+"_parent").show();if(jQuery("#"+f.field).hasClass("error")){a("table#"+f.field+"_tbl .mceIframeContainer").css("border-color","#f00");a("table#"+f.field+"_tbl .mceToolbar").css("border-color","#f00");a("table#"+f.field+"_tbl .mceLayout").css("border-color","#f00");}},30);});});}a("#"+f.field).parents("form").submit(function(g){if(g.isDefaultPrevented()){return;}Drupal.wysiwygDetach(b,f[d],"serialize");});});},detach:function(c,d,b){var e;if(b=="serialize"){e=a(".wysiwyg-processed",c);}else{e=a(".wysiwyg",c).removeOnce("wysiwyg");}e.each(function(){var f=Drupal.settings.wysiwyg.triggers[this.id];Drupal.wysiwygDetach(c,f,b);});}};Drupal.wysiwygAttach=function(b,c){if(typeof Drupal.wysiwyg.editor.attach[c.editor]=="function"){Drupal.wysiwyg.instances[c.field]={};jQuery.extend(Drupal.wysiwyg.instances[c.field],c);if(typeof Drupal.wysiwyg.editor.instance[c.editor]=="object"){jQuery.extend(Drupal.wysiwyg.instances[c.field],Drupal.wysiwyg.editor.instance[c.editor]);
}Drupal.wysiwyg.activeId=c.field;if(c.toggle){Drupal.wysiwygAttachToggleLink(b,c);}else{a("#wysiwyg-toggle-"+c.field).hide();}if(c.status){Drupal.wysiwyg.editor.attach[c.editor](b,c,(Drupal.settings.wysiwyg.configs[c.editor]?jQuery.extend(true,{},Drupal.settings.wysiwyg.configs[c.editor][c.format]):{}));}else{Drupal.wysiwyg.editor.attach.none(b,c);Drupal.wysiwyg.instances[c.field].editor="none";}}};Drupal.wysiwygDetach=function(c,e,b){if(typeof Drupal.wysiwyg.instances[e.field]=="undefined"){return;}b=b||"unload";var d=Drupal.wysiwyg.instances[e.field].editor;if(jQuery.isFunction(Drupal.wysiwyg.editor.detach[d])){Drupal.wysiwyg.editor.detach[d](c,e,b);}};Drupal.wysiwygAttachToggleLink=function(c,e){if(!a("#wysiwyg-toggle-"+e.field).length){var d=document.createTextNode(e.status?Drupal.settings.wysiwyg.disable:Drupal.settings.wysiwyg.enable);var b=document.createElement("a");a(b).attr({id:"wysiwyg-toggle-"+e.field,href:"javascript:void(0);"}).append(d);var f=document.createElement("div");
a(f).addClass("wysiwyg-toggle-wrapper").append(b);a("#"+e.field).after(f);}a("#wysiwyg-toggle-"+e.field).html(e.status?Drupal.settings.wysiwyg.disable:Drupal.settings.wysiwyg.enable).show().unbind("click.wysiwyg",Drupal.wysiwyg.toggleWysiwyg).bind("click.wysiwyg",{params:e,context:c},Drupal.wysiwyg.toggleWysiwyg);if(e.editor=="none"){a("#wysiwyg-toggle-"+e.field).hide();}};Drupal.wysiwyg.toggleWysiwyg=function(c){var b=c.data.context;var d=c.data.params;if(d.status){d.status=false;Drupal.wysiwygDetach(b,d);Drupal.wysiwyg.editor.attach.none(b,d);Drupal.wysiwyg.instances[d.field]=Drupal.wysiwyg.editor.instance.none;Drupal.wysiwyg.instances[d.field].editor="none";Drupal.wysiwyg.instances[d.field].field=d.field;a(this).html(Drupal.settings.wysiwyg.enable).blur();}else{Drupal.wysiwyg.editor.detach.none(b,d);d=Drupal.settings.wysiwyg.triggers[d.trigger]["format"+a("#"+d.trigger).val()];d.status=true;Drupal.wysiwygAttach(b,d);a(this).html(Drupal.settings.wysiwyg.disable).blur();}};Drupal.wysiwyg.getParams=function(d,g){var c=d.className.split(" ");
var g=g||{};for(var b=0;b<c.length;b++){if(c[b].substr(0,8)=="wysiwyg-"){var f=c[b].split("-");var e=f.slice(2).join("-");g[f[1]]=e;}}g.format="format"+g.format;g.status=parseInt(g.status,10);g.toggle=parseInt(g.toggle,10);g.resizable=parseInt(g.resizable,10);return g;};Drupal.wysiwygInit();a(document).bind("CToolsDetachBehaviors",function(c,b){Drupal.behaviors.attachWysiwyg.detach(b,{},"unload");});})(jQuery);