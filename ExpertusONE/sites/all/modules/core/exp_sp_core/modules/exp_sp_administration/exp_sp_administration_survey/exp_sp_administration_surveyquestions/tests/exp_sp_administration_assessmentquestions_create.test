<?php 
class AdministrationAssessmentQuestionCreateBase extends AdministrationAssessmentQuestionTestHelper
{
	public function createAssessmentQuestionTestCase($scope = 'all') {
		$ctoolModel = array(
				'modelWidth' => 890,
				'modelClass' => 'ctools-modal-ctools-admin-questions-addedit-style',
				'modelTitle' => t('Question'),
				'contentWidth' => 570,
				'contentMhight' => 335,
				'outerHeight' => 620,
				'outerWidth' => 336,
				'blockHeight' => 1232,
				'blockWidth' => 1343,
				'modelTop' => 150,
				'modelLeft' => 226.5,
				'docHeight' => 1232,
				'docWidth' => 1343
		);
		$this->addCtoolModelContent($ctoolModel);

		$modelContent = $this->content;
		
		// Based on the scope set the data to test
		if ($scope == 'all') {
			$testCases = $this->testcases['assessmentQuestionCreate'];
		} else {
			$testCases = array($this->testcases['assessmentQuestionCreate'][$scope]);
		}

		foreach($testCases as $test){
			
			debug('data to test : ' . print_r($test, 1));
			
			//Reset content with the ctool model
			$this->content = $modelContent;
				
			//Get empty form
			$post_field = array('wrapper'=>'paint-narrow-search-results');

			$out = $this->drupalPostAJAX(null, $edit,'Save','?q=/administration/assessment/assessmentquestions/ajax/addedit',array(),array(),'',$post_field);

			$this->verbose('Request to: ' . $this->getUrl() . '<hr />' . $this->content);

			// Do General validations
			$this->assertResponse(200,'Form Rended successfully');
			$webError = "Website encountered an unexpected error";
			$this->assertNoText(t($webError),'Web errors not found','catalog_admin');
			
			// select a options based on the question type
			$choiseSelected = $test["answerchoices[choices]"];
			unset($test["answerchoices[choices]"]);
			$this->drupalPostAJAX(null, $test, 'question_type');
			$test["answerchoices[choices]"] = $choiseSelected;
			
			// Save form
			$param = array(
					"form_id"=>"exp_sp_administration_question_addedit_form",
					"_triggering_element_name" 	=>"save",
					"_triggering_element_value"	=>"Save",
			);
				
			$post_field = array('submit'=>$param,	'wrapper'=>'survey-question-basic-addedit-form');

			$out = $this->drupalPostAJAX(null, $test,'Save','?q=system/ajax',array(),array(),'',$post_field);
				
				
			$this->verbose('Request to: ' . $this->getUrl() .	'<hr />' . $this->content);


			//Check if any error thrown
			$isError = $this->xpath('//div[@class="messages error"]//ul/li');
			$error = '';
			debug("ERROR STRINGS ");

			if(sizeOf($isError) > 0){
				$error = (string) $isError[0];
			}
			$this->assertResponse(200,'Form Repainted successfully');
			$txt = 'updated successfully.';
			$this->assertText(t($txt),'updated successfully.','catalog_admin');
			$this->assertNoText(t($error),'Error - '.$error,'catalog_admin');
			$webError = "Website encountered an unexpected error";
			$this->assertNoText(t($webError),'Web errors not found','catalog_admin');
		}
	}

}

class AdministrationAssessmentQuestionCreateAll extends AdministrationAssessmentQuestionCreateBase
{
	public static function getInfo() {
		return array(
				'name' => 'Administration - AssessmentQuestions - Create - All Tests',
				'description' => 'Module : exp_sp_administration_people',
				'group' => '1402 - Administration - Assessment - AssessmentQuestions - Create',
		);
	}
	
	public function testAssessmentQuestionsCreateAll() {
		$this->manageAdminAssessmentQuestions();
		debug('testAdminAssessmentQuestionsCreateAll called');
		$this->createAssessmentQuestionTestCase('all');
	}
}

class AdministrationAssessmentQuestionCreateCase1 extends AdministrationAssessmentQuestionCreateBase
{
	public static function getInfo() {
		return array(
				'name' => 'Administration - AssessmentQuestions - Create - Case 1',
				'description' => 'Module : exp_sp_administration_people',
				'group' => '1402 - Administration - Assessment - AssessmentQuestions - Create',
		);
	}

	public function testAssessmentQuestionsCreateCase1() {
		$this->manageAdminAssessmentQuestions();
		debug('testAssessmentQuestionsCreateCase1 called');
		$this->createAssessmentQuestionTestCase('st_case1');
	}
}

class AdministrationAssessmentQuestionCreateCase2 extends AdministrationAssessmentQuestionCreateBase
{
	public static function getInfo() {
		return array(
				'name' => 'Administration - AssessmentQuestions - Create - Case 2',
				'description' => 'Module : exp_sp_administration_people',
				'group' => '1402 - Administration - Assessment - AssessmentQuestions - Create',
		);
	}

	public function testAssessmentQuestionsCreateCase2() {
		$this->manageAdminAssessmentQuestions();
		debug('testAssessmentQuestionsCreateCase2 called');
		$this->createAssessmentQuestionTestCase('st_case2');
	}
}

?>