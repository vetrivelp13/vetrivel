var ADMIN_CALENDAR_PERM_LIST=null;var obj=EXPERTUS_SMARTPORTAL_AbstractDetailsWidget;var selDay=null;try{if(calendardata==undefined||calendardata==""){calendardata={classrooms:[]};}}catch(e){calendardata={classrooms:[]};}function getCurrentLanguage(){var a=Drupal.settings.user.language;if(a=="zh-hans"){a="zh-cn";}else{if(a=="ru"){a="ru";}else{if(a=="de"){a="de";}else{if(a=="es"){a="es";}else{if(a=="ja"){a="ja";}else{if(a=="ko"){a="ko";}else{if(a=="pt-pt"){a="pt";}else{if(a=="it"){a="it";}else{if(a=="fr"){a="fr";}}}}}}}}}return a;}$(document).ready(function(){if($('#block-system-main-menu a[href="/?q=admincalendar"]').hasClass("active")==false){$('#block-system-main-menu a[href="/?q=administration"]').addClass("active-trail active");$('#block-system-main-menu a[href="/?q=administration"]').parent().addClass("active-trail");}$(document).mouseup(function(b){if(b.target.id!="admin-dropdown-arrow"){$("#select-list-calendar-dropdown-list").hide();}});$.ajaxSetup({cache:false,xhr:function(){try{if(window.ActiveXObject){return new window.ActiveXObject("Microsoft.XMLHTTP");
}}catch(b){}return new window.XMLHttpRequest();}});lang=getCurrentLanguage();moment.locale(lang);if(ADMIN_CALENDAR_PERM_LIST==null){ADMIN_CALENDAR_PERM_LIST=Drupal.settings.cal.plist;}if($("#calendarprimaryview").size()==0){return;}var a=($.cookie("admincalendar_view")!=undefined&&$.cookie("admincalendar_view")!=null&&$.cookie("admincalendar_view")!="")?$.cookie("admincalendar_view").toString().replace(/"/g,""):"agendaDay";$newJquery("#calendarprimaryview").fullCalendar({header:{right:"",left:"prev,today,next",center:"agendaDay,basicWeek,month"},defaultView:a,editable:true,droppable:true,lang:lang,handleWindowResize:false,yearColumns:3,eventOrder:"title",nextDayThreshold:"00:00",height:665,views:{month:{eventLimit:4},basicWeek:{eventLimit:30,columnFormat:"ddd MM-DD-YYYY"},agendaDay:{eventLimit:false,slotDuration:"00:15:00",slotEventOverlap:false},year:{eventLimit:1}},buttonText:{month:Drupal.t("LBL913"),week:Drupal.t("LBL1069"),day:Drupal.t("LBL910")},dayRightclick:function(d,c,b){addObjectThroughAdmCalendar(d,c);
return false;},events:calendardata,dayClick:function(d,c,b){},eventLimitClick:function(f,l){var m=$newJquery("#calendarprimaryview").fullCalendar("getView");var q="";var g="fc-more-"+f.cellEl.row+f.cellEl.col;var c="fc-grid-"+f.cellEl.row+f.cellEl.col;var n=$newJquery("#calendarprimaryview").fullCalendar("getView").dayGrid;var d=f.cellEl.start;var k=n.getCellDayEl(f.cellEl);var o=$("#search_all_calendar_type-hidden").val();var p=moment(f.date).format("YYYY-MM-DD");var b=p;var h=moment(f.date).add(1,"days").format("YYYY-MM-DD");adminCalCreateLoader("calendarsummary");$.ajax({url:"/?q=administration/calendarviewapi",METHOD:"post",data:"type=more&narrowcaldaywise=true&startDate="+b+"&endDate="+b+"&search_type="+o,success:function(u){var t=JSON.parse(u);remEvents=removeExistingEvents(t,f.segs);$newJquery("#calendarprimaryview").fullCalendar("addEventSource",remEvents);$newJquery("#calendarprimaryview ."+c).addClass("events-attached");var v=n.getCellDayEl(f.cellEl);var r=n.getCellSegs(f.cellEl);
var s=n.resliceDaySegs(r,d);n.showSegPopover(f.cellEl,$newJquery("#calendarprimaryview ."+g),s);adminCalDestroyLoader("calendarsummary");}});},eventAfterAllRender:function(){var b=$newJquery("#calendarprimaryview").fullCalendar("getView");if($("#loader-container").length){$("#loader-container").hide();}$(".fc-widget-header").css("margin-right","0");if($("#calendarprimaryview .fc-today").size()==0){$("#calendarprimaryview .fc-today-button").addClass("notcurrent");}else{$("#calendarprimaryview .fc-today-button").removeClass("notcurrent");}var f=getCalendarCellAddImg("primary","");var d=getCalendarCellListImg("primary","");if(b.name=="month"){$("#calendarprimaryview .fc-day-number").each(function(){var k=0;if(isNaN($(this).html())){k=parseInt($newJquery(this).find(".date").html());}else{k=parseInt($(this).html());}$(this).html("<span class='date'>"+k+"</span><span class='more-dot'></span><span class='list-add-icons'>"+d+f+"</span>");});}else{if(b.name=="basicWeek"){$("#calendarprimaryview .fc-day-header").each(function(){var k=$(this).html();
var l=k.split(" ");var m=l[0]+" "+moment(l[1],"MM-DD-YYYY").format("DD/MM");if(k.indexOf("div")==-1){f=getCalendarCellAddImg("primary",l[1]);d=getCalendarCellListImg("primary",l[1]);$(this).html("<div class='date vtip' title='"+m+"'>"+m+"<span class='fade-out'></span></div><div class='list-add-icons'>"+d+f+"</div>");}});}else{if(b.name=="agendaDay"){var c=$newJquery("#calendarprimaryview").fullCalendar("getDate").format("MM-DD-YYYY");$("#calendarprimaryview .fc-day-header").each(function(){var k=$(this).html();if(k.indexOf("div")==-1){var m=$newJquery("#calendarprimaryview").fullCalendar("getDate").format("MM-DD-YYYY");f=getCalendarCellAddImg("primary",m);d=getCalendarCellListImg("primary",m);var l=$newJquery("#calendarprimaryview").fullCalendar("getDate").format("DD/MM");$(this).html("<div class='date' data-date='"+m+"'>"+k+" "+l+"</div><div class='list-add-icons'>"+d+f+"</div>");}});$(".fc-agendaDay-view .fc-day-grid .fc-week").css({"margin-right":"0px","border-right":"0px"});}}}attachEvents("#calendarprimaryview .fc-title a");
calendarallpopupclose();vtip();$.cookie("current_page","1#0~0#0~0#0",{expires:1});if($newJquery("#calendarprimaryview").fullCalendar("getView").name=="basicWeek"){var g=$newJquery("#calendarprimaryview").fullCalendar("getView").intervalStart.format("YYYY-MM-DD");$(".narrowcalendarrowselect").removeClass();$newJquery("#calendarnarrowview  td").find(".narrowcalendardayselect").removeClass("narrowcalendardayselect");$newJquery("#calendarnarrowview td").find("[data-date='"+g+"']").parent().addClass("narrowcalendarrowselect");}else{if($newJquery("#calendarprimaryview").fullCalendar("getView").name=="agendaDay"){$(".narrowcalendarrowselect").removeClass();$newJquery("#calendarnarrowview  td").find(".narrowcalendardayselect").removeClass("narrowcalendardayselect");var h=$newJquery("#calendarprimaryview").fullCalendar("getView").intervalStart.format("YYYY-MM-DD");$newJquery("#calendarnarrowview  td").find("[data-date='"+h+"']").addClass("narrowcalendardayselect");}else{$(".narrowcalendarrowselect").removeClass();
$newJquery("#calendarnarrowview  td").find(".narrowcalendardayselect").removeClass("narrowcalendardayselect");}}},dayRender:function(d,b){var c=$newJquery("#calendarprimaryview").fullCalendar("getView");},drop:function(f,m,n,h){var o=$newJquery("#calendarprimaryview").fullCalendar("clientEvents");var b=$(this).data("event");var c=getEventbyId(o,b);delta={dropdate:f.format("YYYY-MM-DD")};var d=c[0].start;var l=c[0].start.format("YYYY-MM-DD");var g=c[0].end;var p=c[0].end.format("YYYY-MM-DD");var k=g.diff(d,"days");c[0].start=moment(f);if(l!=p){c[0].end=moment(f).add("days",k);}displayDragConfirm(Drupal.t("ACLBL0040")+" &quot;"+c[0].title+"&quot;",c[0],delta,revertFuncDummy);},eventDrop:function(c,d,b){displayDragConfirm(Drupal.t("ACLBL0040")+" &quot;"+c.title+"&quot;",c,d,b);},eventRender:function(k,g){if(!eventCanBeDisplayed(k)){return false;}var b=$newJquery("#calendarprimaryview").fullCalendar("getView");if(b.name=="month"){var l=displayCalendarEvent(k,"");g.find(".fc-title").html(l);
}else{if(b.name=="agendaDay"){var l=displayCalendarEvent(k,"");var f=eventClass(k);g.find(".fc-title").html(l);if(k.type!="order"){var h=(k.startTime==undefined)?"":k.startTime;var c=(k.endTime==undefined)?"":k.endTime;eventStartTime=calTimeFormat(k.from_date,k.startTime);var d=k.title;g.find(".fc-bg").attr("title",$("<div/>").html(d).text());g.find(".fc-bg").addClass(k.dataType);g.find(".fc-bg").addClass(f+" vtip");}else{g.find(".fc-bg").removeClass("fc-bg");}}else{var l=displayCalendarEvent(k,"");g.find(".fc-title").html(l);}}},eventClick:function(d,c,b){$("#calendarprimaryview .fc-agenda-view .fc-bg").live("click",function(){$(this).prev(".fc-content").find(".titlelinkstyle").click();});},eventDragStart:function(d,c,f,b){$(this).find(".titletimestyle").removeAttr("title");$(this).find(".link").removeAttr("title").css("cursor","move");$(this).css("cursor","move");$("p#vtip").remove();},viewRender:function(d,f){if($.cookie("uri")==null){var h="?q=administration";}else{var h=$.cookie("uri");
}var g="<a class='cal_list_view' href='"+h+"'><span class='cal-list-view-img vtip' title='"+Drupal.t("ACLBL0027")+"'> </span></a>";var c="<a class='cal_export' href='javascript:void(0)' onClick='exportAdminCalendar();'><span class='cal-export-img vtip' title='"+Drupal.t("Export to CSV")+"'> </span></a>";var b="<a class='cal_print' href='javascript:void(0)' onClick='printAdminCalendar();'><span class='cal-print-img vtip' title='"+Drupal.t("Print as PDF")+"'> </span></a>";var k="<a class='cal_setting' id='admincalendarsettings' href='javascript:void(0)' onClick='displayAdminCalendarSettingsHideShow();' ><span class='cal-setting-img vtip' title='"+Drupal.t("LBL563")+"'> </span></a><div id='qtipdiv'></div>";if($("#qtipdiv").size()==0){$("#calendarprimaryview .fc-right").html(g+"&nbsp;"+c+"&nbsp;"+b+"&nbsp;"+k);}},eventDestroy:function(){}});$newJquery("#calendarnarrowview").fullCalendar({header:{right:"prev,next",left:"title",center:""},nextDayThreshold:"00:00:00",lang:lang,handleWindowResize:false,eventOrder:"title",prev:function(){},next:function(){},eventLimitClick:function(c,b){},eventRender:function(c,b){if(b.find(".more-dot").size()==0){b.find(".fc-title").html("<span class='more-dot'></span>");
}},eventAfterAllRender:function(){$("#calendarprimaryview .fc-agendaDay-view .fc-time-grid-container .fc-content-skeleton .fc-event-container > a.fc-event").addClass("set-day-event-width");var c=$(".set-day-event-width").width();c=c-2;$(".set-day-event-width").width(c);setTimeout(function(){var f=$(".set-day-event-width").length;var g=f*86;var h=732;if(g>h){$("#calendarprimaryview .fc-agendaDay-view .fc-scroller .fc-time-grid").css("width",g+100);}},300);$("#calendarnarrowview .fc-day-number").each(function(){var f=0;if(isNaN($(this).html())){f=parseInt($newJquery(this).find(".date").html());}else{f=parseInt($(this).html());}$(this).html("<span class='date'>"+f+"</span><span class='more-dot'></span>");});$("#calendarnarrowview  .fc-time").each(function(){$(this).html("");});if($("#calendarsummary").size()==0){$("#calendarnarrowview .fc-view-container").append("<div id='calendarsummary'></div>");}if($newJquery("#calendarprimaryview").fullCalendar("getView").name=="basicWeek"){var b=$newJquery("#calendarprimaryview").fullCalendar("getView").intervalStart.format("YYYY-MM-DD");
$(".narrowcalendarrowselect").removeClass();$newJquery("#calendarnarrowview  td").find(".narrowcalendardayselect").removeClass("narrowcalendardayselect");$newJquery("#calendarnarrowview  td").find("[data-date='"+b+"']").parent().addClass("narrowcalendarrowselect");}else{if($newJquery("#calendarprimaryview").fullCalendar("getView").name=="agendaDay"){$(".narrowcalendarrowselect").removeClass();$newJquery("#calendarnarrowview  td").find(".narrowcalendardayselect").removeClass("narrowcalendardayselect");var d=$newJquery("#calendarprimaryview").fullCalendar("getView").intervalStart.format("YYYY-MM-DD");$newJquery("#calendarnarrowview  td").find("[data-date='"+d+"']").addClass("narrowcalendardayselect");}else{$(".narrowcalendarrowselect").removeClass();$newJquery("#calendarnarrowview  td").find(".narrowcalendardayselect").removeClass("narrowcalendardayselect");}}highlightNarrowCalendarActiveDates();},dayClick:function(f,d,c){var g=f.format();selDay=g;$("#calendarsummary .today-events, #calendarsummary .tmrw-events").fadeOut();
var b=$newJquery("#calendarprimaryview").fullCalendar("getView");if(b.type=="agendaDay"){$newJquery("#calendarprimaryview").fullCalendar("gotoDate",g);getCalendarData({refreshMode:"both"});formatCalendarDataSummary(f.format("YYYY-MM-DD"),"",g);}else{if(b.type=="basicWeek"){formatCalendarDataSummary(f.format("YYYY-MM-DD"),"",g);}else{if(b.type=="month"){formatCalendarDataSummary(f.format("YYYY-MM-DD"),"",g);}}}},editable:true,eventLimit:1,events:calendardata});$(".fc-year-button").click(function(){$(".fc-year-monthly-td .fc-more-cell").html("");$(".active-qtip-div").remove();getCalendarData();});$(".fc-month-button, .fc-basicWeek-button, .fc-agendaDay-button").click(function(){$(".active-qtip-div").remove();getCalendarData();});$("#calendarprimaryview .fc-button-group .fc-button").click(function(){var b=$newJquery("#calendarprimaryview").fullCalendar("getView");$.cookie("admincalendar_view",b.type);selDay=null;});reArangeSearchFilter();});function highlightNarrowCalendarActiveDates(){$newJquery("#calendarnarrowview .fc-content-skeleton .fc-day-number").removeClass("dt-with-events");
var k=$newJquery("#calendarnarrowview").fullCalendar("getView").dayGrid.rowStructs;var h=k.length;var g,f=0;var d,b,a,c="";for(i=0;i<h;i++){d=k[i].segMatrix;b=k[i].segs;if(b.length>0){g=d.length;for(j=0;j<g;j++){a=d[j];f=a.length;for(var l in a){c="fc-grid-"+i+l;$newJquery("#calendarnarrowview .fc-content-skeleton ."+c).addClass("dt-with-events");}}}}}function acYearviewMonthCalCell(c,b,a){return"<div class='"+c+"-month-cal yearview' style='width:240px;height:350px;padding:5px;' month='"+c+"'></div>";}function buildACYearView(){$("#calendarprimaryview .fc-view-container").hide();$("#calendarprimaryview").parent().append("<div id='yearview' style='position:absolute;top:16px;left:210px;height:610px;margin-top:20px;overflow-y:auto;'></div>");var a="";a+="<table cellpadding=1 cellspacing=1>";a+="<tr><td style='vertical-align:top;'>";a+=acYearviewMonthCalCell("jan");a+="</td><td style='vertical-align:top;'>";a+=acYearviewMonthCalCell("feb");a+="</td><td style='vertical-align:top;'>";a+=acYearviewMonthCalCell("mar");
a+="</td></tr>";a+="<tr><td style='vertical-align:top;'>";a+=acYearviewMonthCalCell("apr");a+="</td><td style='vertical-align:top;'>";a+=acYearviewMonthCalCell("may");a+="</td><td style='vertical-align:top;'>";a+=acYearviewMonthCalCell("jun");a+="</td></tr>";a+="<tr><td style='vertical-align:top;'>";a+=acYearviewMonthCalCell("jul");a+="</td><td style='vertical-align:top;'>";a+=acYearviewMonthCalCell("aug");a+="</td><td style='vertical-align:top;'>";a+=acYearviewMonthCalCell("sep");a+="</td></tr>";a+="<tr><td style='vertical-align:top;'>";a+=acYearviewMonthCalCell("oct");a+="</td><td style='vertical-align:top;'>";a+=acYearviewMonthCalCell("nov");a+="</td><td style='vertical-align:top;'>";a+=acYearviewMonthCalCell("dec");a+="</td></tr>";a+="</table>";var b=$newJquery("#calendarnarrowview").fullCalendar("getDate");$("#yearview").html(a);$("#yearview .yearview").each(function(){var c=$(this).attr("month");$newJquery("."+c+"-month-cal").fullCalendar({header:{right:"",left:"",center:""},editable:false,droppable:false,lang:lang,contentHeight:340,handleWindowResize:false,eventLimitText:"...",eventLimit:1,nextDayThreshold:"00:00"});
});$("#yearview").attr("loaded","true");$("#yearview").attr("displayingyear",b.format("YYYY"));obj.destroyLoader("calendar");}function displayCalendarSummaryEventsList(b,c){var a="";if(b==undefined||b==null){a=$newJquery("#calendarnarrowview").fullCalendar("getDate");}else{a=moment(b);}var b=a.format("YYYY-MM-DD");formatCalendarDataSummary(b,c,b);}function attachEvents(a){$(a).not(".calendar-processed").each(function(){$(this).addClass("calendar-processed");var c={};c.url=$(this).attr("href");c.setClick=true;c.event="click";c.progress={type:"throbber"};c.keypress=true;c.effect="none";c.method="replaceWith";c.submit={js:true};var b=$(this).attr("id");if(c.url!="javascript:void(0)"){Drupal.ajax[b]=new Drupal.ajax(b,this,c);}});}function displayCalendarDataAfterRefresh(b,c){if($newJquery("#calendarprimaryview").fullCalendar("getView").name!="year"){var a=$newJquery("#calendarprimaryview").fullCalendar("getDate");adminCalDestroyLoader();calendardata=JSON.parse(b);$newJquery("#calendarprimaryview").fullCalendar("removeEvents");
$newJquery("#calendarnarrowview").fullCalendar("removeEvents");updateAdminCalendarEvents(calendardata,c);$newJquery("#calendarnarrowview").fullCalendar("gotoDate",a);attachEvents("#calendarprimaryview .fc-title a");if(selDay==null){displayCalendarSummaryEventsList();}if($newJquery("#calendarprimaryview").fullCalendar("getView").name=="month"){}}else{adminCalDestroyLoader();calendardata=JSON.parse(b);$newJquery("#calendarprimaryview").fullCalendar("removeEvents");updateAdminCalendarEvents(calendardata);}}function getCalendarData(g){checkSessionOut();var d=$newJquery("#calendarprimaryview").fullCalendar("getDate");var c=$newJquery("#calendarprimaryview").fullCalendar("getView");var a="";var f="";var g=(g instanceof Object)?g:{};a=$newJquery("#calendarprimaryview").fullCalendar("getView").start.format("YYYY-MM-DD");f=$newJquery("#calendarprimaryview").fullCalendar("getView").end.format("YYYY-MM-DD");adminCalCreateLoader();var b=getACSearchParams();$.ajax({url:"/?q=administration/calendarviewapi",METHOD:"post",data:"startDate="+a+"&endDate="+f+b,success:function(h){adminCalDestroyLoader();
displayCalendarDataAfterRefresh(h,g);}});$("#calendarlegendview").hide();}function getACSearchParams(){var c=$("#narrow-search-calendar-filter").val();var f=Drupal.t("LBL304").toUpperCase();var d=$("#search_all_calendar_type-hidden").val();var b="";var a=$newJquery("#calendarprimaryview").fullCalendar("getView").name;if((c.toLowerCase())==(f.toLowerCase())){b="&view="+a;}else{b="&search_text="+c+"&search_type="+d+"&view="+a;}return b;}function prevNarrowCalendarNavigation(){if($newJquery("#calendarprimaryview").fullCalendar("getView").name=="month"){$newJquery("#calendarprimaryview  .fc-prev-button").click();}else{var a=$newJquery("#calendarnarrowview").fullCalendar("getDate");$newJquery("#calendarprimaryview").fullCalendar("gotoDate",a.startOf("month"));}var b=$newJquery("#calendarnarrowview").fullCalendar("getDate");formatCalendarDataSummary(b.format("YYYY-MM-DD"),"",b);}function nextNarrowCalendarNavigation(){if($newJquery("#calendarprimaryview").fullCalendar("getView").name=="month"){$newJquery("#calendarprimaryview  .fc-next-button").click();
}else{var a=$newJquery("#calendarnarrowview").fullCalendar("getDate");$newJquery("#calendarprimaryview").fullCalendar("gotoDate",a.startOf("month"));}var b=$newJquery("#calendarnarrowview").fullCalendar("getDate");formatCalendarDataSummary(b.format("YYYY-MM-DD"),"",b);}$(document).ready(function(){attachEvents("#calendarprimaryview .fc-title a");vtip();getCalendarData({initialLoad:"true"});$newJquery(".fc-today-button").click(function(){$(".active-qtip-div").remove();getCalendarData();});$newJquery("#calendarnarrowview .fc-prev-button").click(function(){calendarallpopupclose();$(".active-qtip-div").remove();if($newJquery("#calendarprimaryview").fullCalendar("getView").name=="year"){var a=$newJquery("#calendarnarrowview").fullCalendar("getView").intervalStart;a=a.add("1","month");var c=parseInt(a.format("YYYY"),10)-1+"-"+a.format("MM-DD");$newJquery("#calendarnarrowview").fullCalendar("gotoDate",c);$newJquery("#calendarprimaryview").fullCalendar("gotoDate",c);return false;}if($newJquery("#calendarnarrowview  .fc-prev-button").attr("ajaxrequired")!="false"){var f=$newJquery("#calendarnarrowview").fullCalendar("getDate");
var a=$newJquery("#calendarnarrowview").fullCalendar("getView").start.format("YYYY-MM-DD");var d=$newJquery("#calendarnarrowview").fullCalendar("getView").end.format("YYYY-MM-DD");adminCalCreateLoader();var b=getACSearchParams();$.ajax({url:"/?q=administration/calendarviewapi",METHOD:"post",data:"startDate="+a+"&endDate="+d+b,success:function(g){adminCalDestroyLoader();calendardata=JSON.parse(g);$newJquery("#calendarprimaryview").fullCalendar("removeEvents");$newJquery("#calendarnarrowview").fullCalendar("removeEvents");updateAdminCalendarEvents(calendardata);$newJquery("#calendarprimaryview  .fc-prev-button").attr("ajaxrequired","false");prevNarrowCalendarNavigation();attachEvents("#calendarprimaryview .fc-title a");},failure:function(g){adminCalDestroyLoader();}});}else{$newJquery("#calendarnarrowview  .fc-prev-button").attr("ajaxrequired","true");}});$newJquery("#calendarprimaryview .fc-prev-button").click(function(){calendarallpopupclose();$("#calendarsummary .today-events, #calendarsummary .tmrw-events").fadeOut();
if($newJquery("#calendarprimaryview").fullCalendar("getView").name=="year"){var a=$newJquery("#calendarnarrowview").fullCalendar("getView").intervalStart;var c=parseInt(a.format("YYYY"),10)-1+"-"+a.format("MM-DD");$newJquery("#calendarnarrowview").fullCalendar("gotoDate",c);$newJquery("#calendarprimaryview").fullCalendar("gotoDate",c);return false;}if($newJquery("#calendarprimaryview  .fc-prev-button").attr("ajaxrequired")!="false"){adminCalCreateLoader();var d=$newJquery("#calendarprimaryview").fullCalendar("getDate");$newJquery("#calendarprimaryview").fullCalendar("removeEvents");$newJquery("#calendarnarrowview").fullCalendar("removeEvents");var a=$newJquery("#calendarprimaryview").fullCalendar("getView").start.format("YYYY-MM-DD");var f=$newJquery("#calendarprimaryview").fullCalendar("getView").end.format("YYYY-MM-DD");var b=getACSearchParams();$.ajax({url:"/?q=administration/calendarviewapi",METHOD:"post",data:"startDate="+a+"&endDate="+f+b,success:function(g){adminCalDestroyLoader();
calendardata=JSON.parse(g);prevNavigationDataProcessPrimary(calendardata);attachEvents("#calendarprimaryview .fc-title a");},failure:function(g){adminCalDestroyLoader();}});}else{$newJquery("#calendarprimaryview  .fc-prev-button").attr("ajaxrequired","true");}});$newJquery("#calendarnarrowview .fc-next-button").click(function(){calendarallpopupclose();$(".active-qtip-div").remove();if($newJquery("#calendarprimaryview").fullCalendar("getView").name=="year"){var a=$newJquery("#calendarnarrowview").fullCalendar("getView").intervalStart;a=a.add("-1","month");var c=parseInt(a.format("YYYY"),10)+1+"-"+a.format("MM-DD");$newJquery("#calendarnarrowview").fullCalendar("gotoDate",c);$newJquery("#calendarprimaryview").fullCalendar("gotoDate",c);return false;}if($newJquery("#calendarnarrowview  .fc-next-button").attr("ajaxrequired")!="false"){var f=$newJquery("#calendarnarrowview").fullCalendar("getDate");var a=$newJquery("#calendarnarrowview").fullCalendar("getView").start.format("YYYY-MM-DD");var d=$newJquery("#calendarnarrowview").fullCalendar("getView").end.format("YYYY-MM-DD");
adminCalCreateLoader();var b=getACSearchParams();$.ajax({url:"/?q=administration/calendarviewapi",METHOD:"post",data:"startDate="+a+"&endDate="+d+b,success:function(g){calendardata=JSON.parse(g);adminCalDestroyLoader();$newJquery("#calendarprimaryview").fullCalendar("removeEvents");$newJquery("#calendarnarrowview").fullCalendar("removeEvents");updateAdminCalendarEvents(calendardata);$newJquery("#calendarprimaryview  .fc-next-button").attr("ajaxrequired","false");nextNarrowCalendarNavigation();attachEvents("#calendarprimaryview .fc-title a");}});}else{$newJquery("#calendarnarrowview  .fc-next-button").attr("ajaxrequired","true");}});$newJquery("#calendarprimaryview .fc-next-button").click(function(){var d=$newJquery("#calendarprimaryview").fullCalendar("getDate");calendarallpopupclose();$("#calendarsummary .today-events, #calendarsummary .tmrw-events").fadeOut();if($newJquery("#calendarprimaryview").fullCalendar("getView").name=="year"){var a=$newJquery("#calendarnarrowview").fullCalendar("getView").intervalStart;
var c=parseInt(a.format("YYYY"),10)+1+"-"+a.format("MM-DD");$newJquery("#calendarnarrowview").fullCalendar("gotoDate",c);$newJquery("#calendarprimaryview").fullCalendar("gotoDate",c);return false;}var a=$newJquery("#calendarprimaryview").fullCalendar("getView").start.format("YYYY-MM-DD");if($newJquery("#calendarprimaryview  .fc-next-button").attr("ajaxrequired")!="false"){$newJquery("#calendarprimaryview").fullCalendar("removeEvents");$newJquery("#calendarnarrowview").fullCalendar("removeEvents");adminCalCreateLoader();var f=$newJquery("#calendarprimaryview").fullCalendar("getView").end.format("YYYY-MM-DD");var b=getACSearchParams();$.ajax({url:"/?q=administration/calendarviewapi",METHOD:"post",data:"startDate="+a+"&endDate="+f+b,success:function(g){adminCalDestroyLoader();calendardata=JSON.parse(g);nextNavigationDataProcessPrimary(calendardata);attachEvents("#calendarprimaryview .fc-title a");}});}else{$newJquery("#calendarprimaryview  .fc-next-button").attr("ajaxrequired","true");}});
});function prevNavigationDataProcessPrimary(a){var b=$newJquery("#calendarprimaryview").fullCalendar("getDate");var g=$newJquery("#calendarprimaryview").fullCalendar("getView").name;$newJquery("#calendarprimaryview").fullCalendar("removeEvents");$newJquery("#calendarnarrowview").fullCalendar("removeEvents");var f={refreshMode:"both"};updateAdminCalendarEvents(a,f);formatCalendarDataSummary(b.format("YYYY-MM-DD"),"",b);if(!$(".fc-basicWeek-button").hasClass("fc-state-active")&&!$(".fc-agendaDay-button").hasClass("fc-state-active")){$newJquery("#calendarnarrowview  .fc-prev-button").attr("ajaxrequired","false");$newJquery("#calendarnarrowview  .fc-prev-button").click();}else{var d=$newJquery("#calendarprimaryview").fullCalendar("getView").intervalStart.format("MM");var c=$newJquery("#calendarnarrowview").fullCalendar("getView").intervalStart.format("MM");if((d-c)!=0){$newJquery("#calendarnarrowview  .fc-prev-button").attr("ajaxrequired","false");$newJquery("#calendarnarrowview  .fc-prev-button").click();
}}attachEvents("#calendarprimaryview .fc-title a");}function nextNavigationDataProcessPrimary(a){var b=$newJquery("#calendarprimaryview").fullCalendar("getDate");var g=$newJquery("#calendarprimaryview").fullCalendar("getView").name;$newJquery("#calendarprimaryview").fullCalendar("removeEvents");$newJquery("#calendarnarrowview").fullCalendar("removeEvents");var f={refreshMode:"both"};updateAdminCalendarEvents(a,f);formatCalendarDataSummary(b.format("YYYY-MM-DD"),"",b);if(!$(".fc-basicWeek-button").hasClass("fc-state-active")&&!$(".fc-agendaDay-button").hasClass("fc-state-active")){$newJquery("#calendarnarrowview  .fc-next-button").attr("ajaxrequired","false");$newJquery("#calendarnarrowview  .fc-next-button").click();}else{var d=$newJquery("#calendarprimaryview").fullCalendar("getView").intervalStart.format("MM");var c=$newJquery("#calendarnarrowview").fullCalendar("getView").intervalStart.format("MM");if((d-c)!=0){$newJquery("#calendarnarrowview  .fc-next-button").attr("ajaxrequired","false");
$newJquery("#calendarnarrowview  .fc-next-button").click();}}attachEvents("#calendarprimaryview .fc-title a");}function updateAdminCalendarEvents(a,d){try{var c=(d!=undefined&&d.hasOwnProperty("refreshMode"))?d.refreshMode:"both";if(c=="primary"){$newJquery("#calendarprimaryview").fullCalendar("addEventSource",a);if($newJquery("#calendarprimaryview").fullCalendar("getView").name=="agendaDay"){applayJSScrollForDayView();}}else{if(c=="narrow"){$newJquery("#calendarnarrowview").fullCalendar("addEventSource",a);}else{$newJquery("#calendarprimaryview").fullCalendar("addEventSource",a);$newJquery("#calendarnarrowview").fullCalendar("addEventSource",a);if($newJquery("#calendarprimaryview").fullCalendar("getView").name=="agendaDay"){applayJSScrollForDayView();}}}}catch(b){}}function applayJSScrollForDayView(){$("#calendarprimaryview .fc-agendaDay-view .fc-scroller").jScrollPane();$("#calendarprimaryview .fc-agendaDay-view .fc-day-grid #fc-content-skeleton").jScrollPane();}function displayAdminCalendarSettingsHideShow(){calendarallpopupclose();
$(".active-qtip-div").remove();$("#qtipdiv").html(displayAdminCalendarSettings());var a=$.cookie("admincalendar_pref");a=JSON.parse(a);if(a.view_orders==false){$("#view_orders").prop("checked",false);}else{$("#view_orders").prop("checked",true);}if(a.view_locations==false){$("#view_locations").prop("checked",false);}else{$("#view_locations").prop("checked",true);}if(a.view_discussions==false){$("#view_discussions").prop("checked",false);}else{$("#view_discussions").prop("checked",true);}if(a.view_instructors==false){$("#view_instructors").prop("checked",false);}else{$("#view_instructors").prop("checked",true);}if(a.view_classroom==false){$("#view_classroom").prop("checked",false);}else{$("#view_classroom").prop("checked",true);}if(a.view_virtualclassroom==false){$("#view_virtualclassroom").prop("checked",false);}else{$("#view_virtualclassroom").prop("checked",true);}$("#admincalendarsettingdiv").show();}function getAndDisplayMonthData(a,b){}function displayAdminCalendarSettingsData(o){if(o=="session_out"){self.location="?q=user";
return;}var k=$.cookie("admincalendar_pref");k=JSON.parse(k);ADMIN_CALENDAR_PERM_LIST=o;if((ADMIN_CALENDAR_PERM_LIST.view_orders=="enabled")&&(ADMIN_CALENDAR_PERM_LIST.commerce==false)){ADMIN_CALENDAR_PERM_LIST.view_orders="disabled";}if((ADMIN_CALENDAR_PERM_LIST.view_discussions=="enabled")&&(ADMIN_CALENDAR_PERM_LIST.forum==false)){ADMIN_CALENDAR_PERM_LIST.view_discussions="disabled";}var g=(ADMIN_CALENDAR_PERM_LIST.view_classroom=="enabled")?"checked=checked":"disabled=disabled";var n=(ADMIN_CALENDAR_PERM_LIST.view_virtualclassroom=="enabled")?"checked=checked":"disabled=disabled";var b=(ADMIN_CALENDAR_PERM_LIST.view_orders=="enabled")?"checked=checked":"disabled=disabled";var m=(ADMIN_CALENDAR_PERM_LIST.view_scheduled_report=="enabled")?"checked=checked":"disabled=disabled";var f=(ADMIN_CALENDAR_PERM_LIST.view_locations=="enabled")?"checked=checked":"disabled=disabled";var l=(ADMIN_CALENDAR_PERM_LIST.view_discussions=="enabled")?"checked=checked":"disabled=disabled";var c=(ADMIN_CALENDAR_PERM_LIST.view_instructors=="enabled")?"checked=checked":"disabled=disabled";
if(ADMIN_CALENDAR_PERM_LIST.view_classroom=="enabled"&&k!=null&&k.view_classroom==false){g="";}if(ADMIN_CALENDAR_PERM_LIST.view_virtualclassroom=="enabled"&&k!=null&&k.view_virtualclassroom==false){n="";}if(ADMIN_CALENDAR_PERM_LIST.view_orders=="enabled"&&k!=null&&k.view_orders==false){b="";}if(ADMIN_CALENDAR_PERM_LIST.view_scheduled_report=="enabled"&&k!=null&&k.view_scheduled_report==false){m="";}if(ADMIN_CALENDAR_PERM_LIST.view_locations=="enabled"&&k!=null&&k.view_locations==false){f="";}if(ADMIN_CALENDAR_PERM_LIST.view_discussions=="enabled"&&k!=null&&k.view_discussions==false){l="";}if(ADMIN_CALENDAR_PERM_LIST.view_instructors=="enabled"&&k!=null&&k.view_instructors==false){c="";}var a=getCurrentLanguage();var h="";if(a=="ru"){h="lang-ru";}var d='<div id="admincalendarsettingdiv" class="'+h+'" style="display:block;">';d+='<div class="dropdownadd-dd-list-arrow"></div>';d+='<a  class="qtip-close-button account-close-popup"></a>';d+='<table cellspacing="0" cellpadding="0" id="bubble-face-table">';
d+="<tbody>";d+="<tr>";d+='<td class="bubble-tl"></td>';d+='<td class="bubble-t"></td>';d+='<td class="bubble-tr"></td>';d+="</tr>";d+="<tr>";d+='<td class="bubble-cl"></td>';d+='<td valign="top" class="bubble-c">';d+='<div class="links header-popup '+ADMIN_CALENDAR_PERM_LIST.view_classroom+'"><span class="vtip" title="'+Drupal.t("ACLBL0011")+'">'+Drupal.t("ACLBL0011")+'<span class="fadeout"></span></span>';d+='</div><span class="form-checkbox"><input  class="eventtypes" type="checkbox" id="view_classroom" '+g+"></input></span>";d+=' <div class="links header-popup '+ADMIN_CALENDAR_PERM_LIST.view_virtualclassroom+'"><span class="vtip" title="'+Drupal.t("ACLBL0012")+'">'+Drupal.t("ACLBL0012")+'<span class="fadeout"></span></span>';d+=' </div><span class="form-checkbox"><input  class="eventtypes" type="checkbox"  id="view_virtualclassroom" '+n+"></input></span>";d+=' <div class="links header-popup '+ADMIN_CALENDAR_PERM_LIST.view_orders+'"><span class="vtip" title="'+Drupal.t("ACLBL0015")+'">'+Drupal.t("ACLBL0015")+'<span class="fadeout"></span></span>';
d+=' </div><span class="form-checkbox"><input type="checkbox" id="view_orders" '+b+' class="eventtypes"></input></span>';d+=' <div class="links header-popup '+ADMIN_CALENDAR_PERM_LIST.view_scheduled_report+'"><span class="vtip" title="'+Drupal.t("ACLBL0016")+'">'+Drupal.t("ACLBL0016")+'<span class="fadeout"></span></span>';d+=' </div><span class="form-checkbox"><input type="checkbox" id="view_scheduled_report" '+m+' class="eventtypes"></input></span>';d+=' <div class="links header-popup '+ADMIN_CALENDAR_PERM_LIST.view_locations+'"><span class="vtip" title="'+Drupal.t("ACLBL0017")+'">'+Drupal.t("ACLBL0017")+'<span class="fadeout"></span></span>';d+=' </div><span class="form-checkbox"><input type="checkbox" id="view_locations" '+f+' class="eventtypes"></input></span>';d+=' <div class="links header-popup '+ADMIN_CALENDAR_PERM_LIST.view_instructors+'"><span class="vtip" title="'+Drupal.t("ACLBL0019")+'">'+Drupal.t("ACLBL0019")+'<span class="fadeout"></span></span>';d+=' </div><span class="form-checkbox"><input type="checkbox" id="view_instructors" '+c+' class="eventtypes"></input></span>';
d+=' <div class="links header-popup '+ADMIN_CALENDAR_PERM_LIST.view_discussions+'"><span class="vtip" title="'+Drupal.t("ACLBL0018")+'">'+Drupal.t("ACLBL0018")+'<span class="fadeout"></span></span>';d+=' </div><span class="form-checkbox"><input type="checkbox" id="view_discussions" '+l+' class="eventtypes"></input></span>';d+=' <div class="action-btn-container"><div class="white-btn-bg-container"><div class="white-btn-bg-left"></div><input class="white-btn-bg-middle close learner-sign-close-link"  type="button" id="edit-close"  onclick="calendarallpopupclose()"  name="op" value="'+Drupal.t("LBL123")+'"><div class="white-btn-bg-right"></div></div>';d+=' <div class="single-admin-save-button-container"><div class="admin-save-button-left-bg"></div><input class="admin-save-button-middle-bg"  onclick="adminCalendarSettingPref()" type="button" id="edit-submit" name="op" value="'+Drupal.t("LBL141")+'"><div class="admin-save-button-right-bg"></div></div></div>';d+=" </td>";d+=' <td class="bubble-cr"></td>';
d+="</tr>";d+="<tr>";d+=' <td class="bubble-bl"></td>';d+=' <td class="bubble-blt"></td>';d+=' <td class="bubble-br"></td>';d+="</tr>";d+="</tbody>";d+="</table>";d+="</div>";$("#qtipdiv").html(d);vtip();}function displayAdminCalendarSettings(){try{$("#admincalendarsettingdiv").remove();adminCalCreateLoader();$.ajax({type:"GET",url:"/?q=administration/calendar/settings",success:function(b){adminCalDestroyLoader();displayAdminCalendarSettingsData(b);},failure:function(b){adminCalDestroyLoader();}});}catch(a){}}function displayShortTitle(b){var a="";if(b.length>22){a=b.substring(0,22)+"...";}else{a=b;}return a;}function calendarsummarydot(a){return"<div class='link cal-sum-dot' href='javascript:void(0);' selecteddate='"+a+"' onclick='displayMorePopupFromCalendarSummary(this);'><span class=\"vtip\" title='"+Drupal.t("LBL713")+"'>...</span></div>";}function iterateEventsObject(c,k,n,f,g){var m="";var a=0;if(c==""||c==undefined){return"";}n="ilt-cls";var l=$.cookie("admincalendar_pref");try{l=JSON.parse(l);
}catch(h){}if(f==undefined||f==null||f=="undefined"){f=false;}else{}for(var d=0;d<c.length;d++){if(l.view_classroom==true&&c[d].type=="lrn_cls_dty_ilt"){n="ilt-cls";var b="";if(c[d].allDay==false){notalldaycls=n+" notallday";}else{notalldaycls=n;}if(c[d].startTime!=undefined||c[d].startTime!=""){b=calTimeFormat(c[d].from_date,c[d].startTime,false,"summary");}shortTitle='<span class="list-spot"></span><span class="time">'+b+'</span><span class="summary-title">'+displayShortTitle(c[d].title)+"</span>";if(isEventFallInTodayDate(c[d],k.substring(0,10))){m+="<div class='list-item' data=\""+escape(JSON.stringify(c[d]))+"\" onclick='showSessionDetailsFromCalendarSummary(this,event);'><span title='"+b+" "+c[d].title+"' class='vtip event-item "+notalldaycls+"'>"+shortTitle+"</span></div>";a=a+1;}}if(l.view_virtualclassroom==true&&c[d].type=="lrn_cls_dty_vcl"){n="vcl-cls";var b="";if(c[d].allDay==false){notalldaycls=n+" notallday";}else{notalldaycls=n;}if(c[d].startTime!=undefined||c[d].startTime!=""){b=calTimeFormat(c[d].from_date,c[d].startTime,false,"summary");
}shortTitle='<span class="list-spot"></span><span class="time">'+b+'</span><span class="summary-title">'+displayShortTitle(c[d].title)+"</span>";if(isEventFallInTodayDate(c[d],k.substring(0,10))){m+="<div class='list-item'  data=\""+escape(JSON.stringify(c[d]))+"\" onclick='showSessionDetailsFromCalendarSummary(this,event);'><span title='"+b+" "+c[d].title+"' class='vtip event-item "+notalldaycls+"'>"+shortTitle+"</span></div>";a++;}}if(l.view_orders==true&&c[d].type=="order"){n="order";var b="";if(c[d].allDay==false){notalldaycls=n+" notallday";}else{notalldaycls=n;}if(c[d].startTime!=undefined||c[d].startTime!=""){b=calTimeFormat(c[d].from_date,c[d].startTime,false,"summary");}shortTitle='<span class="list-spot"></span><span class="time">'+b+'</span><span class="summary-title">'+displayShortTitle(c[d].title)+"</span>";if(isEventFallInTodayDate(c[d],k.substring(0,10))){m+="<div class='list-item'  data=\""+escape(JSON.stringify(c[d]))+"\" onclick='showSessionDetailsFromCalendarSummary(this,event);'><span title='"+b+" "+c[d].title+"' class='vtip event-item "+notalldaycls+"'>"+shortTitle+"</span></div>";
a++;}}if(l.view_scheduled_report==true&&c[d].type=="report"){n="report";var b="";if(c[d].allDay==false){notalldaycls=n+" notallday";}else{notalldaycls=n;}if(c[d].startTime!=undefined||c[d].startTime!=""){b=calTimeFormat(c[d].from_date,c[d].startTime,false,"summary");}shortTitle='<span class="list-spot"></span><span class="time">'+b+'</span><span class="summary-title">'+displayShortTitle(c[d].title)+"</span>";if(isEventFallInTodayDate(c[d],k.substring(0,10))){m+="<div class='list-item'  data=\""+escape(JSON.stringify(c[d]))+"\" onclick='showSessionDetailsFromCalendarSummary(this,event);'><span title=\""+b+" "+c[d].title+"\" class='vtip event-item "+notalldaycls+"'>"+shortTitle+"</span></div>";a++;}}}return m;}function isEventFallInTodayDate(g,b){var f=moment(b);var c=moment(g.start.substring(0,10));var d="";var a=moment(f).weekday();if(c.diff(f,"days")==0){return true;}if(g.end!=undefined&&g.end!=null&&g.end!="undefined"&&g.end!=""){d=moment(g.end.substring(0,10));}if(f>=c&&f<=d){if(g.dow!=undefined){if(g.dow.indexOf(a)>=0){return true;
}}else{return true;}}else{return false;}}if(typeof helper=="undefined"){var helper={};}helper.arr={multisort:function(a,b,d){if(typeof b=="undefined"){b=[];for(x=0;x<a[0].length;x++){b.push(x);}}if(typeof d=="undefined"){d=[];for(x=0;x<a[0].length;x++){d.push("ASC");}}function c(o,m,f,g,k){var n=g[k]=="DESC"?1:0;var h=!isNaN(+o[f[k]]-+m[f[k]]);var p=h?+o[f[k]]:o[f[k]].toLowerCase();var l=h?+m[f[k]]:m[f[k]].toLowerCase();if(p<l){return n==0?-1:1;}if(p==l){return f.length-1>k?c(o,m,f,g,k+1):0;}return n==0?1:-1;}return a.sort(function(g,f){return c(g,f,b,d,0);});}};function formatCalendarDataSummary(r,h,p){checkSessionOut();var o=moment(p);var c=moment(p);var d=c.add("days",1).format("YYYY-MM-DD");var q=getACSearchParams();var f=$newJquery("#calendarprimaryview").fullCalendar("getEventSources");var l=iterateEventsObject(f,r,"",h,p);var g=iterateEventsObject(f,d,"",h,p);$("#calendarsummary").css("display","block");var t="";if(calendardata!=null){t=moment(calendarmetadata[0].todaydate).format("YYYY-MM-DD");
}else{t=moment(new Date()).format("YYYY-MM-DD");}var b=o.diff(t,"days");var s="";var a="";if(b==0){s=Drupal.t("LBL031");a=Drupal.t("ACLBL0020");}else{if(b==1){s=Drupal.t("ACLBL0020");a=o.add(1,"day").format("MMM DD, YYYY");}else{if(b==-1){s=o.format("MMM DD, YYYY");a=Drupal.t("LBL031");}else{s=o.format("MMM DD, YYYY");a=o.add(1,"day").format("MMM DD, YYYY");}}}l="<div class='today-events'><h4>"+s+"</h4><div id='today-events-container'>"+l+"</div><div id ='tdyoverflowitems' class ='tdyoverflowitems'></div></div>";g="<div class='tmrw-events' ><h4>"+a+"</h4><div id='tomo-events-container'>"+g+"</div><div id ='tmwoverflowitems' class ='tmwoverflowitems'></div></div>";$("#calendarsummary").html(l+g);var k={autoReinitialise:true};$("#calendarsummary #today-events-container").jScrollPane(k);$("#calendarsummary #tomo-events-container").jScrollPane(k);if($("#tdyoverflowitems").hasClass("tdyoverflowitems")){var m=$("#today-events-container").height()-25;$("#calendarsummary #today-events-container .jspVerticalBar").css("height",m);
}if($("#tmwoverflowitems").hasClass("tmwoverflowitems")){var n=$("#tomo-events-container").height()-25;$("#calendarsummary #tomo-events-container .jspVerticalBar").css("height",n);}vtip();if($("#tdyoverflowitems").hasClass("tdyoverflowitems")){$("#tdyoverflowitems").removeClass("tdyoverflowitems");formatCompleteCalendarDataSummary(r,s,"today");}if($("#tmwoverflowitems").hasClass("tmwoverflowitems")){$("#tmwoverflowitems").removeClass("tmwoverflowitems");formatCompleteCalendarDataSummary(d,a,"tomorrow");}}function formatCompleteCalendarDataSummary(c,a,d){checkSessionOut();if(d=="today"){cltodayEvents="<h4>"+a+"</h4><div id='today-events-container'></div><div id ='tdyoverflowitems' class ='tdyoverflowitems'></div>";$("#calendarsummary .today-events").html(cltodayEvents);adminCalCreateLoader("today-events-container");}else{cltomoEvents="<h4>"+a+"</h4><div id='tomo-events-container'></div><div id ='tmwoverflowitems' class ='tmwoverflowitems'></div>";$("#calendarsummary .tmrw-events").html(cltomoEvents);
adminCalCreateLoader("tomo-events-container");}var b=getACSearchParams();$.ajax({url:"/?q=administration/calendarviewapi",METHOD:"post",data:"startDate="+c+"&endDate="+c+b+"&narrowcaldaywise=true",success:function(k){if(d=="today"){adminCalDestroyLoader("today-events-container");}else{adminCalDestroyLoader("tomo-events-container");}var f=JSON.parse(k);var f=helper.arr.multisort(f,["startTime","title"],["ASC"]);var g=iterateEventsObject(f,c,"","",c);var h={autoReinitialise:true};if(d=="today"){$("#calendarsummary #today-events-container").html(g);$("#calendarsummary #today-events-container").jScrollPane(h);}else{$("#calendarsummary #tomo-events-container").html(g);$("#calendarsummary #tomo-events-container").jScrollPane(h);}vtip();},failure:function(f){if(d=="today"){adminCalDestroyLoader("today-events-container");}else{adminCalDestroyLoader("tomo-events-container");}}});}function formatCalendarSummary(b,d,c){var a="";if(calendardata.length!=null&&calendardata.length!=undefined){calendardata=calendardata.sort(ac_events_sorting);
}a=iterateEventsObject(calendardata,b,"",d,c);return a;}function printAdminCalendar(){$(".active-qtip-div").remove();calendarallpopupclose();printPreview();}function exportAdminCalendar(){$(".active-qtip-div").remove();calendarallpopupclose();if($newJquery("#calendarprimaryview").fullCalendar("getView").name=="year"){adminCalendarPopup("Alert","Export is disabled for year view");return;}var a=$newJquery("#calendarprimaryview").fullCalendar("getView").start.format("YYYY-MM-DD");var b=$newJquery("#calendarprimaryview").fullCalendar("getView").end.format("YYYY-MM-DD");calendarExcelConvert(a,b);}function adminCalendarSettingClose(){try{$("#admincalendarsettingdiv").css("display","none");}catch(a){}}function reArangeSearchFilter(){var b=$("#search_all_calendar_type-hidden").val();var a=jQuery.parseJSON($.cookie("admincalendar_pref"));var h=new Array();h.All=Drupal.t("LBL1039");if(a.view_classroom==true||a.view_classroom=="true"||a.view_virtualclassroom==true||a.view_virtualclassroom=="true"){h.view_classroom=Drupal.t("LBL262");
}if(a.view_instructors==true||a.view_instructors=="true"){h.view_instructors=Drupal.t("Instructor");}if(a.view_locations==true||a.view_locations=="true"){h.view_locations=Drupal.t("Location");}if(ADMIN_CALENDAR_PERM_LIST.commerce==true&&(a.view_orders==true||a.view_orders=="true")){h.view_orders=Drupal.t("ACLBL0041");}if(a.view_scheduled_report==true||a.view_scheduled_report=="true"){h.view_scheduled_report=Drupal.t("LBL799");}var g=false;if(b in h){}else{g=true;}var f="";var d=0;var k=getCurrentLanguage();for(var c in h){if(d==0&&g==true){$("#select-list-calendar-dropdown").css("display","block");$("#admin-dropdown-arrow").css("display","block");$("#search_all_calendar_type-hidden").val(c);$("#select-list-calendar-dropdown").html(h[c]);}d++;f+="<li onclick=\"moreClassSearchTypeText('"+escape(h[c])+"','"+c+'\');" class="'+c+'">'+h[c]+"</li>";}if(d==0){$("#select-list-calendar-dropdown").css("display","none");$("#admin-dropdown-arrow").css("display","none");$("#search_all_calendar_type-hidden").val("");
}$("#select-list-calendar-dropdown-list").html(f);}function adminCalendarSettingPref(){adminCalCreateLoader();calendarallpopupclose();if(($("#view_classroom").prop("checked")==false)&&($("#view_virtualclassroom").prop("checked")==false)&&($("#view_orders").prop("checked")==false)&&($("#view_scheduled_report").prop("checked")==false)&&($("#view_locations").prop("checked")==false)&&($("#view_discussions").prop("checked")==false)&&($("#view_instructors").prop("checked")==false)){adminCalendarPopup("Alert",Drupal.t("ERR106"));adminCalDestroyLoader();return;}var a={view_classroom:$("#view_classroom").prop("checked"),view_virtualclassroom:$("#view_virtualclassroom").prop("checked"),view_orders:$("#view_orders").prop("checked"),view_scheduled_report:$("#view_scheduled_report").prop("checked"),view_locations:$("#view_locations").prop("checked"),view_discussions:$("#view_discussions").prop("checked"),view_instructors:$("#view_instructors").prop("checked")};$.cookie("admincalendar_pref",JSON.stringify(a));
reArangeSearchFilter();$.ajax({type:"GET",cache:false,url:"/?q=administration/calendar/update-preference",success:function(b){if(b=="session_out"){self.location="?q=user";return;}if(b){$newJquery("#calendarprimaryview").fullCalendar("removeEvents",[]);$newJquery("#calendarnarrowview").fullCalendar("removeEvents",[]);getCalendarData();if((a.view_classroom==false)&&(a.view_virtualclassroom==false)&&(a.view_scheduled_report==false)&&(a.view_orders==false)){$("#narrow-search-calendar-filter").val(Drupal.t("LBL304")).prop("disabled","disabled");$(".select-list-dropdown-calendar").css("opacity",0.3);$(".select-list-calendar-dropdown-link").css("opacity",0.3);$("#narrow-search-calendar-filter-container .eol-search-go").css({"background-color":"#f2f2f2",border:"1px solid #e5e5e5"});$("#narrow-search-calendar-filter-container li.eol-search-input span").css("background-color","#f2f2f2");$("#narrow-search-calendar-filter-container li.eol-search-input input").css("background-color","#f2f2f2");}else{$("#narrow-search-calendar-filter").removeAttr("disabled");
$(".select-list-dropdown-calendar").css("opacity",1);$(".select-list-calendar-dropdown-link").css("opacity",1);$("#narrow-search-calendar-filter-container .eol-search-go").css("background-color","white");$("#narrow-search-calendar-filter-container .eol-search-go").css("border","1px solid #e5e5e5");$("#narrow-search-calendar-filter-container li.eol-search-input span").css("background-color","white");$("#narrow-search-calendar-filter-container li.eol-search-input input").css("background-color","white");}}},failure:function(b){alert(b);}});adminCalDestroyLoader();}function calendarUpdateData(a,l){checkSessionOut();var c=new String(a.id);if(c!=null&&c.indexOf("-")>0){c=c.substring(c.indexOf("-")+1,c.length);}var m=a.type;var h=a.start.format("YYYY-MM-DD HH:mm:ss");var d="";if(a.end==null||a.end==""){d="";}else{d=a.end.format("YYYY-MM-DD HH:mm:ss");}var k=a.class_id;var g=a.location_id;adminCalCreateLoader();if(a.startTime!="All day"){var b=a.start.format("HH:mm");a.startTime=b;if(a.end==undefined||a.end==null||a.end==""){a.endTime="";
}else{a.endTime=a.end.format("HH:mm");}}if(a.actualEnd==undefined||a.actualEnd==null||a.actualEnd==""){d="";}$newJquery("#calendarprimaryview").fullCalendar("updateEvent",a);if(a.type=="lrn_cls_dty_ilt"||a.type=="lrn_cls_dty_vcl"){a.startTime=a.start.format("HH:mm");if(a.endTime==undefined||a.endTime==null||a.endTime==""){a.endTime="";}else{a.endTime=a.end.format("HH:mm");}}var f="allDay="+a.allDay+"&id="+c+"&type="+m+"&newdate="+h+"&classid="+k+"&location_id="+g+"&startTime="+a.startTime+"&endTime="+a.endTime+"&enddate="+d;if(a.type=="lrn_cls_dty_vcl"){f+="&timezone="+a.timezone;}$.ajax({url:"?q=administration/calendarUpdateData",METHOD:"post",data:f,success:function(o){adminCalDestroyLoader();if($.trim(o)=="success"){getCalendarData();window.setTimeout(function(){attachEvents("#calendarprimaryview .fc-title a");},200);}else{var n=$newJquery("#calendarprimaryview").fullCalendar("getView");if(n.name=="agendaDay"){getCalendarData();}adminCalendarPopup("Alert",o);l();}},failure:function(n){adminCalDestroyLoader();
}});}function displayCreateNewObjectPopupData(a){try{var b='<div id="admincalendarcreatenewobjectdiv" style="display:block;">';b+='<div class="dropdownadd-dd-list-arrow" ></div>';b+='<a  class="qtip-close-button account-close-popup"></a>';b+='<table cellspacing="0" cellpadding="0" id="bubble-face-table">';b+="<tbody>";b+="<tr>";b+='<td class="bubble-tl"></td>';b+='<td class="bubble-t"></td>';b+='<td class="bubble-tr"></td>';b+="</tr>";b+="<tr>";b+='<td class="bubble-cl"></td>';b+='<td valign="top" class="bubble-c" id="popupcontent">';if(ADMIN_CALENDAR_PERM_LIST.create_class=="enabled"){b+='<div class="links header-popup cls-room"><a data-wrapperid="paint-narrow-search-results" class="createnewclass narrow-search-actionbar-textbtn addedit-form-expertusone-throbber ctools-modal-ctools-admin-course-class-addedit-style use-ajax ajax-processed" onclick="calendarallpopupclose(\'ilt-cls\'); addAdminPageClasses(\'ilt-cls\'); setCloseHandler(\'lrn_cls_dty_ilt\');" href="/?q=administration/learning/course-class/ajax/addedit/">'+Drupal.t("ACLBL0001")+"</a>";
b+="</div>";}else{b+='<div class="links header-popup cls-room"><a data-wrapperid="paint-narrow-search-results" class="disabled">'+Drupal.t("ACLBL0001")+"</a>";b+="</div>";}if(ADMIN_CALENDAR_PERM_LIST.create_class=="enabled"){b+='<div class="links header-popup vc-cls"><a data-wrapperid="paint-narrow-search-results" class="createnewclass narrow-search-actionbar-textbtn addedit-form-expertusone-throbber ctools-modal-ctools-admin-course-class-addedit-style use-ajax ajax-processed"  onclick="calendarallpopupclose(\'vcl-cls\'); addAdminPageClasses(\'vcl-cls\');setCloseHandler(\'lrn_cls_dty_vcl\');"  href="/?q=administration/learning/course-class/nojs/addedit/">'+Drupal.t("ACLBL0002")+"</a>";b+=" </div>";}else{b+='<div class="links header-popup cls-room"><a data-wrapperid="paint-narrow-search-results" class="disabled">'+Drupal.t("ACLBL0002")+"</a>";b+="</div>";}if(ADMIN_CALENDAR_PERM_LIST.commerce==true&&ADMIN_CALENDAR_PERM_LIST.view_orders=="enabled"){if(a!="fc-past"&&a!="fc-future"){b+='<div class="links header-popup order"><a class="" onclick="calendarallpopupclose(\'order\'); addAdminPageClasses(\'order\'); createOrderOrDisplayDiscussionFromAdminCalendar(this);" data="order"   href="javascript:void(0)">'+Drupal.t("ACLBL0004")+"</a>";
b+=" </div>";}}else{if(a!="fc-past"&&a!="fc-future"){b+='<div class="links header-popup cls-room"><a data-wrapperid="paint-narrow-search-results" class="disabled">'+Drupal.t("ACLBL0004")+"</a>";b+="</div>";}}if(ADMIN_CALENDAR_PERM_LIST.create_report=="enabled"){if(a!="fc-past"&&a!="fc-future"){b+='<div class="links header-popup report"><a data-wrapperid="paint-narrow-search-results" class="report" onclick="displayReportsForCalendar();"  href="javascript:void(0);" >'+Drupal.t("ACLBL0005")+"</a>";b+=" </div>";}}else{if(a!="fc-past"&&a!="fc-future"){b+='<div class="links header-popup cls-room"><a data-wrapperid="paint-narrow-search-results" class="disabled">'+Drupal.t("ACLBL0005")+"</a>";b+="</div>";}}b+=" </td>";b+=' <td class="bubble-cr"></td>';b+="</tr>";b+="<tr>";b+=' <td class="bubble-bl"></td>';b+=' <td class="bubble-blt"></td>';b+=' <td class="bubble-br"></td>';b+="</tr>";b+="</tbody>";b+="</table>";b+="</div>";$(".createnewpopupdiv").html(b);$("#admincalendarcreatenewobjectdiv").show();
var f=getCurrentLanguage();var c="";if(f=="ru"){c="lang-ru";}$(".createnewpopupdiv").addClass(c);attachEvents(".createnewclass");}catch(d){}}function displayCreateNewObjectPopup(a){try{calendarallpopupclose();$.ajax({type:"GET",cache:false,url:"/?q=administration/calendar/settings",success:function(c){if(c=="session_out"){self.location="?q=user";return;}ADMIN_CALENDAR_PERM_LIST=c;displayCreateNewObjectPopupData(a);},failure:function(c){alert(c);}});}catch(b){}}function adminCalendarCreateNewClose(){try{$("#admincalendarcreatenewobjectdiv").css("display","none");}catch(a){}}$(".account-close-popup").live("click",function(){calendarallpopupclose();$(".active-qtip-div").remove();});function addAdminPageClasses(a){adminCalCreateLoader();$("body").removeClass(" page-administration page-administration-learning-catalog page-administration-manage-announcement page-administration-commerce page-administration-commerce-order page-reports section-administration");if(a=="ilt-cls"){$("body").addClass("page-administration-learning-catalog page-administration");
}else{if(a=="vcl-cls"){$("body").addClass("page-administration-learning-catalog page-administration");}else{if(a=="announcement"){$("body").addClass("page-administration-manage-announcement page-administration");}else{if(a=="order"){$("body").addClass("page-administration-commerce-order page-administration-commerce page-administration section-administration");}else{if(a=="report"){$("body").addClass("page-reports");}else{if(a=="schedule"){}}}}}}}function loadCSSIfNotAlreadyLoadedForSomeReason(d){var c=document.styleSheets;for(var b=0,a=c.length;b<a;b++){if(c[b].href==""||c[b].href==null||c[b].href==undefined||c[b].href=="undefined"||c[b].href=="null"){}else{if(d=="announcement"&&c[b].href.indexOf("exp_sp_administration_announcement_v2.css")>=0){return;}else{if(d=="order"&&c[b].href.indexOf("exp_sp_administration_order_v2.css")>=0&&c[b].href.indexOf("exp_sp_uc_cart_v2.css")>=0){return;}}}}if(d=="announcement"){$("head").append("<link class='admincalpopupcss' href='sites/all/modules/core/exp_sp_core/modules/exp_sp_administration/exp_sp_administration_manage/exp_sp_administration_announcement/exp_sp_administration_announcement_v2.css' type='text/css' rel='stylesheet' />");
}else{if(d=="order"){$("head").append("<link class='admincalpopupcss' href='sites/all/modules/core/exp_sp_core/modules/exp_sp_administration/exp_sp_administration_commerce/exp_sp_administration_order/exp_sp_administration_order_v2.css' type='text/css' rel='stylesheet' />");$("head").append("<link class='admincalpopupcss' href='sites/all/modules/core/exp_sp_commerce/css/exp_sp_uc_cart_v2.css' type='text/css' rel='stylesheet' />");}else{$(".admincalpopupcss").remove();}}}function calendarallpopupclose(a){try{$(".admincalendarviewmorepopupdiv").css("display","none");$("#admincalendarsettingdiv").css("display","none");$("#admincalendarcreatenewobjectdiv").css("display","none");$("#admincalendarviewreportorderobjectdiv").css("display","none");$(".today-events div.order").removeClass("order");$(".today-events div.regend").removeClass("regend");$(".today-events div.regcancel").removeClass("regcancel");$(".today-events div.ilt-cls").removeClass("ilt-cls");$(".today-events div.vcl-cls").removeClass("vcl-cls");
$(".today-events div.announcement").removeClass("announcement");$(".tmrw-events div.order").removeClass("order");$(".tmrw-events div.regend").removeClass("regend");$(".tmrw-events div.regcancel").removeClass("regcancel");$(".tmrw-events div.ilt-cls").removeClass("ilt-cls");$(".tmrw-events div.vcl-cls").removeClass("vcl-cls");$(".tmrw-events div.announcement").removeClass("announcement");$(".ac_order_links").hide();}catch(b){}}function getCalendarCellPosition(b){var a=0;var d=0;if(!c){var c=window.event;}if(c.pageX||c.pageY){a=c.pageX;d=c.pageY;}else{if(c.clientX||c.clientY){a=c.clientX+document.body.scrollLeft+document.documentElement.scrollLeft;d=c.clientY+document.body.scrollTop+document.documentElement.scrollTop;}}return{x:a,y:d};}function isDatePastTodayFuture(b,k){var l="";var k=(k!=undefined||k!="")?k:"";if(calendardata!=null){l=moment(moment(calendarmetadata[0].todaydate).format("YYYY-MM-DD HH:mm"));}else{l=moment(moment(new Date()).format("YYYY-MM-DD HH:mm"));}if(k=="add_entity"){l=moment(moment(new Date()).format("YYYY-MM-DD"));
var f=moment(b,"MM-DD-YYYY").format("YYYY-MM-DD");var h=moment(b,"MM-DD-YYYY");}else{if(k=="display"||k=="update"){if(b.type=="cre_sys_obt_anm"||(b.type=="report"&&b.frequency=="daily")){var c=b.actualEnd;var g=moment(calendarmetadata[0].todaydate).format("YYYY-MM-DD HH:mm");if(c instanceof Object){var f=c.format("YYYY-MM-DD HH:mm");}else{var f=moment(c).format("YYYY-MM-DD HH:mm");}}else{var f=moment(b.start).format("YYYY-MM-DD HH:mm");var h=moment(b.start);}}else{var f=moment(b.start).format("YYYY-MM-DD HH:mm");var h=moment(b.start).format("YYYY-MM-DD HH:mm");}}if(b.type=="cre_sys_obt_anm"||(b.type=="report"&&b.frequency=="daily")){var d=moment(f).diff(moment(g),"minutes");}else{var d=h.diff(l,"days");}var a="";if(d==0){a="fc-today";}else{if(d>0){a="fc-future";}else{a="fc-past";}}return a;}function addObjectThroughAdmCalendar(b,g){$(".active-qtip-div").remove();var f=$newJquery("#calendarprimaryview").fullCalendar("getDate").format("YYYY");var a=$newJquery("#calendarprimaryview").fullCalendar("getView");
var d="",c="";if(a.name=="basicWeek"){var c=(g.type=="contextmenu")?b.format("MM-DD-YYYY"):$(b).data("date");$.cookie("startdate",c);d=isDatePastTodayFuture(c,"add_entity");}else{if(a.name=="month"){c=$(b).parent().parent().attr("data-date");if(c==null||c==undefined||c=="undefined"){$.cookie("startdate",moment(c).format("MM-DD-YYYY"));d=isDatePastTodayFuture(b,"add_entity");}else{$.cookie("startdate",moment(c).format("MM-DD-YYYY"));d=isDatePastTodayFuture(moment(c),"add_entity");}}else{var c=(g.type=="contextmenu")?b.format("MM-DD-YYYY"):$(b).data("date");$.cookie("startdate",c);d=isDatePastTodayFuture(c,"add_entity");}}if($(b).parent().parent().hasClass("fc-past")){d="fc-past";}$(".createnewpopupdiv").remove();var h='<div class="createnewpopupdiv" style="position:absolute;"></div>';$("body").append(h);$(b).css("z-index",10000);$(".createnewpopupdiv").css("position","absolute");$(".createnewpopupdiv").css("top",g.pageY+10);if($(b).hasClass("popup")){$(".createnewpopupdiv").css("left",g.pageX-165);
}else{$(".createnewpopupdiv").css("left",g.pageX-170);}$(".createnewpopupdiv").html(displayCreateNewObjectPopup(d));try{if(Drupal.settings.ajaxPageState.theme=="expertusoneV2"){$("#admincalendarcreatenewobjectdiv").toggle();}else{$("#admincalendarcreatenewobjectdiv").show();}}catch(k){}}function getDataViewReportOrderPopup(d,c,g){if(c==""&&d!=""&&d!=undefined){var b=$newJquery("#calendarprimaryview").fullCalendar("getView");var f="",a="";if(b.name=="basicWeek"){var h=$newJquery("#calendarprimaryview").fullCalendar("getDate").format("YYYY");a=$(d).attr("data-date");a=moment(a,"MM-DD-YYYY").format("YYYY-MM-DD");}else{if(b.name=="month"){a=$newJquery(d).parent().parent().attr("data-date");}else{a=$(d).parent().parent().find(".date").attr("data-date");a=moment(a,"MM-DD-YYYY").format("YYYY-MM-DD");}}if($(d).hasClass("popup")){a=$(d).attr("data-date");}}else{a=c;}adminCalCreateLoader();$.ajax({url:"/?q=administration/viewdaywisereportorderlocations",METHOD:"post",data:"startDate="+a,success:function(k){adminCalDestroyLoader();
displayViewReportPopupDayWise(d,k,a,g);},failure:function(k){adminCalDestroyLoader();}});}function createDropDown(a){$(".orderlinks").css("display","none");$("#selOrderlinksId_"+a).css("display","block");}$(function(){try{$("body").live("click",function(b){if($(b.target).is(".blue-btn-bg-right")||($(b.target).parents("a.blue-btn-bg-right").length)){return false;}if(!$(b.target).parents(".ac_order_links").length){$(".orderlinks").hide();}});}catch(a){}});function displayViewReportPopupDayWise(d,g,a,c){calendarallpopupclose();var m=$.cookie("admincalendar_pref");var o=JSON.parse(g);var n=false;m=JSON.parse(m);var h='<div id="admincalendarviewreportorderobjectdiv" style="display:none;">';h+='<div class="dropdownadd-dd-list-arrow"></div>';h+='<a  class="qtip-close-button account-close-popup"></a>';h+='<table cellspacing="0" cellpadding="0" id="bubble-face-table">';h+="<tbody>";h+="<tr>";h+='<td class="bubble-tl"></td>';h+='<td class="bubble-t"></td>';h+='<td class="bubble-tr"></td>';h+="</tr>";
h+="<tr>";h+='<td class="bubble-cl"></td>';h+='<td valign="top" class="bubble-c">';h+='<div class="listviewcontainer" style="min-height:50px;max-height:200px;overflow:auto; width:auto;">';if(ADMIN_CALENDAR_PERM_LIST.view_scheduled_report=="enabled"&&m.view_scheduled_report==true&&o.length>0){n=true;h+='<div class="reports categ-block">';h+="<h4>"+Drupal.t("REPORTS")+": <span>("+Drupal.t("ACLBL0023")+")</span></h4>";for(var f=0;f<o.length;f++){var p=o[f];if(p.type=="report"){h+='<div class="links header-popup" >';h+="<span class='list vtip' title='"+p.title+"' onclick=\"calendarallpopupclose('report');addAdminPageClasses('report');setCloseHandler('edit');$('body').data('reportsearch').reportAddWizard(); $('body').data('reportsearch').launchReport("+p.report_id+", 'report-data-source');\">"+titleRestrictionFadeoutImage(p.title,"admin-cal-left-title")+"</span>";h+="</div>";}}h+="</div>";}if(ADMIN_CALENDAR_PERM_LIST.view_orders=="enabled"&&m.view_orders==true&&o.length>0&&ADMIN_CALENDAR_PERM_LIST.commerce==true){n=true;
h+='<div class="orders categ-block">';h+="<h4>"+Drupal.t("Orders")+": <span>("+Drupal.t("ACLBL0022")+")</span></h4>";for(var f=0;f<o.length;f++){var p=o[f];if(p.type=="order"){var l="'"+a+"'";var b="";h+='<div class="links header-popup"><div class="order-by">';h+='<span class="list-item vtip" title="'+p.title+"\"><a onclick=\"calendarallpopupclose('order');addAdminPageClasses('order');setCloseHandler('edit');\" class=\"order_row narrow-search-actionbar-textbtn addedit-form-expertusone-throbber ctools-modal-ctools-admin-order_edit-style use-ajax ajax-processed\"  id=\"visible-ctools-"+p.type+"-"+p.uc_order_id+'"  href="/?q=administration/commerce/order/ajax/addedit/'+p.uc_order_id+'" data-wrapperid="paint-narrow-search-results">'+titleRestrictionFadeoutImage(p.title,"admin-cal-left-title")+"</a></span>";if(p.order_status=="canceled"){h+='<span id="applyorderactionid" class="applyorderactionid"><span class="label clsCanceled">'+Drupal.t("Canceled")+"</span></span>";}if(p.order_status=="pending"){b="'"+Drupal.t("LBL1163")+"'";
h+='<span class="action-link applyorderactionid" id="applyorderactionid_'+f+'"><span class="label clsApprove" onclick="displayDragConfirm('+b+", "+p.uc_order_id+", 'approve','order_update', "+l+');"  style="padding-right:0px">'+Drupal.t("ACLBL0024")+'</span><a data="'+p.uc_order_id+'" class="blue-btn-bg-right" onclick="createDropDown('+f+');"></a></span>';h+='<div class="orderlinks" id="selOrderlinksId_'+f+'" style="display:none"><ul class="dd-'+p.uc_order_id+' ac_order_links"><li  class="label clsddCancel" style="cursor:pointer;" onclick="applyOrderAction('+p.uc_order_id+", 'cancel','"+a+"');\" >"+Drupal.t("LBL109")+"</li></ul></div>";}if((p.order_status=="payment_received"||p.order_status=="completed")&&p.complete_count==0){b="'"+Drupal.t("LBL1164")+"'";h+='<span class="action-link applyorderactionid" id="applyorderactionid"><span class="label clsCancelLink"  onclick="displayDragConfirm('+b+", "+p.uc_order_id+", 'cancel','order_update', "+l+');">'+Drupal.t("LBL109")+"</span></span>";}else{if((p.order_status=="payment_received"||p.order_status=="completed")&&p.complete_count>0){h+='<span  class="applyorderactionid"><span class="label clsCancel">'+Drupal.t("LBL109")+"</span></span>";
}}h+='</div><div class="order-details">';h+='<span class="order-no">'+Drupal.t("LBL1025")+": "+p.uc_order_id+"</span>";h+='<span  class="order-price">'+p.currency_type+" "+p.price+"</span>";h+="</div>";h+="</div>";}}h+="</div>";}if(ADMIN_CALENDAR_PERM_LIST.view_locations=="enabled"&&m.view_locations==true&&o.length>0){n=true;h+='<div class="locations categ-block">';h+="<h4>"+Drupal.t("ACLBL0006")+": <span>("+Drupal.t("ACLBL0007")+")</span></h4>";for(var f=0;f<o.length;f++){var p=o[f];if(p.type=="location"){h+='<div class="links header-popup">';h+='<span class="loca-time">'+calTimeFormat(p.start,p.startTime,true)+" - "+calTimeFormat(p.start,p.endTime,true)+'</span><span class="loca-list vtip" title="'+p.title+'">'+titleRestrictionFadeoutImage(p.title,"admin-cal-left-title")+"</span>";h+="</div>";}}h+="</div>";}if(ADMIN_CALENDAR_PERM_LIST.view_instructors=="enabled"&&m.view_instructors==true&&o.length>0){n=true;h+='<div class="instructors categ-block">';h+="<h4>"+Drupal.t("ACLBL0008")+": <span>("+Drupal.t("ACLBL0007")+")</span></h4>";
for(var f=0;f<o.length;f++){var p=o[f];if(p.type=="instructor"){h+='<div class="links header-popup">';h+='<span class="loca-time">'+calTimeFormat(p.start,p.startTime,true)+" - "+calTimeFormat(p.start,p.endTime,true)+'</span><span class="loca-list vtip" title="'+p.title+'">'+titleRestrictionFadeoutImage(p.title,"admin-cal-left-title")+"</span>";h+="</div>";}}h+="</div>";}if(ADMIN_CALENDAR_PERM_LIST.forum==true&&ADMIN_CALENDAR_PERM_LIST.view_discussions=="enabled"&&m.view_discussions==true&&o.length>0){n=true;h+='<div class="discussions categ-block">';h+="<h4>"+Drupal.t("DISCUSSIONS")+": <span>("+Drupal.t("DISCUSSIONS")+")</span></h4>";for(var f=0;f<o.length;f++){var p=o[f];if(p.type=="discussion"){h+='<div class="links header-popup">';h+='<span class="list vtip" title="'+p.title+'"  style="cursor:pointer;" data="discussion" onclick="createOrderOrDisplayDiscussionFromAdminCalendar(this)" href="?q=learning/forum-topic-list/'+p.tid+'">'+p.title+"</span>";h+="</div>";}}h+="</div>";}if(!n){if(c!=""){$(".viewreportorderpopupdiv").removeClass("arrowbelow");
$(".viewreportorderpopupdiv").css("top",c+10);}h+="<span class='label'>"+Drupal.t("MSG403")+"</span>";}h+="</div>";h+=" </td>";h+=' <td class="bubble-cr"></td>';h+="</tr>";h+="<tr>";h+=' <td class="bubble-bl"></td>';h+=' <td class="bubble-blt"></td>';h+=' <td class="bubble-br"></td>';h+="</tr>";h+="</tbody>";h+="</table>";h+="</div>";$(".viewreportorderpopupdiv").html(h);try{if(Drupal.settings.ajaxPageState.theme=="expertusoneV2"){$("#admincalendarviewreportorderobjectdiv").toggle();}else{$("#admincalendarviewreportorderobjectdiv").show();}vtip();}catch(k){}attachEvents(".order_row");$(".listviewcontainer .categ-block:last").css("border-bottom",0);$(".listviewcontainer").jScrollPane({width:"1px"});if(!n){$(".listviewcontainer").css("height","30px");}}function listObjectThroughAdmCalendar(a,c){$(".viewreportorderpopupdiv").remove();$(".active-qtip-div").remove();var g=getCurrentLanguage();var b="";var f="";if(g=="ru"){f="lang-ru";}if(c.pageY>580){var b="arrowbelow";}if(c.pageX<700&&c.pageY<580){var b="arrowleft";
}if(c.pageX>700&&c.pageY>580){var b="arrowbelowright";}var d='<div class="viewreportorderpopupdiv '+f+" "+b+'" style="position:absolute;z-index:101;"></div>';$("body").append(d);$(a).css("z-index",100);$(".viewreportorderpopupdiv").css("position","absolute");if(c.pageY>580){$(".viewreportorderpopupdiv").css("top",c.pageY-240);}else{$(".viewreportorderpopupdiv").css("top",c.pageY+10);}if($(a).hasClass("popup")){$(".viewreportorderpopupdiv").css("left",c.pageX-225);}else{if(c.pageX<700){$(".viewreportorderpopupdiv").css("left",c.pageX-115);}else{$(".viewreportorderpopupdiv").css("left",c.pageX-306);}}getDataViewReportOrderPopup(a,"",c.pageY);$("#content .section").css("padding-top","6px");}function printPreview(){checkSessionOut();var d=$newJquery("#calendarprimaryview").fullCalendar("getView");if(d.name=="year"){adminCalendarPopup("Alert","Print is disabled for year view");return;}var a="",g="",c="";if(d.name=="month"){var a=$newJquery("#calendarprimaryview").fullCalendar("getView").intervalStart.format("YYYY-MM-DD");
c=$newJquery("#calendarprimaryview").fullCalendar("getView").intervalEnd.format("YYYY-MM-DD");g=moment(c).subtract(1,"days").format("YYYY-MM-DD");}else{a=$newJquery("#calendarprimaryview").fullCalendar("getView").start.format("YYYY-MM-DD");if(d.name=="agendaDay"){g=a;}else{c=$newJquery("#calendarprimaryview").fullCalendar("getView").intervalEnd.format("YYYY-MM-DD");g=moment(c).subtract(1,"days").format("YYYY-MM-DD");}}var f=$.cookie("admincalendar_pref");adminCalCreateLoader();var b=getACSearchParams();$.ajax({url:"/?q=administration/calendarviewapi",METHOD:"post",data:"startDate="+a+"&endDate="+g+b+"&print=true&type=export",success:function(h){adminCalDestroyLoader();openWindowForPrintAC(h);},failure:function(h){adminCalDestroyLoader();}});}function openWindowForPrintAC(a){calendarPDFConvert(a);}function calendarPDFConvert(c){var b=document.getElementById("calendar").innerHTML;var a="en";$("body").append('<form style="display:none;" id="postcertihtmlform" name="printform" method="POST" action="/sites/all/commonlib/pdf_template.php" target="_self"></form>');
$("#postcertihtmlform").append($('<input type="hidden" name="bodyContent"></input>').attr("value",c));$("#postcertihtmlform").append($('<input type="hidden" name="contentLanguage"></input>').attr("value",a));$("#postcertihtmlform").submit();$("#postcertihtmlform").remove();}function calendarExcelConvert(a,h){var f="?q=administration/calendarviewapi&startDate="+a+"&endDate="+h;$("body").append('<form style="display:none;" id="postcertihtmlform" name="printform" method="POST" action='+f+' target="_self"></form>');$("#postcertihtmlform").append($('<input type="hidden" name="startDate"></input>').attr("value",a));$("#postcertihtmlform").append($('<input type="hidden" name="endDate"></input>').attr("value",h));$("#postcertihtmlform").append($('<input type="hidden" name="export"></input>').attr("value","true"));var g=$("#search_all_calendar_type-hidden").val();var c=$("#narrow-search-calendar-filter").val();var k=Drupal.t("LBL304").toUpperCase();if((c.toLowerCase())==(k.toLowerCase())){c="";}$("#postcertihtmlform").append($('<input type="hidden" name="search_type"></input>').attr("value",g));
$("#postcertihtmlform").append($('<input type="hidden" name="search_text"></input>').attr("value",c));var d=$.cookie("admincalendar_pref");var d=$.cookie("admincalendar_pref");var b=$newJquery("#calendarprimaryview").fullCalendar("getView");$("#postcertihtmlform").append($('<input type="hidden" name="selectedobjects"></input>').attr("value",d));$("#postcertihtmlform").append($('<input type="hidden" name="view"></input>').attr("value",b.name));$("#postcertihtmlform").submit();$("#postcertihtmlform").remove();}function displayMorePopupFromCalendarSummary(b){var a=$(b).attr("selecteddate");displayCalendarSummaryEventsList(a,true);vtip();}function displayMorePopup(c,g){checkSessionOut();$(".admincalendarviewmorepopupdiv").removeClass("left-narrow");$(".admincalendarviewmorepopupdiv").addClass("more-list");calendarallpopupclose();var d='<div id="admincalendarviewmorepopup" style="display:none;">';d+='<div class="dropdownadd-dd-list-arrow"></div>';d+='<a  class="qtip-close-button account-close-popup"></a>';
d+='<table cellspacing="0" cellpadding="0" id="bubble-face-table">';d+="<tbody>";d+="<tr>";d+='<td class="bubble-tl"></td>';d+='<td class="bubble-t"></td>';d+='<td class="bubble-tr"></td>';d+="</tr>";d+="<tr>";d+='<td class="bubble-cl"></td>';d+='<td valign="top" class="bubble-c">';d+='<div class="rows">';d+='<span class="fc-title"></span>';d+="</div>";d+=" </td>";d+=' <td class="bubble-cr"></td>';d+="</tr>";d+="<tr>";d+=' <td class="bubble-bl"></td>';d+=' <td class="bubble-blt"></td>';d+=' <td class="bubble-br"></td>';d+="</tr>";d+="</tbody>";d+="</table>";d+="</div>";$(".admincalendarviewmorepopupdiv").html(d);$(".admincalendarviewmorepopupdiv").show();try{if(Drupal.settings.ajaxPageState.theme=="expertusoneV2"){$("#admincalendarviewmorepopup").toggle();}else{$("#admincalendarviewmorepopup").show();}}catch(g){}var b=moment(c.date).format("YYYY-MM-DD");var a=b;var f=moment(c.date).add(1,"days").format("YYYY-MM-DD");adminCalCreateLoader();$.ajax({url:"/?q=administration/calendarviewapi",METHOD:"post",data:"type=more&startDate="+a+"&endDate="+a+"&search_type="+search_type,success:function(h){adminCalDestroyLoader();
displayMorePopupData(h);},failure:function(h){adminCalDestroyLoader();}});}function ac_events_sorting(d,c){var f=moment(d.startTime,["h:mm A"]);var g=moment(c.startTime,["h:mm A"]);if(f<g){return -1;}if(f>g){return 1;}return 0;}function ac_events_title_sorting(d,c){var f=moment(d.startTime,["h:mm A"]);var g=moment(c.startTime,["h:mm A"]);f=f+" "+d.title;g=g+" "+c.title;if(f<g){return -1;}if(f>g){return 1;}return 0;}function displayMorePopupData(c){var d="<span class='fc-title'>";var b=JSON.parse(c);if(b.length!=null){b=b.sort(ac_events_sorting);}for(var a=0;a<b.length;a++){d+=displayCalendarEvent(b[a],"","60","more_popup")+" ";}d+="</span>";$newJquery("#admincalendarviewmorepopup .rows").html(d);closePopupOnEscAndOutsideClick("#admincalendarviewmorepopup");attachEvents("#admincalendarviewmorepopup .fc-title div.titlelinkstyle");$(".admincalendarviewmorepopupdiv .fc-title").jScrollPane({width:"1px"});vtip();}function displayCalendarEvent(u,a,y,n){var g=$.cookie("admincalendar_pref");var o="";
var k="";g=JSON.parse(g);var q=new String(u.id);if(q!=null&&q.indexOf("-")>0){q=q.substring(q.indexOf("-")+1,q.length);}var f="",s="";if(u.title!=null&&removeHTMLTags(u.title)!=null&&removeHTMLTags(u.title).length>y){s=removeHTMLTags(u.title).substring(0,y)+"...";}else{s=u.title;}s=titleRestrictionFadeoutImage(s,"admin-cal-title");if(u.type=="report"){var b=isDatePastTodayFuture(u,"display");}else{var b=u.dataType;}f="<span class='list-item-row fc-event-container "+b+"' style='width:100%;'>";var h="";var m=$newJquery("#calendarprimaryview").fullCalendar("getView");var r="";var z="";var w="";var l="";var d="";if(m.name=="agendaDay"||u.allDay==true){l="all-day-events";if(u.endTime!=undefined&&u.endTime!=""){r=u.startTime+" - "+u.endTime;if(u.startTime!=undefined&&u.startTime!=""){d=calTimeFormat(u.from_date,u.startTime);}}else{if(u.startTime=="All day"){r=Drupal.t("LBL1039")+" "+Drupal.t("LBL910");if(u.startTime!=undefined&&u.startTime!=""){d=calTimeFormat(u.from_date,u.startTime);}}else{r=u.startTime;
if(u.startTime!=undefined&&u.startTime!=""){d=calTimeFormat(u.from_date,u.startTime);}}}}else{if(u.startTime=="All day"){r=Drupal.t("LBL1039")+" "+Drupal.t("LBL910");l="all-day-events";if(u.startTime!=undefined&&u.startTime!=""){d=calTimeFormat(u.from_date,u.startTime);}}else{r=u.startTime;d=calTimeFormat(u.from_date,u.startTime);}}var t="";var p="";var v="";if(m.name!="agendaDay"||u.allDay==true){v=d;}if(u.endTime!=undefined&&u.endTime!=""){z=u.startTime+" - "+u.endTime;}else{z=r;}switch(u.type){case"lrn_cls_dty_ilt":if(g.view_classroom){if(m.name!="agendaDay"||u.allDay==true){p='<span class="titletimestyle'+h+'">'+d+"</span>";}t=(n!=undefined&&n=="more_popup")?"div":"a";o=(u.editable==1)?"administration/learning/course-class/ajax/addedit/"+u.course_id+"/"+u.class_id:"administration/view-class/ajax/addedit/"+u.class_id;k=(u.editable==1)?"ctools-modal-ctools-admin-course-class-addedit-style":"ctools-modal-ctools-viewscreen-wrapper";f+='<span class="vtip" title="'+v+" "+u.title+'"><'+t+' data-event="'+u.id+"\" onclick=\"calendarallpopupclose('ilt-cls');addAdminPageClasses('ilt-cls');setCloseHandler('edit');\" draggable=true class=\""+l+" titlelinkstyle ilt-cls narrow-search-actionbar-textbtn addedit-form-expertusone-throbber use-ajax ajax-processed "+k+'"  id="visible-ctools-'+u.type+"-"+u.class_id+'"  href="/?q='+o+'" data-wrapperid="paint-narrow-search-results">'+p+'<span  class="link">'+s+"</span>"+h;
f+="</span></"+t+"></span>";}break;case"lrn_cls_dty_vcl":if(g.view_virtualclassroom){if(m.name!="agendaDay"||u.allDay==true){p='<span class="titletimestyle'+h+'">'+d+"</span>";}t=(n!=undefined&&n=="more_popup")?"div":"a";o=(u.editable==1)?"administration/learning/course-class/ajax/addedit/"+u.course_id+"/"+u.class_id:"administration/view-class/ajax/addedit/"+u.class_id;k=(u.editable==1)?"ctools-modal-ctools-admin-course-class-addedit-style":"ctools-modal-ctools-viewscreen-wrapper";f+='<span class="vtip" title="'+v+" "+u.title+'"><'+t+' data-event="'+u.id+"\" onclick=\"calendarallpopupclose('vcl-cls');addAdminPageClasses('vcl-cls');setCloseHandler('edit');\" draggable=true class=\""+l+" titlelinkstyle vcl-cls narrow-search-actionbar-textbtn addedit-form-expertusone-throbber use-ajax ajax-processed "+k+'"  id="visible-ctools-'+u.type+"-"+u.class_id+'"  href="/?q='+o+'" data-wrapperid="paint-narrow-search-results">'+p+'<span  class="link">'+s+"</span>"+h;f+="</span></"+t+"></span>";}break;
case"order":if(g.view_orders){if(m.name!="agendaDay"||u.allDay==true){p='<span class="titletimestyle'+h+'">'+d+"</span>";}t=(n!=undefined&&n=="more_popup")?"div":"a";f+='<span class="vtip" title="'+v+" "+u.title+'"><'+t+' data-event="'+u.id+"\" onclick=\"calendarallpopupclose('order');addAdminPageClasses('order');setCloseHandler('edit');\" draggable=true class=\""+l+' titlelinkstyle order narrow-search-actionbar-textbtn addedit-form-expertusone-throbber ctools-modal-ctools-admin-order_edit-style use-ajax ajax-processed"  id="visible-ctools-'+u.type+"-"+u.uc_order_id+'"  href="/?q=administration/commerce/order/ajax/addedit/'+u.uc_order_id+'" data-wrapperid="paint-narrow-search-results">'+p+'<span class="link">'+s+"</span>"+h;f+="</span></"+t+"></span>";}break;case"report":if(g.view_scheduled_report){if(m.name!="agendaDay"||u.allDay==true){p='<span class="titletimestyle'+h+'">'+d+"</span>";}t=(n!=undefined&&n=="more_popup")?"div":"a";var c=u.report_id+"_"+randomId();o=(u.editable==true)?"/?q=administration/report-search/schedules/"+c:"javascript:void(0)";
f+='<span class="vtip" title="'+v+" "+u.title+'"><'+t+' data-event="'+u.id+'" onClick="setCSSForReport();" draggable=true  data-qtip-obj="{  \'holderId\': \'create-schedule-'+c+"', 'id': 'create-schedule-qtip-"+c+"', 'placement': 'above-or-below', 'launchedFrom': 'admincalendar'}\" href=\""+o+'" class="'+l+' use-ajax titlelinkstyle report ajax-processed" id="report-schedule-link-'+c+'">'+p+'<span class="link">'+s+"</span>";if($("#create-schedule-"+c).size()==0){$("body").append('<div id="create-schedule-'+c+'" style="z-index:12000"><div class="schedule-qtip-popup"  style="z-index:12000"></div></div>');}f+="</span></"+t+"></span>";}break;}f+="</span>";return f;}function showSessionDetailsFromCalendarSummary(b,d){var g=JSON.parse((unescape($(b).attr("data"))));$(".today-events div.order").removeClass("order");$(".today-events div.ilt-cls").removeClass("ilt-cls");$(".today-events div.vcl-cls").removeClass("vcl-cls");$(".today-events div.report").removeClass("report");$(".tmrw-events div.order").removeClass("order");
$(".tmrw-events div.ilt-cls").removeClass("ilt-cls");$(".tmrw-events div.vcl-cls").removeClass("vcl-cls");$(".tmrw-events div.report").removeClass("report");$(".admincalendarviewmorepopupdiv").remove();$(".qtip-close-button").click();var f='<div class="admincalendarviewmorepopupdiv" style="position:absolute;z-index:101;"></div>';var a=$(b).attr("autocompletemousever");if(a!=undefined&&a=="true"){$("#narrow-search-calendar-filter-container").append(f);}else{$("#calendar").append(f);}if($(b).find(".order").size()>0){$(b).addClass("order");}else{if($(b).find(".ilt-cls").size()>0){$(b).addClass("ilt-cls");}else{if($(b).find(".vcl-cls").size()>0){$(b).addClass("vcl-cls");}else{if($(b).find(".report").size()>0){$(b).addClass("report");}}}}var k="";if(g.end==null||g.end=="null"){g.end="";}if(g.start.length>10){if(g.allDay==true&&g.start.substring(11,g.start.length-3)!="00:00"){g.start=moment(g.start.substring(0,10)).format("MMM DD, YYYY");}else{g.start=moment(g.start.substring(0,10)).format("MMM DD, YYYY");
}}if(g.type=="lrn_cls_dty_ilt"||g.type=="lrn_cls_dty_vcl"){k+="<div class='event_title'>"+g.title+"</div>";k+="<div class='event_sessions'>";k+="<table width='100%'>";k+="<tr>";k+="<td width='40%'> ";k+="<span class='label'>"+Drupal.t("LBL250")+":</span>";k+="</td>";k+="<td><span class='date'>";k+=g.session_title;k+="</span></td></tr>";if(g.scheduled_duration!=""&&g.scheduled_duration!=null&&g.scheduled_duration!=undefined){k+="<tr>";k+="<td> ";k+="<span class='label'>"+Drupal.t("LBL248")+":</span>";k+="</td>";k+="<td><span class='date'>";k+=g.scheduled_duration;k+="</span></td></tr>";}k+="<tr>";k+="<td> ";k+="<span class='label'>"+Drupal.t("ACLBL0037")+":</span>";k+="</td>";k+="<td><span class='date'>";k+=g.start;k+="</span> - ";k+="<span class='time'> ";k+=calTimeFormat(g.startDate,g.startTime,true);k+="</span></td>";k+="</tr>";k+="<tr>";k+="<td>";k+="<span class='label'>"+Drupal.t("ACLBL0038")+":</span>";k+="</td>";k+="<td><span class='date'>";if(g.end!=null&&g.end.length>10){k+=moment(g.end.substring(0,10)).format("MMM DD, YYYY");
}else{k+="";}k+="</span> - ";k+="<span class='time'> ";k+=calTimeFormat(g.endDate,g.endTime,true);k+="</span></td>";k+="</tr>";k+="<tr>";k+="<td> ";k+="<span class='label'>"+Drupal.t("LBL297")+":</span>";k+="</td>";k+="<td><span class='date'>";k+=g.timezone;k+="</span> ";k+="<span class='time'> ";k+="&nbsp;";k+="</span></td>";k+="</tr>";k+="<tr>";k+="<td>";k+="<span class='label'>"+Drupal.t("Instructor")+":</span>";k+="</td>";k+="<td><span class='date'>";k+=g.instructor;k+="</span></td></tr>";k+="<tr>";k+="<td> ";k+="<span class='label'>"+Drupal.t("LBL263")+":</span>";k+="</td>";k+="<td><span class='date'>";k+=g.code;k+="</span></td></tr>";k+="<tr>";k+="<td> ";k+="<span class='label'>"+Drupal.t("LBL038")+":</span>";k+="</td>";k+="<td><span class='date'>";k+=g.languagename;k+="</span> ";k+="<span class='time'> ";k+="&nbsp;";k+="</span></td>";k+="</tr>";k+="<tr>";k+="<td> ";k+="<span class='label'>"+Drupal.t("LBL102")+":</span>";k+="</td>";k+="<td><span class='date'>";k+=g.status;k+="</span></td></tr>";
k+="</table>";k+="</div>";}else{if(g.type=="order"){k+="<div class='event_title'>"+g.title+"</div>";k+="<div class='event_sessions'>";k+="<table width='100%'>";k+="<tr>";k+="<td width='30%'> ";k+="<span class='label'>"+Drupal.t("LBL042")+":</span>";k+="</td>";k+="<td><span class='date'>";k+=g.start;k+="</span> - ";k+="<span class='time'>";k+=calTimeFormat(g.startDate,g.startTime,true);k+="</span></td>";k+="</tr>";k+="<tr>";k+="<td> ";k+="<span class='label'>"+Drupal.t("LBL884")+":</span>";k+="</td>";k+="<td><span class='date'>";k+=g.uc_order_id;k+="</span></td></tr>";k+="<tr>";k+="<td> ";k+="<span class='label'>"+Drupal.t("LBL102")+":</span>";k+="</td>";k+="<td><span class='date'>";k+=g.lan_order_status;k+="</span></td></tr>";k+="<tr>";k+="<td> ";k+="<span class='label'>"+Drupal.t("LBL040")+":</span>";k+="</td>";k+="<td><span class='date'>";k+=g.currency_type+" "+g.price;k+="</span></td></tr>";k+="</table>";k+="</div>";}else{if(g.type=="report"){k+="<div class='event_title'>"+g.title+"</div>";
k+="<div class='event_sessions'>";k+="<table width='100%'>";k+="<tr>";k+="<td width='30%'> ";k+="<span class='label'>"+Drupal.t("ACLBL0037")+":</span>";k+="</td>";k+="<td><span class='date'>";k+=g.start;k+="</span> - ";k+="<span class='time'> ";k+=calTimeFormat(g.startDate,g.startTime,true);k+="</span></td>";k+="</tr>";k+="<tr><td> ";k+="<span class='label'>"+Drupal.t("LBL102")+":</span>";k+="</td>";k+="<td><span class='date'>";k+=g.status;k+="</span></td></tr>";k+="</table>";k+="</div>";}}}if(g.type!="location"&&g.type!="instructor"){var c='<div id="narrowadmincalendarviewmorepopup" style="display:none;">';if(a!=undefined&&a=="true"){c+='<div class="dropdownadd-dd-list-arrow-right"></div>';}else{c+='<div class="dropdownadd-dd-list-arrow"></div>';c+='<a  class="qtip-close-button account-close-popup"></a>';}c+='<table cellspacing="0" cellpadding="0" id="bubble-face-table" style="width:300px;">';c+="<tbody>";c+="<tr>";c+='<td class="bubble-tl"></td>';c+='<td class="bubble-t"></td>';c+='<td class="bubble-tr"></td>';
c+="</tr>";c+="<tr>";c+='<td class="bubble-cl"></td>';c+='<td valign="top" class="bubble-c rows">';c+='<div class="calviewmorepopup-content">'+k+"</div>";c+=" </td>";c+=' <td class="bubble-cr"></td>';c+="</tr>";c+="<tr>";c+=' <td class="bubble-bl"></td>';c+=' <td class="bubble-blt"></td>';c+=' <td class="bubble-br"></td>';c+="</tr>";c+="</tbody>";c+="</table>";c+="</div>";}if(a!=undefined&&a=="true"){$(".admincalendarviewmorepopupdiv").removeClass("more-list");$(".admincalendarviewmorepopupdiv").addClass("left-narrow").html(c);$(".admincalendarviewmorepopupdiv").css("position","absolute");$(".admincalendarviewmorepopupdiv").css("top",d.pageY-121);$(".admincalendarviewmorepopupdiv").css("left",$(b).position().left-210);}else{$(".admincalendarviewmorepopupdiv").removeClass("more-list");$(".admincalendarviewmorepopupdiv").addClass("left-narrow").html(c);$(".admincalendarviewmorepopupdiv").css("position","absolute");$(".admincalendarviewmorepopupdiv").css("top",d.pageY-170);$(".admincalendarviewmorepopupdiv").css("left",$(b).position().left+189);
}vtip();$(".admincalendarviewmorepopupdiv").show();try{$("#narrowadmincalendarviewmorepopup").toggle();if($(".calviewmorepopup-content").height()>270&&$(".more-text").length==0){$(".calviewmorepopup-content").jScrollPane();}}catch(h){}closePopupOnEscAndOutsideClick(".admincalendarviewmorepopupdiv");}function closePopupOnEscAndOutsideClick(b){var a=1,c=$newJquery(b).hover(function(){a^=1;});$newJquery(document).on("mousedown keydown",function(f){var g=f.target.className.split(" ");var d=g.indexOf("link");if(d==-1&&a||f.which==27){c.hide();$(".today-events div.order").removeClass("order");$(".today-events div.ilt-cls").removeClass("ilt-cls");$(".today-events div.vcl-cls").removeClass("vcl-cls");$(".today-events div.report").removeClass("report");$(".tmrw-events div.order").removeClass("order");$(".tmrw-events div.ilt-cls").removeClass("ilt-cls");$(".tmrw-events div.vcl-cls").removeClass("vcl-cls");$(".tmrw-events div.report").removeClass("report");}});}function adminCalCloseHandler(a){if(a=="classaddedit"){$.cookie("delivery_type","");
$.cookie("startdate","");getCalendarData();}}function setCloseHandler(a){window.setTimeout(function(){$(".ui-icon-closethick").click(function(){calendarallpopupclose();$.cookie("delivery_type","");$.cookie("startdate","");getCalendarData();});if(a!="edit"){$.cookie("delivery_type",a);}},5000);if(a!="edit"){window.setTimeout(function(){if($("#edit-from-date").size()>0){$("#edit-from-date").val($.cookie("startdate"));}else{window.setTimeout(function(){if($("#edit-from-date").size()>0){$("#edit-from-date").val($.cookie("startdate"));}},2000);}},2000);}}function displayLoadingImageForCalendar(){if($("#loadingcalendarimg").size()==0){$("body").append("<div id='loadingcalendarimg' style='display:block; position:absolute; left:54%; top:0; margin-top:420px; background:none; padding:10px; z-index:1;'><img src='/sites/all/themes/core/expertusoneV2/expertusone-internals/images/loader.gif'></img></div>");}else{$("#loadingcalendarimg").show();}}function hideLoadingImageForCalendar(){$("#loadingcalendarimg").hide();
}function displayReportsRowsForAC(d){adminCalDestroyLoader();var c=JSON.parse(d);var b="";b+='<div class="reports">';if(c.length>0){b+="<h4>"+Drupal.t("REPORTS")+": </h4>";for(var a=0;a<c.length;a++){var f=c[a];if(f.title!=null&&f.title!="null"&&f.title!=""){$("body").append('<div id="create-schedule-'+f.id+'" class="create-schedule-popup"></div>');b+='<div class="links header-popup" >';b+='<a onClick="setCSSForReport();" id="report-schedule-link-'+f.id+'" data-wrapperid="paint-narrow-search-results" class="createnewclass use-ajax report-schedule-region ajax-processed"  href="?q=administration/report-search/schedules/'+f.id+"\" data-qtip-obj=\"{  'holderId': 'create-schedule-"+f.id+"', 'id': 'create-schedule-qtip-"+f.id+"', 'placement': 'above-or-below', 'launchedFrom': 'admincalendar'}\"><span class=\"report-list-icon\"></span><span class=\"vtip\" title=\""+f.title+'"><span>'+f.title+"</span></span></a>";b+="</div>";}}}else{b+='<div class = "no-records">';b+=Drupal.t("No published reports are present in the system");
b+="</div>";}$("#popupcontent").html(b);$(".reports").css("height","200px");$(".reports").css("width","235px");$(".reports").css("overflow","auto");$(".reports").jScrollPane({width:"1px"});attachEvents(".createnewclass");vtip();}function displayReportsForCalendar(){$("body").removeClass("page-administration-learning-catalog page-administration-manage-announcement page-administration-commerce page-administration-commerce-order page-reports section-administration");adminCalCreateLoader();var a=$newJquery("#calendarnarrowview").fullCalendar("getDate");$.ajax({url:"/?q=administration/viewreportsforcalendar",METHOD:"post",data:"startDate="+a,success:function(b){adminCalDestroyLoader();displayReportsRowsForAC(b);}});}function changeOrderAction(a,b){$(".orderlinks").css("top",b.pageY);$(".orderlinks").css("left",b.pageX-80);$(".orderlinks").css("display","block");var c="dd-"+$(a).attr("data");$("."+c).css("display","block");}function applyOrderAction(d,a,b){revertFuncDummy();$(".orderlinks").css("display","none");
var c="";switch(a){case"approve":c="payment_received";break;case"cancel":c="canceled";break;default:c="";break;}adminCalCreateLoader();$.ajax({type:"GET",url:"/?q=administration/calendar/order-update/"+d+"/"+c,success:function(f){adminCalDestroyLoader();getDataViewReportOrderPopup("",b,"");if(f=="session_out"){self.location="?q=user";return;}},failure:function(f){adminCalDestroyLoader();}});}function magnifyCell(a){}function removeHTMLTags(a){var b=/(<([^>]+)>)/ig;if(a!=null){return a.replace(b,"");}return a;}function displayShortTitle(c,b){var a="";if(c==null){return"";}a=titleRestrictionFadeoutImage(c,"admin-cal-left-title");return a;}function createOrderOrDisplayDiscussionFromAdminCalendar(a){calendarallpopupclose();if($(a).attr("data")=="order"){myWindow=window.open("/?q=administration/order/create","myWindow","width=1200, height=800, scrollbars=1");}else{myWindow=window.open($(a).attr("href"),"myWindow","width=1200, height=600, scrollbars=1");}var b=window.setInterval(function(){if(myWindow&&myWindow.closed){window.clearInterval(b);
getCalendarData();}},500);}function admincalendarmouseover(b){var m=$newJquery("#calendarprimaryview .fc-day");for(var h=0;h<m.length;h++){var k=$newJquery(m[h]);var f=b.pageX;var d=b.pageY;var g=k.offset();var c=k.width();var l=k.height();if(f>=g.left&&f<=g.left+c&&d>=g.top&&d<=g.top+l){var a=0;$newJquery("#calendarprimaryview").fullCalendar("clientEvents",function(o){if(o.start.format("MM-DD-YYYY")==moment(k.attr("data-date")).format("MM-DD-YYYY")){a++;}});if(a>3){$newJquery(".admincalendarviewmorepopupdiv").remove();var n='<div class="admincalendarviewmorepopupdiv" style="position:absolute;z-index:15001;"></div>';$newJquery("body").append(n);$newJquery(".admincalendarviewmorepopupdiv").css("top",g.top-10);$newJquery(".admincalendarviewmorepopupdiv").css("left",g.left-10);$newJquery(".admincalendarviewmorepopupdiv").css("display","block");$newJquery(".admincalendarviewmorepopupdiv").html("");displayMorePopup(k,b);}}}attachEvents("#calendarprimaryview .fc-title a");attachEvents(".order_row");
}function getCalendarCellAddImg(a,b){if(b==undefined){b="";}var c="<a class='add_img "+a+" vtip' href='javascript:void(0)' data-date='"+b+"' title='"+Drupal.t("ACLBL0036")+"' onclick='addObjectThroughAdmCalendar(this,event);'><span class='add-icon'>A </span></a>";return c;}function getCalendarCellListImg(a,b){if(b==undefined){b="";}var c="<a class='list_img "+a+" vtip' href='javascript:void(0)' data-date='"+b+"' onclick='listObjectThroughAdmCalendar(this,event);' title='"+Drupal.t("ACLBL0029")+"' ><span class='list-icon'> L</span></a>";return c;}var mouseOverDelay=function(a,c){var b=null;$newJquery("#calendarprimaryview .fc-more").on("mouseover",function(d){globalMouseEvent=d;if(b==null){var f=$newJquery(this);b=setTimeout(function(){f.click();return false;},500);}});$newJquery("#calendarprimaryview .fc-more").on("mouseout",function(d){if(b!=null){clearTimeout(b);b=null;}});};function setCSSForReport(){$(".admincalendarviewmorepopupdiv, #admincalendarviewmorepopup").css("z-index","1001");
$("body").addClass("page-reports");setCloseHandler("");}function adminCalendarPopup(f,c){try{$("#admincalendar-wizard").remove();var a="";a+='<div id="admincalendar-wizard" style="display:none; padding: 0px;">';a+='<table width="100%" cellpadding="0" cellspacing="0" border="0" valign="center">';a+='<tr><td height="30"></td></tr>';a+="<tr>";a+='<td align="center" class="commanTitleAll">'+c+"</td>";a+="</tr>";a+="</table>";a+="</div>";$("body").append(a);$("#admincalendar-wizard").dialog({position:[(getWindowWidth()-500)/2,100],bgiframe:true,width:500,resizable:false,modal:true,title:SMARTPORTAL.t(f),closeOnEscape:false,draggable:true,overlay:{opacity:0.9,background:"black"}});$("#admincalendar-wizard").show();changeDialogPopUI();$("#admincalendar-wizard").after('<div class="popupBotLeftCorner ui-helper-clearfix"><div class="popupBotRightCorner"><div class="popupBotmiddle"></div></div></div>');$(".ui-dialog-titlebar-close").click(function(){$("#admincalendar-wizard").remove();});var b=parseInt($("#admincalendar-wizard").css("min-height"))-30;
$("#admincalendar-wizard").css("min-height",b);}catch(d){}}function callAjaxForIE(a,c){var b;b=new XMLHttpRequest();b.onreadystatechange=function(){if(b.readyState==4&&b.status==200){c(b.responseText);}};b.open("GET",a,true);b.send();}function eventDropErrorMsg(b,c,a){adminCalendarPopup("Alert",Drupal.t("ACLBL0033"));a();return false;}function eventCanBeDisplayed(b){var a=$.cookie("admincalendar_pref");a=JSON.parse(a);switch(b.type){case"order":if(a.view_orders){return true;}break;case"event_regend":if(a.view_events){return true;}break;case"event_regcancel":if(a.view_events){return true;}break;case"lrn_cls_dty_ilt":if(a.view_classroom){return true;}break;case"lrn_cls_dty_vcl":if(a.view_virtualclassroom){return true;}break;case"cre_sys_obt_anm":if(a.view_announcements){return true;}break;case"report":if(a.view_scheduled_report){return true;}break;case"location":if(a.view_locations){return true;}break;case"instructor":if(a.view_instructors){return true;}break;}return false;}function eventClass(b){var a="event-default";
switch(b.type){case"order":a="event_order";break;case"event_regend":a="event_redend";break;case"event_regcancel":a="event_regcancel";break;case"lrn_cls_dty_ilt":a="event_ilt";break;case"lrn_cls_dty_vcl":a="event_vcl";break;case"cre_sys_obt_anm":a="event_announcement";break;case"report":a="event_report";break;case"location":a="event_location";break;}return a;}function randomId(){var c="";var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(var b=0;b<5;b++){c+=a.charAt(Math.floor(Math.random()*a.length));}return c;}function revertFuncDummy(){closeDragConfirmWizard();}function showHideLabelFocus(){$("#narrow-search-calendar-filter").addClass("admincalendar_search_textbox");var a=$("#narrow-search-calendar-filter").val();if(a==Drupal.t("LBL304")){$("#narrow-search-calendar-filter").val("");}}function showHideLabelBlur(){var a=$("#narrow-search-calendar-filter").val();if(a==""||a==Drupal.t("LBL304")){$("#narrow-search-calendar-filter").val(Drupal.t("LBL304"));$("#narrow-search-calendar-filter").removeClass("admincalendar_search_textbox");
}}function moreClassSearchHideShow(){var a=jQuery.parseJSON($.cookie("admincalendar_pref"));if((a.view_classroom==false)&&(a.view_virtualclassroom==false)&&(a.view_scheduled_report==false)&&(a.view_orders==false||ADMIN_CALENDAR_PERM_LIST.commerce==false)){return;}reArangeSearchFilter();$("#narrow-search-calendar-filter").flushCache();$("#select-list-calendar-dropdown-list").slideToggle();$("#select-list-calendar-dropdown-list li:last").css("border-bottom","0px none");}function moreClassSearchTypeText(b,a){b=unescape(b);b=$.trim(b);$("#select-list-calendar-dropdown-list").hide();$("#select-list-calendar-dropdown").attr("title",b);if(b.length>=13){$("#select-list-calendar-dropdown").html(b+'<span class="fade-out"></span>');}else{$("#select-list-calendar-dropdown").html(b);}$("#search_all_calendar_type-hidden").val(a);}$(function(){$("#narrow-search-calendar-filter").focus(function(b){$("#select-list-calendar-dropdown-list").css("display","none");});$("#narrow-search-calendar-filter").keyup(function(c){try{if(c.keyCode==13){var b=$("#narrow-search-calendar-filter").val();
var f=Drupal.t("LBL304").toUpperCase();if((b.toLowerCase())==(f.toLowerCase())){b="";}if(b!=""){$.ajax({url:"/?q=administration/calendarviewapi",METHOD:"post",data:"search_type="+$("#search_all_calendar_type-hidden").val()+"&search_text="+b,success:function(g){adminCalDestroyLoader();calendardata=JSON.parse(g);$newJquery("#calendarprimaryview").fullCalendar("removeEvents");$newJquery("#calendarnarrowview").fullCalendar("removeEvents");updateAdminCalendarEvents(calendardata);},failure:function(g){adminCalDestroyLoader();}});}}}catch(d){}});$("#narrow-search-calendar-filter-go").click(function(){try{var b=$("#narrow-search-calendar-filter").val();var f=Drupal.t("LBL304").toUpperCase();var c="";if(b==Drupal.t("LBL304")){var m=getACSearchParams();startDate=$newJquery("#calendarprimaryview").fullCalendar("getView").start.format("YYYY-MM-DD");endDate=$newJquery("#calendarprimaryview").fullCalendar("getView").end.format("YYYY-MM-DD");c="startDate="+startDate+"&endDate="+endDate+m;}else{c="omitdatefilter=true&search_type="+$("#search_all_calendar_type-hidden").val()+"&search_text="+$("#narrow-search-calendar-filter").val();
}var h="",d="0";var g="";var l=$newJquery("#calendarprimaryview").fullCalendar("getView").name;adminCalCreateLoader();$.ajax({url:"/?q=administration/calendarviewapi",METHOD:"post",data:c,timeout:Drupal.settings.cal.admin_calendar_search_max_time,success:function(o){adminCalDestroyLoader();calendardata=JSON.parse(o);if(l=="agendaDay"&&calendardata.length>0){g=jQuery.grep(calendardata,function(q,p){return q.allDay==false;});if(g.length>0){h=((moment(g[0].start).format("h:mm a").replace(/ /g,"")).replace(":00","")).replace(":15",":30").replace(":45",":30");}$(".fc-time-grid-container").scrollTop(0);$(".fc-time-grid-container .fc-slats table tr").each(function(){if($(this).find(".fc-axis span").eq(0).text()==h){d=parseInt($(this).offset().top)-parseInt(294);}});}$newJquery("#calendarprimaryview").fullCalendar("removeEvents");$newJquery("#calendarnarrowview").fullCalendar("removeEvents");updateAdminCalendarEvents(calendardata);if(calendardata.length>0){var n=moment(calendardata[0].start.substring(0,10));
formatCalendarDataSummary(n.format("YYYY-MM-DD"),"",n);}$newJquery("#calendarprimaryview  .fc-prev-button").attr("ajaxrequired","false");attachEvents("#calendarprimaryview .fc-title a");if(calendardata.length>0&&(b.toLowerCase())!=(f.toLowerCase())){$newJquery("#calendarprimaryview").fullCalendar("gotoDate",moment(calendardata[0].start.substring(0,10)));$newJquery("#calendarnarrowview").fullCalendar("gotoDate",moment(calendardata[0].start.substring(0,10)));}if(l=="agendaDay"&&calendardata.length>0){setTimeoutConst=setTimeout(function(){setscrollpostion(d);},300);}},error:function(q,n,p){if(n=="timeout"){adminCalDestroyLoader();var o=new Array();o[0]=Drupal.t("ERR1762");$("#show_expertus_message").html(expertus_error_message(o,"error"));$("#show_expertus_message").show();}},failure:function(n){adminCalDestroyLoader();}});}catch(k){}});if($("#narrow-search-calendar-filter")){try{format_ac_item=function(f,b,d){var c=JSON.parse(f);return"<div class='list-item' autocompletemousever='true' data=\""+escape(escape(JSON.stringify(c)))+"\" onMouseover='showSessionDetailsFromCalendarSummary(this,event);'><span title='"+c.title+"'>"+c.title+"</span></div>";
};$("#narrow-search-calendar-filter").autocomplete("/?q=administration/calendar-autocomplete",{minChars:3,max:50,autoCompleteTimeOut:Drupal.settings.cal.admin_calendar_search_max_time,errMsg:Drupal.t("ERR1762"),autoFill:true,mustMatch:false,matchContains:false,inputClass:"ac_input",loadingClass:"ac_loading",formatItem:format_ac_item,error:function(){alert("Request time out");if(status=="timeout"){alert("Request time out1");}},select:function(b,c){alert("|"+$("#targetID").val()+"|1stAlert");},error:function(){response([]);},extraParams:{calendar_searchtype:function(){return $("#search_all_calendar_type-hidden").val();}}}).result(function(b,d,c){var f=JSON.parse(d).title;$("#narrow-search-calendar-filter").val($("<div/>").html(f).text());});}catch(a){}}});function setscrollpostion(a){$(".fc-time-grid-container").scrollTop(a);}function eventDropUpdate(f,h,d){var b=$newJquery("#calendarprimaryview").fullCalendar("getView");closeDragConfirmWizard();if(b.name=="agendaDay"){if(f.type=="event_regend"||f.type=="event_regcan"||f.type=="order"||f.type=="report"){adminCalendarPopup("Calendar",Drupal.t("ACLBL0039"));
d();return false;}if((f.allDay==true||(f.end==null||f.end==""))){adminCalendarPopup("Calendar",Drupal.t("ACLBL0039"));d();return false;}else{var a=f.start.format("MM-DD-YYYY");var g=f.end.format("MM-DD-YYYY");if(a!=g){adminCalendarPopup("Calendar",Drupal.t("ACLBL0039"));d();return false;}}}if(f.type=="order"||f.type=="report"){adminCalendarPopup("Calendar",Drupal.t("ACLBL0021"));d();return false;}var c=isDatePastTodayFuture(f,"update");if(c=="fc-past"&&f.type!="lrn_cls_dty_ilt"&&f.type!="lrn_cls_dty_vcl"&&f.type!="event_regend"){adminCalendarPopup("Calendar",Drupal.t("ACLBL0021"));d();return"";}else{if(f.editable!=null&&f.editable==1){calendarUpdateData(f,d);}else{eventDropErrorMsg(f,h,d);}}}function checkSessionOut(){var a=obj.getLearnerId();if(a=="0"||a==""){self.location="/";return false;}}function getEventbyId(b,a){return b.filter(function(c){return c.id==a;});}function translateTimingStr(a){if(a==""){return a;}if(a.indexOf("AM")>0){timing=a.replace("AM",Drupal.t("LBL863").toUpperCase());
}else{if(a.indexOf("PM")>0){timing=a.replace("PM",Drupal.t("LBL864").toUpperCase());}else{timing=a;}}return timing;}function displayDragConfirm(l,a,n,k,d){try{var g="";var p=Drupal.settings.ajaxPageState.theme;var q=(q)?q:300;var m="";$("#delete-msg-wizard").remove();if(k=="order_update"){l=l;}else{l=l+"?";}var f="";f+='<div id="delete-msg-wizard" style="display:none; padding: 0px;">';f+='<table width="100%" cellpadding="0" cellspacing="0" border="0" valign="center">';if(p=="expertusoneV2"){f+='<tr><td style="padding: 30px 24px;" class="commanTitleAll">'+l+"</td></tr>";}else{f+='<tr><td color="#333333" style="padding: 30px 24px; text-align: justify;">'+l+"</td></tr>";}f+="</table>";f+="</div>";$("body").append(f);var c="";if(k=="order_update"){m=function(){applyOrderAction(a,n,d);};var o={};o[Drupal.t("LBL109")]=function(){closeDragConfirmWizard();revertFuncDummy();};o[Drupal.t("Yes")]=m;c=Drupal.t("LBL820")+" - "+a;}else{m=function(){eventDropUpdate(a,n,k);};var o={};o[Drupal.t("LBL109")]=function(){closeDragConfirmWizard();
k();};o[Drupal.t("Yes")]=m;c=Drupal.t("LBL943")+" "+Drupal.t("LBL042");}$("#delete-msg-wizard").dialog({position:[(getWindowWidth()-400)/2,200],bgiframe:true,width:q,minHeight:"auto",resizable:false,modal:true,title:c,buttons:o,closeOnEscape:false,draggable:false,overlay:{opacity:0.9,background:"black"}});$(".ui-dialog").wrap("<div id='delete-object-dialog' class='"+g+"'></div>");$(".ui-dialog-buttonpane .ui-dialog-buttonset button:eq(0)").addClass("removebutton").end();$(".ui-dialog-buttonpane .ui-dialog-buttonset button:eq(1)").before('<div class="admin-save-button-left-bg"></div>');$(".ui-dialog-buttonpane .ui-dialog-buttonset button:eq(1)").addClass("admin-save-button-middle-bg").end();$(".ui-dialog-buttonpane .ui-dialog-buttonset button:eq(1)").after('<div class="admin-save-button-right-bg"></div>');$("#delete-msg-wizard").show();$(".ui-dialog-titlebar-close").click(function(){$("#delete-msg-wizard").remove();if(k=="order_update"){revertFuncDummy();}else{k();}});if(p=="expertusoneV2"){changeDialogPopUI();
}$("#delete-msg-wizard .commanTitleAll").css("padding","30px 24px");if($("div.qtip-defaults").length>0){var b=$(".qtip-defaults").css("z-index");$("#delete-object-dialog .ui-widget-content").css("z-index",b+2);$(".ui-widget-overlay").css("z-index",b+1);}}catch(h){}}function closeDragConfirmWizard(){$("#delete-msg-wizard").dialog("destroy");$("#delete-msg-wizard").dialog("close");$("#delete-msg-wizard").remove();}function attachMouseOver(){var a=1000,b;$("#calendarprimaryview .fc-more").hover(function(){b=setTimeout(function(){$(this).append($("<span> ***</span>"));$(this).click();},a);},function(){clearTimeout(b);});}function calculateTimeDiff(c){var a=c.split(" - ");var b=a[0];var h=a[1];var q=b.split(":");var o=parseInt(q[0]);var p=parseInt(q[1]);var l=h.split(":");var g=parseInt(l[0]);var k=parseInt(l[1]);var d=o*60+p;var n=g*60+k;var s;if(n<d){var m=24*60;s=m-d;s+=n;}else{s=n-d;}var r=s%60;var f=(s-r)/60;return f+":"+(r<10?"0"+r:r);}function calTimeFormat(h,c,g,b){moment.locale("en-us");
var f=(h==undefined||h=="undefined")?moment.utc().format("YYYY-MM-DD"):h;var a=(b=="undefined"||b==undefined)?moment(f+"T"+c+":00").format("h:mm a"):moment(f+"T"+c+":00").format("hh:mm a");if(b=="undefined"||b==undefined){var d=a.replace(":00","");}else{var d=a;}if(g==true){return d;}return d.slice(0,-1).replace(/ /g,"");}function removeExistingEvents(d,b){for(var c=d.length-1;c>=0;c--){for(var a=0;a<b.length;a++){if(d[c]&&(d[c].id===b[a].event.id)){d.splice(c,1);}}}return d;}function adminCalCreateLoader(a){a=typeof a!=="undefined"?a:"calendar";obj.createLoader(a);}function adminCalDestroyLoader(a){a=typeof a!=="undefined"?a:"calendar";obj.destroyLoader(a);if($("#loaderdivmain-wrapper").length>0){obj.destroyLoader("main-wrapper");}}