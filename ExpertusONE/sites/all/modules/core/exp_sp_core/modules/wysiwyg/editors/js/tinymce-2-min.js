(function(a){Drupal.wysiwyg.editor.init.tinymce=function(b){for(var d in b){tinyMCE.init(b[d]);if(Drupal.settings.wysiwyg.plugins[d]){for(var c in Drupal.settings.wysiwyg.plugins[d]["native"]){tinyMCE.loadPlugin(c,Drupal.settings.wysiwyg.plugins[d]["native"][c]);}for(var c in Drupal.settings.wysiwyg.plugins[d].drupal){Drupal.wysiwyg.editor.instance.tinymce.addPlugin(c,Drupal.settings.wysiwyg.plugins[d].drupal[c],Drupal.settings.wysiwyg.plugins.drupal[c]);}}}};Drupal.wysiwyg.editor.attach.tinymce=function(b,e,d){for(var c in d){tinyMCE.settings[c]=d[c];}$field=a("#"+e.field);$field.val($field.val().replace(/(<.+?\s+class=['"][\w\s]*?)\bmceItem\b([\w\s]*?['"].*?>)/ig,"$1$2"));tinyMCE.execCommand("mceAddControl",true,e.field);};Drupal.wysiwyg.editor.detach.tinymce=function(c,d,b){if(typeof d!="undefined"){tinyMCE.removeMCEControl(tinyMCE.getEditorId(d.field));a("#"+d.field).removeAttr("style");}};Drupal.wysiwyg.editor.instance.tinymce={addPlugin:function(c,b,d){if(typeof Drupal.wysiwyg.plugins[c]!="object"){return;
}tinyMCE.addPlugin(c,{execCommand:function(j,f,i,k,h){switch(i){case c:if(typeof Drupal.wysiwyg.plugins[c].invoke=="function"){var e=tinyMCE.getInstanceById(j);var g={format:"html",node:e.getFocusElement(),content:e.getFocusElement()};Drupal.wysiwyg.plugins[c].invoke(g,d,e.formTargetElementId);return true;}}return false;},getControlHTML:function(e){switch(e){case c:return tinyMCE.getButtonHTML(e,b.iconTitle,b.icon,c);}return"";},initInstance:function(e){if(b.css){tinyMCE.importCSS(e.getDoc(),b.css);}},cleanup:function(e,f){switch(e){case"insert_to_editor":if(typeof Drupal.wysiwyg.plugins[c].attach=="function"){f=Drupal.wysiwyg.plugins[c].attach(f,d,tinyMCE.selectedInstance.editorId);f=Drupal.wysiwyg.editor.instance.tinymce.prepareContent(f);}break;case"get_from_editor":if(typeof Drupal.wysiwyg.plugins[c].detach=="function"){f=Drupal.wysiwyg.plugins[c].detach(f,d,tinyMCE.selectedInstance.editorId);}break;}return f;},handleNodeChange:function(j,h,i,g,e,f){if(h===null){return;}if(typeof Drupal.wysiwyg.plugins[c].isNode=="function"){if(Drupal.wysiwyg.plugins[c].isNode(h)){tinyMCE.switchClass(j+"_"+c,"mceButtonSelected");
return true;}}tinyMCE.switchClass(j+"_"+c,"mceButtonNormal");return true;},getInfo:function(){return{longname:b.title};}});},openDialog:function(b,d){var c=tinyMCE.getInstanceById(this.field);tinyMCE.openWindow({file:b.url+"/"+this.field,width:b.width,height:b.height,inline:1},d);},closeDialog:function(b){var c=tinyMCE.getInstanceById(this.field);tinyMCEPopup.close();},prepareContent:function(c){var d={img:{name:"mce_drupal"}};var b=a("<div>"+c+"</div>");jQuery.each(d,function(f,e){b.find(f).each(function(){for(var g in e){if(g=="class"){a(this).addClass(e[g]);}else{a(this).attr(g,e[g]);}}});});return b.html();},insert:function(c){c=this.prepareContent(c);var b=tinyMCE.getInstanceById(this.field);b.execCommand("mceInsertContent",false,c);b.repaint();}};})(jQuery);