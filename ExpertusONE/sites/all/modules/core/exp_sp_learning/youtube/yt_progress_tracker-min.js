var videourl;var height;var video_progress;var session_id;var update_frequency;if(Drupal.settings.youtubesetting.url!=""){videourl=Drupal.settings.youtubesetting.url;height=Drupal.settings.youtubesetting.height;width=Drupal.settings.youtubesetting.width;video_progress=Drupal.settings.youtubesetting.video_progress;session_id=Drupal.settings.youtubesetting.session_id;update_frequency=Drupal.settings.youtubesetting.update_frequency;}var previous_position=0;var current_position=0;var video_duration=0;var progress=0;interval=null;ajaxInterval=null;updateStatusToDB=null;var data={session_id:session_id,previous_position:previous_position,current_position:current_position,progress:progress,video_duration:video_duration,from:"web",content_type:"youtube"};videoTrackerProgress={session_id:session_id,previous_position:previous_position,current_position:current_position,progress:progress,video_duration:video_duration,additional_data:{video_session_id:session_id},content_type:"youtube"};var ytPlayer;
window.YouTubeIframeAPIReady!==undefined&&window.YouTubeIframeAPIReady&&onYouTubeIframeAPIReady();function onYouTubeIframeAPIReady(){window.YouTubeIframeAPIReady=true;setTimeout(function(){$("#loaderdivmodal-content").css("display","none");},3000);ytPlayer=new YT.Player("ytPlayer",{events:{onStateChange:onPlayerStateChange}});}function onYouTubePlayerAPIReady(){}function onPlayerStateChange(c){switch(c.data){case -1:ytPlayer.seekTo(previous_position,true);data.video_duration=ytPlayer.getDuration();videoTrackerProgress.video_duration=data.video_duration;break;case 0:var a=100;var b=isNaN(a)==false?a:0;videoTrackerProgress={session_id:session_id,current_position:ytPlayer.getCurrentTime(),progress:b,video_duration:ytPlayer.getDuration(),additional_data:{video_session_id:session_id},content_type:"youtube"};updateVideoProgress();clearInterval(interval);clearInterval(ajaxInterval);break;case 1:updateyoutube();break;case 2:clearInterval(interval);clearInterval(ajaxInterval);break;}}function updateyoutube(){if(interval!=null){clearInterval(interval);
}if(ajaxInterval!=null){clearInterval(ajaxInterval);}data.video_duration=ytPlayer.getDuration();videoTrackerProgress.video_duration=data.video_duration;interval=setInterval(function(){if(document.getElementById("ytPlayer")){if(data.progress==100){return;}data.previous_position=data.current_position;data.current_position=ytPlayer.getCurrentTime();videoTrackerProgress.previous_position=data.previous_position;videoTrackerProgress.current_position=data.current_position;var a=(ytPlayer.getCurrentTime()/ytPlayer.getDuration())*100;data.progress=isNaN(a)==false?a:video_progress;videoTrackerProgress.progress=data.progress;}},1000);ajaxInterval=setInterval(function(){updateVideoProgress();},update_frequency);}function updateVideoProgress(){$.ajax({url:"?q=ajax/update-launch/vod",type:"POST",data:videoTrackerProgress,success:function(){},error:function(){},complete:function(){}});}setTimeout(function(){$("#loaderdivmodal-content").css("display","none");},3000);