(function(a){a.widget("ui.showmore",{options:{showMore:"#jqgrid-show-more",grid:null,gridWrapper:null},_init:function(){try{this.refreshShowMore();this.attachShowMoreBehavior();}catch(b){}},refreshShowMore:function(){try{var c=a(this.options.grid);var g=a(this.options.showMore);var f=c.getGridParam("rowNum");var b=c.getGridParam("reccount");if(f>b){g.hide();}else{g.show();}c.find("tr.ui-widget-content.ui-widget-content-last-row").removeClass("ui-widget-content-last-row");c.find("tr.ui-widget-content").filter(":last").addClass("ui-widget-content-last-row");}catch(d){}},attachShowMoreBehavior:function(){try{var d=this;var c=a(this.options.showMore);if(c.hasClass("show-more-attached")==false){c.bind("click",function(){d.showMoreData();}).addClass("show-more-attached");}}catch(b){}},showMoreData:function(){try{var g=this;var c=a(this.options.grid);var b=a(this.options.gridWrapper);if(c.data("isAjax")){return;}var h=a(this.options.showMore);var g=this;var d={beforeSend:function(){g.createLoader(b.attr("id"));
b.find(".loadercontent").css({display:"table"}).find("div:not(.loaderimg)").css({display:"table-cell","vertical-align":"bottom"}).find("td").attr("valign","bottom");c.data("isAjax",true);},onComplete:function(){try{c.data("isAjax",false);g.destroyLoader(b.attr("id"));}catch(i){}},onSuccess:function(){},onError:function(){},noData:function(){h.hide();g.refreshShowMoreDataOnScroll(false);},beforeAppend:function(){c.find("tr.ui-widget-content").filter(":last").removeClass("ui-widget-content-last-row");},afterAppend:function(i,e){if(c.getGridParam("rowNum")<=e){h.show();}else{h.hide();g.refreshShowMoreDataOnScroll(false);}c.find("tr.ui-widget-content").filter(":last").addClass("ui-widget-content-last-row");}};c.jqGrid("appendDataToGrid",d);g.refreshShowMoreDataOnScroll(true);g.attachMouseLeaveHandler();}catch(f){}},refreshShowMoreDataOnScroll:function(b){try{var d=this;if(b){if(a(window).hasClass("scroll-showmore-attached")==false){a(window).bind("scroll.showmore mousewheel.showmore",function(g){if(typeof lastScrollTop=="undefined"||lastScrollTop==null){lastScrollTop=a(this).scrollTop();
}else{var f=a(this).scrollTop();if(f>lastScrollTop){d.showMoreDataOnScroll();}lastScrollTop=f;}});a(window).addClass("scroll-showmore-attached");}}else{a(window).unbind("scroll.showmore").unbind("mousewheel.showmore").removeClass("scroll-showmore-attached");lastScrollTop=null;}}catch(c){}},attachMouseLeaveHandler:function(){try{var f=this;var c=a(this.options.grid);var b=a(this.options.gridWrapper);if(!c.hasClass("mouseleave-showmore-attached")){a(c).bind("mouseleave.showmore",function(g){var h=g.toElement||g.relatedTarget;var e=(a(h).attr("id")=="vtip"||a(h).attr("id")=="vtipArrow");if(!e&&a(h).parents("#"+b.attr("id")).length==0){f.refreshShowMoreDataOnScroll(false);}}).addClass("mouseleave-showmore-attached");}}catch(d){}},showMoreDataOnScroll:function(c){try{var f=this;var b=a(this.options.grid);if(b.is(":hover")){f.showMoreData();}}catch(d){}}});a.extend(a.ui.showmore.prototype,EXPERTUS_SMARTPORTAL_AbstractManager,EXPERTUS_SMARTPORTAL_AbstractDetailsWidget,{defaults:{start:true,catStart:true}});
})(jQuery);