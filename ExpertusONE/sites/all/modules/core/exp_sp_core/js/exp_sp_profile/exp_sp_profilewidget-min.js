registernamespace("EXPERTUS.SMARTPORTAL.ProfileManager");EXPERTUS.SMARTPORTAL.ProfileManager=function(){try{this.generateCreateRequest=function(f){try{var c=new Object();c.query=new SOAPObject("InsertProfile").attr("xsi:type","null");c.query.appendChild(new SOAPObject("list_id").attr("xsi:type","null").val(f.list_id));c.query.appendChild(new SOAPObject("parent_id").attr("xsi:type","null").val(f.parent_id));c.query.appendChild(new SOAPObject("level").attr("xsi:type","null").val(f.level));c.query.appendChild(new SOAPObject("name").attr("xsi:type","null").val(f.name));c.query.appendChild(new SOAPObject("root").attr("xsi:type","null").val(f.root));if(f.description!=undefined){c.query.appendChild(new SOAPObject("description").attr("xsi:type","null").val(f.description));}c.query.appendChild(new SOAPObject("code").attr("xsi:type","null").val(f.code));c.query.appendChild(new SOAPObject("language_code").attr("xsi:type","null").val(f.language_code));c.query.appendChild(new SOAPObject("attr1").attr("xsi:type","null").val(f.attr1));
c.query.appendChild(new SOAPObject("attr2").attr("xsi:type","null").val(f.attr2));c.query.appendChild(new SOAPObject("attr3").attr("xsi:type","null").val(f.attr3));c.query.appendChild(new SOAPObject("attr4").attr("xsi:type","null").val(f.attr4));c.query.appendChild(new SOAPObject("type").attr("xsi:type","null").val(f.type));c.query.appendChild(new SOAPObject("is_active").attr("xsi:type","null").val(f.is_active));var b=new SOAPRequest("InsertProfile",c);b="<?xml version='1.0' encoding='UTF-8'?>"+b;b=b.toString();return b;}catch(d){}};this.generateProfileRequest=function(f){try{var c=new Object();c.query=new SOAPObject("GetProfile").attr("xsi:type","null");c.query.appendChild(new SOAPObject("dummy").attr("xsi:type","null").val("1"));var b=new SOAPRequest("GetProfile",c);b="<?xml version='1.0' encoding='UTF-8'?>"+b;b=b.toString();return b;}catch(d){}};this.generateProfileAsyncRequest=function(f){try{var c=new Object();c.query=new SOAPObject("GetProfileAsync").attr("xsi:type","null");c.query.appendChild(new SOAPObject("id").attr("xsi:type","null").val(f.id));
c.query.appendChild(new SOAPObject("level").attr("xsi:type","null").val(f.level));c.query.appendChild(new SOAPObject("root").attr("xsi:type","null").val(f.root));var b=new SOAPRequest("GetProfileAsync",c);b="<?xml version='1.0' encoding='UTF-8'?>"+b;b=b.toString();return b;}catch(d){}};this.generateProfileDetsRequest=function(f){try{var c=new Object();c.query=new SOAPObject("GetProfileDets").attr("xsi:type","null");c.query.appendChild(new SOAPObject("id").attr("xsi:type","null").val(f.id));c.query.appendChild(new SOAPObject("level").attr("xsi:type","null").val(f.level));c.query.appendChild(new SOAPObject("root").attr("xsi:type","null").val(f.root));var b=new SOAPRequest("GetProfile",c);b="<?xml version='1.0' encoding='UTF-8'?>"+b;b=b.toString();return b;}catch(d){}};this.generateRenameProfileRequest=function(f){try{var c=new Object();c.query=new SOAPObject("RenameProfile").attr("xsi:type","null");c.query.appendChild(new SOAPObject("id").attr("xsi:type","null").val(f.id));c.query.appendChild(new SOAPObject("newname").attr("xsi:type","null").val(f.newname));
c.query.appendChild(new SOAPObject("level").attr("xsi:type","null").val(f.level));c.query.appendChild(new SOAPObject("root").attr("xsi:type","null").val(f.root));var b=new SOAPRequest("RenameProfile",c);b="<?xml version='1.0' encoding='UTF-8'?>"+b;b=b.toString();return b;}catch(d){}};this.generateDeleteProfileRequest=function(f){try{var c=new Object();c.query=new SOAPObject("DeleteProfile").attr("xsi:type","null");c.query.appendChild(new SOAPObject("id").attr("xsi:type","null").val(f.id));c.query.appendChild(new SOAPObject("level").attr("xsi:type","null").val(f.level));c.query.appendChild(new SOAPObject("root").attr("xsi:type","null").val(f.root));var b=new SOAPRequest("DeleteProfile",c);b="<?xml version='1.0' encoding='UTF-8'?>"+b;b=b.toString();return b;}catch(d){}};this.generateUpdateProfileRequest=function(f){try{var c=new Object();c.query=new SOAPObject("UpdateProfile").attr("xsi:type","null");c.query.appendChild(new SOAPObject("id").attr("xsi:type","null").val(f.id));c.query.appendChild(new SOAPObject("name").attr("xsi:type","null").val(f.name));
c.query.appendChild(new SOAPObject("root").attr("xsi:type","null").val(f.root));if(f.description!=undefined){c.query.appendChild(new SOAPObject("description").attr("xsi:type","null").val(f.description));}c.query.appendChild(new SOAPObject("code").attr("xsi:type","null").val(f.code));c.query.appendChild(new SOAPObject("language_code").attr("xsi:type","null").val(f.language_code));c.query.appendChild(new SOAPObject("attr1").attr("xsi:type","null").val(f.attr1));c.query.appendChild(new SOAPObject("attr2").attr("xsi:type","null").val(f.attr2));c.query.appendChild(new SOAPObject("attr3").attr("xsi:type","null").val(f.attr3));c.query.appendChild(new SOAPObject("attr4").attr("xsi:type","null").val(f.attr4));c.query.appendChild(new SOAPObject("level").attr("xsi:type","null").val(f.level));c.query.appendChild(new SOAPObject("type").attr("xsi:type","null").val(f.type));c.query.appendChild(new SOAPObject("is_active").attr("xsi:type","null").val(f.is_active));var b=new SOAPRequest("UpdateProfile",c);
b="<?xml version='1.0' encoding='UTF-8'?>"+b;b=b.toString();return b;}catch(d){}};this.generateProfileCodeRequest=function(f){try{var c=new Object();c.query=new SOAPObject("GetProfileCode").attr("xsi:type","null");c.query.appendChild(new SOAPObject("id").attr("xsi:type","null").val(f.parent_id));var b=new SOAPRequest("GetProfileCode",c);b="<?xml version='1.0' encoding='UTF-8'?>"+b;b=b.toString();return b;}catch(d){}};this.generateProfileByTypeRequest=function(f){try{var c=new Object();c.query=new SOAPObject("getProfileByType").attr("xsi:type","null");c.query.appendChild(new SOAPObject("type").attr("xsi:type","null").val(f.type));var b=new SOAPRequest("getProfileByType",c);b="<?xml version='1.0' encoding='UTF-8'?>"+b;b=b.toString();return b;}catch(d){}};this.exec=function(b){try{this.execute();}catch(c){}};this.execute=function(b){try{var c=this.getwidgetObject();if(b){c.createLoader(c.getUniqueWidgetId());}jQuery.ajaxSetup({xhr:function(){try{if(window.ActiveXObject){return new window.ActiveXObject("Microsoft.XMLHTTP");
}}catch(f){}return new window.XMLHttpRequest();}});jQuery.ajax({type:"POST",url:this.url,processData:false,data:this.requestXml,dataType:"text",contentType:"text/xml",async:true,success:function(e){c.responseText=c.Trim(e);c.convertResponseXml();if(b){c.destroyLoader(c.getUniqueWidgetId());}c.renderResults();},failure:function(e){c.responseText=c.Trim(e);c.convertResponseXml();if(b){c.destroyLoader(c.getUniqueWidgetId());}c.renderError();},error:function(e,g,f){c.responseText=c.Trim(e.responseText);c.convertResponseXml();if(b){c.destroyLoader(c.getUniqueWidgetId());}c.renderError();}});}catch(d){}};}catch(a){}};$.extend(EXPERTUS.SMARTPORTAL.ProfileManager.prototype,EXPERTUS.SMARTPORTAL.AbstractManager);registernamespace("EXPERTUS.SMARTPORTAL.ProfileWidget");EXPERTUS.SMARTPORTAL.ProfileWidget=function(){try{this.widgetGlobalName="EXPERTUS.SMARTPORTAL.ProfileWidget";this.mode="";this.current_node;this.created=0;this.tree;this.level;this.type;this.node_name;this.clop_node="";this.openall=false;
this.parent;this.root;this.perm;this.rootId;this.iniLevel;this.conTrStat;this.insertparam;this.parentCode;this.currentID;this.parentList;this.setDelId;this.render=function(e){this.renderBase(e,this);var c=[{divId:"titleDiv",funcName:"titleMessage"},{divId:"mainDiv",funcName:"showMain"}];$("#"+this.getUniqueWidgetId()).setPageLayout(c,this);$(".sp_msgwrap").hide();this.showTree();var b=[{code:"cre_sys_lng",language:"cre_sys_lng_eng"}];var d=new EXPERTUS.SMARTPORTAL.ProfileManager();d.initialize(this);reqStr=d.getLovRequest(b);d.requestXml=reqStr;d.execute();};this.toggleConTree=function(){if($("#conTreeDiv").css("display")=="none"){$("#conTreeDiv").slideDown();}else{$("#conTreeDiv").slideUp();}this.conTrStat=$("#conTree").css("display");};this.titleMessage=function(){return'<div class="front-block-header block-header sp_content_header"><h2 style="width: auto;">'+SMARTPORTAL.t(this.root=="R"?"Lookup Master":this.root)+"</h2></div>";};this.showMain=function(){var b="<div id='"+this.getUniqueWidgetId()+"profilemain' style='width:700px;'><div id='"+this.getUniqueWidgetId()+"profiletree' style='margin-top:10px;'></div></div>";
return b;};this.showTree=function(){var e=this;var g;var f;var c=new EXPERTUS.SMARTPORTAL.ProfileManager();c.initialize(this);$("#"+this.getUniqueWidgetId()+"profiletree").tree({callback:{beforeopen:function(i,h){if($(i).find("li ul").length==0){f=false;}else{f=true;}return true;},onopen:function(m,l){if($(m).find("li>span").length==0){var j=l.children(m);var h="";for(var k=0;k<j.length;k++){h="";if($(j[k]).attr("stats1")!=undefined&&$(j[k]).attr("stats1")!=""&&$(j[k]).attr("stats1")!="0"){h+='<span style="color:red" onclick="loadReportInfo()" class="imglink" title="'+$(j[k]).attr("stats1_desc")+'">('+$(j[k]).attr("stats1")+")</span>";}if($(j[k]).attr("stats2")!=undefined&&$(j[k]).attr("stats2")!=""&&$(j[k]).attr("stats2")!="0"){h+='<span style="color:blue"  class="imglink" title="'+$(j[k]).attr("stats2_desc")+'">('+$(j[k]).attr("stats2")+")</span>";}if($(j[k]).attr("stats3")!=undefined&&$(j[k]).attr("stats3")!=""&&$(j[k]).attr("stats3")!="0"){h+='<span style="color:orange"  class="imglink" title="'+$(j[k]).attr("stats3_desc")+'">('+$(j[k]).attr("stats3")+")</span>";
}if($(j[k]).attr("stats4")!=undefined&&$(j[k]).attr("stats4")!=""&&$(j[k]).attr("stats4")!="0"){h+='<span style="color:green"  class="imglink" title="'+$(j[k]).attr("stats4_desc")+'">('+$(j[k]).attr("stats4")+")</span>";}if(h!=""){$(j[k]).find("a:eq(0)").after(h);}}}if(e.mode!="createnode"&&e.mode!="savenode"){$(m).find("li").each(function(){if($(this).find("img").length==0){id=$(this).attr("id");$(this).append(e.getAccessHtml(id));}});}},beforedata:function(i,h){g=e.getLevel(i,h,-1);var j={id:$(i).attr("id"),level:g,root:e.root};if(!i){j.id=0;j.level=e.iniLevel;j.root=e.root;}c.requestXml=c.generateProfileAsyncRequest(j);return c.requestXml;},onselect:function(j,i){$("#conBlk").remove();var h='<div id="conBlk" style="left:800px;width:230px;display:none;position:absolute;top:'+($(j).position().top+115)+'px;"><fieldset class="links-fieldset" ><legend onclick="'+e.getWidgetInstanceName()+'.toggleConTree();" id="legend">Test</legend><div id="conTreeDiv"><div id="conTree" style="display:block;"></div></div></fieldset></div>';
$(document.body).append(h);$("#legend").html(i.get_text(j));e.showConTextTree($(j).attr("attr3"),$(j).attr("attr4"));},ondata:function(i,h){return i;},onparse:function(i,h){return i;},beforecreate:function(l,h,k,j){e.current_node=h;e.tree=j;e.type=k;e.level=e.getLevel(h,j,-1);if(k=="inside"){e.level++;}if(e.mode!="savenode"){e.mode="createnode";var m={parent_id:e.currentID};var i=new EXPERTUS.SMARTPORTAL.ProfileManager();i.initialize(e);i.requestXml=i.generateProfileCodeRequest(m);i.exec(l);if(k=="inside"){e.parent=h;}else{e.parent=j.parent(h);}return false;}else{return true;}},oncreate:function(i,h,j){e.created=1;e.current_node=i;},beforerename:function(j,k,i){e.remProf();e.level=e.getLevel(j,i,-1);e.node_name=i.get_text(j);if((e.mode=="createnode"||e.mode=="savenode")&&g!=1){i.select_branch(j);return true;}else{if(e.mode=="updated"){return true;}if(e.mode=="updatenode"){e.mode="";return true;}e.mode="renamenode";e.current_node=j;var h=new EXPERTUS.SMARTPORTAL.ProfileManager();h.initialize(e);
h.requestXml=h.generateProfileDetsRequest({id:j.id,level:e.level,root:e.root});h.exec(j);return false;}},onrename:function(k,i,l){g=e.getLevel(k,i,-1);if(e.mode=="updated"){e.mode="";$("#profile_update_wizard").dialog("close");$("#profile_update_wizard").dialog("destroy");$("#profile_update_wizard").remove();return;}if(e.created==1){e.created=0;var j=i.parent(k);var m={parent_id:$(j).attr("id"),level:g,name:i.get_text(k),description:"test",root:e.root};e.mode="createnode";var h=new EXPERTUS.SMARTPORTAL.ProfileManager();h.initialize(e);h.requestXml=h.generateCreateRequest(m);h.exec(k);}else{if(e.level==1){return;}else{if(e.node_name==i.get_text(k)){return;}var j=i.parent(k);var m={id:k.id,newname:i.get_text(k),level:g,root:e.root};e.mode="renamenode";var h=new EXPERTUS.SMARTPORTAL.ProfileManager();h.initialize(e);h.requestXml=h.generateRenameProfileRequest(m);h.exec(k);}}},beforedelete:function(i,h,j){e.remProf();g=e.getLevel(i,h,-1);e.current_node=h.parent(i);return true;},ondelete:function(j,i,k){var l={id:j.id,level:g,root:e.root};
e.mode="deletenode";var h=new EXPERTUS.SMARTPORTAL.ProfileManager();h.initialize(e);h.requestXml=h.generateDeleteProfileRequest(l);$("#profile_delete_wizard").dialog("close");$("#profile_delete_wizard").dialog("destroy");$("#profile_delete_wizard").remove();h.exec(e.current_node);},check_move:function(k,h,j,i,l){return false;},onmove:function(k,h,j,i,l){alert(i.get_text(k)+" "+j+" "+i.get_text(h));},onsearch:function(i,h){h.container.find(".clicked","contains").removeClass("clicked");$(i).find("a:eq(0)").addClass("clicked");},onload:function(h){$(".ltr").find("ul>li").each(function(){id=$(this).attr("id");$(this).find("a:eq(0)").after(e.getAccessHtml(id));});e.rootId=$(".ltr").find("li:eq(0)").attr("id");if(e.perm&"100"){$(".ltr").find("a:eq(0)").after('<img class="imglink" title="'+SMARTPORTAL.t("Add Profile")+'" src="'+themepath+'/images/fplus_rtl.gif" onclick="'+e.getWidgetInstanceName()+".addNode('"+e.rootId+"')\" />&nbsp;");}$(".ltr").after("<div style='clear:both'>&nbsp;</div>");h.close_all();
h.open_branch("#"+$(".ltr li:eq(0)").attr("id"));}},data:{type:"xml_flat",async:true,opts:{url:c.url,method:"POST"}},ui:{theme_name:"classic",animation:300},rules:{multiple:false}});var b=$.tree.focused();var d='<div style="margin:15px 0 20px 5px;">';d+="</div>";$("#"+this.getUniqueWidgetId()+"profiletree").append('<div style="clear:both;padding:20px;"></div>');$("#"+this.getUniqueWidgetId()+"search").html(d);b.open_branch("#ProfileServiceprofiletree");};this.profileDeleteWizard=function(){var b='<div id="deleteprofile" style="padding:5px 0;clear:both;">';b+="<table>";b+='<tr><td align="center">Are you sure you want to delete?</td></tr>';b+="</table></div>";return b;};this.deleteProfileWiz=function(d){this.setDelId=d;this.mode="deletenode";var c={parent_id:d};var b=new EXPERTUS.SMARTPORTAL.ProfileManager();b.initialize(this);b.requestXml=b.generateProfileCodeRequest(c);b.exec(this.current_node);};this.showDeleteDialog=function(){var d=this.setDelId;$("#profile_delete_wizard").remove();var c="";
c+='<div id="profile_delete_wizard" style="display:none">';c+=this.profileDeleteWizard();c+="</div>";$("body").append(c);var b={};b[SMARTPORTAL.t("No")]=function(){$(this).dialog("close");$(this).dialog("destroy");$("#profile_delete_wizard").remove();EXPERTUS.SMARTPORTAL.ProfileWidget.closeDialog();};b[SMARTPORTAL.t("Yes")]=function(){EXPERTUS.SMARTPORTAL.ProfileWidget.deleteNode(d);};$("#profile_delete_wizard").dialog({bgiframe:true,height:250,width:460,resizable:false,draggable:false,closeOnEscape:false,modal:true,title:SMARTPORTAL.t("Delete Profile List - "+this.parentList),buttons:b,position:[(getWindowWidth()-440)/2,100],overlay:{opacity:0.9,background:"black"}});$(".ui-dialog").wrap("<div class='portal-ui-element'></div>");$(".ui-widget-overlay").wrap("<div class='portal-ui-element'></div>");$("#profile_delete_wizard").css("height","auto");$("#profile_delete_wizard").show();$(".ui-dialog-titlebar-close").click(function(){$("#profile_delete_wizard").remove();});};this.showConTextTree=function(d,c){if(d==""||d==undefined){$("#conBlk").hide();
$("#conTree").html("");return;}$("#conBlk").show();var e=this;$("#conTree").tree({callback:{beforeclose:function(g,f){return false;},onsearch:function(g,f){f.container.find(".clicked").removeClass("clicked");g.addClass("clicked");}},data:{type:"xml_flat",opts:{"static":e.getXmlFlat(d)}},ui:{theme_name:"classic",animation:300},rules:{multiple:false}});var b=$.tree.reference("#conTree");b.open_all();b.search(c);if(this.conTrStat=="none"){$("#conTree").hide();}};this.getXmlFlat=function(c){var b=c.split(":");var e="<root>";for(var d=0;d<b.length;d++){e+='<item parent_id="'+(d==0?0:d)+'" id="'+(d+1)+'"><content><name>'+b[d]+"</name></content></item>";}e+="</root>";return e;};this.searchTree=function(c){var b=$.tree.reference("#ProfileServiceprofiletree");b.search(c);};this.close_all=function(){var b=$.tree.reference("#ProfileServiceprofiletree");b.close_all();b.open_branch("#ProfileServiceprofiletree");};this.open_all=function(){var b=$.tree.reference("#ProfileServiceprofiletree");this.openall=true;
b.open_all();this.openall=false;};this.remProf=function(){if($("#newprofile").length){$("#newprofile").remove();}};this.test=function(){var b=new EXPERTUS.SMARTPORTAL.ProfileManager();b.initialize(this);b.requestXml=b.generateProfileByTypeRequest({type:"1"});b.execute();};this.profileCreateWizard=function(e){this.remProf();var d=$.tree.focused();var b=this.getLevel(this.current_node,$.tree.focused(),-1);var c='<div id="newprofile" style="padding:5px 0;clear:both;width:465px;"><a name="newprof">&nbsp;</a>';c+="<table>";if(e>1){c+='<tr><td>Parent Code:</td><td colspan="3"><input type="text" id="parent_code" name="ParentCode" value="'+this.parentCode+'" class="" readonly /></td></tr>';}c+='<tr><td width="25%">Code:<div class="sp_label_mandatory">*</div></td><td width="25%"><input type="text" id="code" name="Code"  class="mandatory" /><span id="profilecode_exist_err" class="error" style="display: none;">This code is already in use. Please choose another one.</span></td>';c+='<td width="25%">Language:<div class="sp_label_mandatory">*</div></td><td width="25%"><select id="language_code" name="Language" class="mandatory" ><option value="">'+SMARTPORTAL.t("Select")+"</option></select></td></tr>";
c+='<tr><td>Name:<div class="sp_label_mandatory">*</div></td><td><input type="text" name="Name" id="prof_name"  class="mandatory" /></td>';c+='<td>Active:</td><td><select id="prof_active"><option value="Y">Yes</option><option value="N">No</option></select></td></tr>';if(this.root=="R"&&(e==0||e==1)){c+='<tr><td width="25%">Description :</td><td colspan="3" width="25%"><input type="text" id="prof_desc" value="" /></td></tr>';}c+='<tr><td>Attribute 1:</td><td><input type="text" id="attr1" value="" /></td><td>Attribute 2:</td> <td><input type="text" id="attr2" value="" /></td></tr>';c+='<tr><td>Attribute 3:</td><td><input type="text" id="attr3" value="" /></td><td>Attribute 4:</td><td><input type="text" id="attr4" value="" /></td></tr>';c+="</table></div>";return c;};this.showCreateDialog=function(d){$("#profile_create_wizard").remove();var c="";c+='<div id="profile_create_wizard" style="display:none">';c+=this.profileCreateWizard(d);c+="</div>";$("body").append(c);this.updateLovOptions("language_code","cre_sys_lng","cre_sys_lng_eng");
var b={};b[SMARTPORTAL.t("Cancel")]=function(){$(this).dialog("close");$(this).dialog("destroy");$("#profile_create_wizard").remove();EXPERTUS.SMARTPORTAL.ProfileWidget.closeDialog();};b[SMARTPORTAL.t("Save")]=function(){EXPERTUS.SMARTPORTAL.ProfileWidget.saveNode(d);};$("#profile_create_wizard").dialog({bgiframe:true,height:250,width:660,resizable:false,draggable:false,closeOnEscape:false,modal:true,title:SMARTPORTAL.t("Create Profile List -  "+this.parentList),buttons:b,position:[(getWindowWidth()-660)/2,100],overlay:{opacity:0.9,background:"black"}});$(".ui-dialog").wrap("<div class='portal-ui-element'></div>");$(".ui-widget-overlay").wrap("<div class='portal-ui-element'></div>");$("#profile_create_wizard").css("height","auto");$("#profile_create_wizard").show();$(".ui-dialog-titlebar-close").click(function(){$("#profile_create_wizard").remove();});};this.profileUpdateWizard=function(){var b='<div id="newprofile" style="padding:5px 0;width:465px;">';b+="<table>";b+='<tr><td width="25%">Code:<div class="sp_label_mandatory">*</div></td><td width="25%"><input type="text" id="code" readonly name="Code"  class="mandatory" /></td>';
b+='<td width="25%">Language:<div class="sp_label_mandatory">*</div></td><td width="25%"><select id="language_code" name="Language" disabled  class="mandatory"><option value="">'+SMARTPORTAL.t("Select")+"</option></select></td></tr>";b+='<tr><td>Name:<div class="sp_label_mandatory">*</div></td><td><input type="text" id="prof_name" name="Name"  class="mandatory" /></td>';b+='<td>Active:</td><td><select id="prof_active"><option value="Y">Yes</option><option value="N">No</option></select></td></tr>';if(this.root=="R"&&(this.level==0||this.level==1)){b+='<tr><td width="25%">Description :</td><td colspan="3" width="25%"><input type="text" id="prof_desc" value="" /></td></tr>';}b+='<tr><td>Attribute 1:</td><td><input type="text" id="attr1" value="" /></td><td>Attribute 2:</td> <td><input type="text" id="attr2" value="" /></td></tr>';b+='<tr><td>Attribute 3:</td><td><input type="text" id="attr3" value="" /></td><td>Attribute 4:</td><td><input type="text" id="attr4" value="" /></td></tr>';b+="</table></div>";
return b;};this.showUpdateDialog=function(){$("#profile_update_wizard").remove();var c="";c+='<div id="profile_update_wizard" style="display:none">';c+=this.profileUpdateWizard();c+="</div>";$("body").append(c);this.updateLovOptions("language_code","cre_sys_lng","cre_sys_lng_eng");var b={};b[SMARTPORTAL.t("Cancel")]=function(){$(this).dialog("close");$(this).dialog("destroy");$("#profile_update_wizard").remove();EXPERTUS.SMARTPORTAL.ProfileWidget.closeDialog();};b[SMARTPORTAL.t("Save")]=function(){EXPERTUS.SMARTPORTAL.ProfileWidget.updateRootNode();};$("#profile_update_wizard").dialog({bgiframe:true,height:250,width:660,resizable:false,draggable:false,closeOnEscape:false,modal:true,title:SMARTPORTAL.t("Update Profile List -  "+this.parentList),buttons:b,position:[(getWindowWidth()-660)/2,100],overlay:{opacity:0.9,background:"black"}});$(".ui-dialog").wrap("<div class='portal-ui-element'></div>");$(".ui-widget-overlay").wrap("<div class='portal-ui-element'></div>");$("#profile_update_wizard").css("height","auto");
$("#profile_update_wizard").show();$(".ui-dialog-titlebar-close").click(function(){$("#profile_update_wizard").remove();});};this.closeDialog=function(){$("#newprofile").remove();this.mode="";};this.getAccessHtml=function(c){var b="";if(this.perm&"100"){b+='&nbsp;<img class="imglink" title="'+SMARTPORTAL.t("Add Profile")+'" src="'+themepath+'/images/fplus_rtl.gif" onclick="'+this.getWidgetInstanceName()+".addNode('"+c+"')\" />";}if(this.perm&"010"){b+='&nbsp;<img class="imglink" title="'+SMARTPORTAL.t("Edit Profile")+'" src="'+themepath+'/images/pen34.png" width="9" height="9" onclick="renNode(\''+c+"');\" />";}if(this.perm&"001"){b+='&nbsp;<img class="imglink" title="'+SMARTPORTAL.t("Delete Profile")+'" src="'+themepath+'/images/del.png" onclick="'+this.getWidgetInstanceName()+".deleteProfileWiz('"+c+"')\" />";}return b;};this.renderResults=function(){if($(this.responseXml).find("ListItem").length){this.lovXml=this.responseXml;}if($(this.responseXml).find("faultcode").length){this.renderError();
}if(this.mode=="getprofile"){this.showTree();}else{if(this.mode=="createnode"){if($(this.responseXml).find("GetProfileCodeResponse").length){this.parentCode=$(this.responseXml).find("parent_code").text();this.parentList=$(this.responseXml).find("parent_list").text();this.showCreateDialog(this.level);}else{this.current_node.id=$(this.responseXml).find("InsertProfileResponse").text();$("#"+this.current_node.id).find("a:eq(0)").after(this.getAccessHtml(this.current_node.id));this.mode="";}}else{if(this.mode=="savenode"){var c=$(this.responseXml).find("InsertProfileResponse").text();if(c=="-1"||c=="F-1"){$("#profilecode_exist_err").show();}else{var b=$.tree.focused();b.create(this.insertparam,this.current_node,this.type);$(this.current_node).attr("id",$(this.responseXml).find("InsertProfileResponse").text());$("#"+$(this.current_node).attr("id")).find("a:eq(0)").after(this.getAccessHtml(this.current_node.id));this.mode="";$("#profile_create_wizard").dialog("close");$("#profile_create_wizard").dialog("destroy");
$("#profile_create_wizard").remove();}}else{if(this.mode=="renamenode"){this.remProf();this.parentList=$(this.responseXml).find("parent_list").text();this.showUpdateDialog();$("#code").val($(this.responseXml).find("code").text());$("#language_code").val($(this.responseXml).find("lang_code").text());$("#prof_name").val($(this.responseXml).find("name").text());$("#prof_desc").val($(this.responseXml).find("description").text());$("#prof_active").val($(this.responseXml).find("is_active").text());$("#attr1").val($(this.responseXml).find("attr1").text());$("#attr2").val($(this.responseXml).find("attr2").text());$("#attr3").val($(this.responseXml).find("attr3").text());$("#attr4").val($(this.responseXml).find("attr4").text());$("#prof_name").focus();}else{if(this.mode=="updatenode"){this.mode="updated";$.tree.focused().lock(false);$.tree.focused().rename(this.current_node,$("#prof_name").val());$("#newprofile").remove();}else{if(this.mode=="deletenode"){if($(this.responseXml).find("GetProfileCodeResponse").length){this.parentList=$(this.responseXml).find("parent_list").text();
this.showDeleteDialog();}}}}}}}$("#throbber").remove();$.tree.focused().lock(false);};this.updateRootNode=function(){if(this.mandatoryCheck("profile_update_wizard")){this.mode="updatenode";var e=$("#prof_name").val();var l="1";var k=$("#prof_desc").val();var m=$("#prof_active").val();var c=$("#code").val();var b=$("#language_code").val();var j=$("#attr1").val();var i=$("#attr2").val();var h=$("#attr3").val();var g=$("#attr4").val();var d={id:this.current_node.id,name:e,type:l,description:k,is_active:m,code:c,language_code:b,attr1:j,attr2:i,attr3:h,attr4:g,level:this.level,root:this.root};var f=new EXPERTUS.SMARTPORTAL.ProfileManager();f.initialize(this);f.requestXml=f.generateUpdateProfileRequest(d);f.exec(this.current_node);}};this.addNode=function(c){this.currentID=c;var b=$.tree.focused();b.select_branch("#"+c);if(b.selected){b.create();}else{alert("select a node first");}};this.deleteNode=function(c){var b=$.tree.focused();b.select_branch("#"+c);if(b.selected){b.remove();}else{alert("select a node first");
}};this.saveNode=function(c){$("#profilecode_exist_err").hide();if(this.mandatoryCheck("profile_create_wizard")){var f=$("#prof_name").val();var m=$("#prof_desc").val();var o="1";var p=$("#prof_active").val();var d=$("#code").val();if(c>1){var n=$("#parent_code").val();var g=n+"_"+d;}else{var g=d;}var b=$("#language_code").val();var l=$("#attr1").val();var k=$("#attr2").val();var j=$("#attr3").val();var i=$("#attr4").val();var e={data:f,name:f,list_id:getRootId(this.parent,$.tree.focused()),parent_id:$(this.parent).attr("id"),type:o,description:m,is_active:p,level:c,code:g,language_code:b,attr1:l,attr2:k,attr3:j,attr4:i,root:this.root};this.insertparam=e;this.mode="savenode";var h=new EXPERTUS.SMARTPORTAL.ProfileManager();h.initialize(this);h.requestXml=h.generateCreateRequest(e);h.exec(this.current_node);}};this.getLevel=function(d,b,e){var c=b.parent(d);if(c==false||c==-1){return e+this.iniLevel+1;}return this.getLevel(c,b,e+1);};}catch(a){}};$.extend(EXPERTUS.SMARTPORTAL.ProfileWidget.prototype,EXPERTUS.SMARTPORTAL.AbstractDetailsWidget);
function callprofiledetail(a,b,f){try{var c=new EXPERTUS.SMARTPORTAL.ProfileWidget();c.root=a;c.perm=b;c.iniLevel=f;c.setUniqueWidgetId("ProfileService");c.setWidgetObject(c);c.setWidgetTitle("Profile Master");c.render({id:"ProfileService"});}catch(d){}}function getRootId(c,a){try{var b=a.parent(c);if(b==-1||b==false){return $(c).attr("id");}else{if($(b).attr("id")=="R"){return $(c).attr("id");}else{if($(a.parent(b)).attr("id")=="R"){return $(b).attr("id");}else{return getRootId(b,a);}}}}catch(d){}}function renNode(c){try{var a=$.tree.focused();a.select_branch("#"+c);if(a.selected){a.rename();}else{alert("select a node first");}}catch(b){}}jQuery.expr[":"].contains=function(c,d,b){try{return jQuery(c).text().toUpperCase().substring(1,jQuery(c).text().length)==b[3].toUpperCase();}catch(f){}};$(document).ready(function(){try{if(document.getElementById("ProfileService")!=null){var b=$("#profileAccess").val();var g=$("#profileTitle").val();var d=$("#profileType").val();callprofiledetail(g,b,d);
var c=$("#catStatus").val();if(c=="1"){var a=new EXPERTUS.SMARTPORTAL.CourseDetailWidget();a.setUniqueWidgetId("CatalogService");a.setWidgetObject("courseDetailObj");a.renderBase({id:"CatalogService"},a);}}}catch(f){}});