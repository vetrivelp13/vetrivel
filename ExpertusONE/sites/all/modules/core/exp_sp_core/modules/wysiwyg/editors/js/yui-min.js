(function(a){Drupal.wysiwyg.editor.attach.yui=function(d,h,f){a("#"+h.field).parent().addClass("yui-skin-"+f.theme);for(var g in Drupal.settings.wysiwyg.plugins[h.format].drupal){f.extracss+=f.extracss+' @import "'+Drupal.settings.wysiwyg.plugins[h.format].drupal[g].css+'"; ';}var e=new YAHOO.widget.Editor(h.field,f);e.on("toolbarLoaded",function(){for(var i in Drupal.settings.wysiwyg.plugins[h.format].drupal){Drupal.wysiwyg.instances[h.field].addPlugin(i,Drupal.settings.wysiwyg.plugins[h.format].drupal[i],Drupal.settings.wysiwyg.plugins.drupal[i]);}});var c=e.setEditorHTML;e.setEditorHTML=function(j){for(var i in Drupal.settings.wysiwyg.plugins[h.format].drupal){var k=Drupal.settings.wysiwyg.plugins.drupal[i];if(typeof Drupal.wysiwyg.plugins[i].attach=="function"){j=Drupal.wysiwyg.plugins[i].attach(j,k,h.field);j=Drupal.wysiwyg.instances[h.field].prepareContent(j);}}c.call(this,j);};var b=e.getEditorHTML;e.getEditorHTML=function(){var j=b.call(this);for(var i in Drupal.settings.wysiwyg.plugins[h.format].drupal){var k=Drupal.settings.wysiwyg.plugins.drupal[i];
if(typeof Drupal.wysiwyg.plugins[i].detach=="function"){j=Drupal.wysiwyg.plugins[i].detach(j,k,h.field);}}return j;};e.on("editorContentLoaded",function(i){i.target.setEditorHTML(b.call(i.target));});e.on("afterNodeChange",function(j){for(var i in Drupal.settings.wysiwyg.plugins[h.format].drupal){if(typeof Drupal.wysiwyg.plugins[i].isNode=="function"){if(Drupal.wysiwyg.plugins[i].isNode(j.target._getSelectedElement())){this.toolbar.selectButton(i);}}}});e.render();};Drupal.wysiwyg.editor.detach.yui=function(d,g,c){var h=(c&&c=="serialize")?"saveHTML":"destroy";if(typeof g!="undefined"){var b=YAHOO.widget.EditorInfo._instances[g.field];if(b){b[h]();if(h=="destroy"){delete YAHOO.widget.EditorInfo._instances[g.field];}}}else{for(var f in YAHOO.widget.EditorInfo._instances){var b=YAHOO.widget.EditorInfo._instances[f];b[h]();if(h=="destroy"){delete YAHOO.widget.EditorInfo._instances[f];}}}};Drupal.wysiwyg.editor.instance.yui={addPlugin:function(f,d,g){if(typeof Drupal.wysiwyg.plugins[f]!="object"){return;
}var c=YAHOO.widget.EditorInfo.getEditorById(this.field);var b=c.toolbar.getButtonByValue(f);a(b._button).parent().css("background","transparent url("+d.icon+") no-repeat center");var e=this.field;c.toolbar.on(f+"Click",function(i){var j=c._getSelectedElement();var h={format:"html",node:j,content:a(j).html()};Drupal.wysiwyg.plugins[f].invoke(h,g,e);});},prepareContent:function(c){var b=YAHOO.widget.EditorInfo.getEditorById(this.field);c=b.cleanHTML(c);return c;},insert:function(b){YAHOO.widget.EditorInfo.getEditorById(this.field).cmd_inserthtml(b);},setContent:function(b){YAHOO.widget.EditorInfo.getEditorById(this.field).setEditorHTML(b);},getContent:function(){var b=YAHOO.widget.EditorInfo.getEditorById(this.field);return b.cleanHTML(b.getEditorHTML(content));}};})(jQuery);