(function(){var g={};if(typeof jsondiffpatch!="undefined"){g=jsondiffpatch;}g.config={textDiffMinLength:60};g.dateReviver=function(p,q){var o;if(typeof q==="string"){o=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2}(?:\.\d*)?)(Z|([+\-])(\d{2}):(\d{2}))$/.exec(q);if(o){return new Date(Date.UTC(+o[1],+o[2]-1,+o[3],+o[4],+o[5],+o[6]));}}return q;};var k=function(){var o;if(g.config.diff_match_patch){o=new g.config.diff_match_patch.diff_match_patch();}if(typeof diff_match_patch!="undefined"){if(typeof diff_match_patch=="function"){o=new diff_match_patch();}else{if(typeof diff_match_patch=="object"&&typeof diff_match_patch.diff_match_patch=="function"){o=new diff_match_patch.diff_match_patch();}}}if(o){g.config.textDiff=function(q,p){return o.patch_toText(o.patch_make(q,p));};g.config.textPatch=function(p,s){var r=o.patch_apply(o.patch_fromText(s),p);for(var q=0;q<r[1].length;q++){if(!r[1][q]){throw new Error("text patch failed");}}return r[0];};return true;}};var h=g.isArray=(typeof Array.isArray=="function")?Array.isArray:function(o){return typeof o=="object"&&o instanceof Array;
};var m=g.isDate=function(o){return o instanceof Date||Object.prototype.toString.call(o)==="[object Date]";};var j=function(v,w){var t,s,p,q=w.length,r=v.length,u;u=function(o){p=l(v[o],w[o]);if(typeof p!="undefined"){if(typeof t=="undefined"){t={_t:"a"};}t[o]=p;}};for(s=0;s<Math.max(q,r);s++){u(s);}return t;};var f=function(r,s,q){var u,y=r.length,p=s.length,w,t=0;if(typeof q=="function"){w=q;}else{w=function(o){return o[q];};}for(var v=0;v<p;v++){if(typeof u=="undefined"){u={_t:"a"};}u[w(s[v])]=[s[v]];t++;}for(var v=0;v<y;v++){var z=w(r[v]);if(typeof u=="undefined"||typeof u[z]=="undefined"){if(typeof u=="undefined"){u={_t:"a"};}u[z]=[r[v],0,0];t++;}else{var x=l(r[v],u[z][0]);if(typeof x=="undefined"){delete u[z];t--;}else{u[z]=x;}}}if(t>0){return u;}else{return;}};var b=function(s,u){var p,r,t,q;q=function(o){if(h(u[t])&&(u[t+"_key"]||u["_"+t+"_key"])){u[t]._key=u[t+"_key"]||u["_"+t+"_key"];}if(h(s[t])&&(s[t+"_key"]||s["_"+t+"_key"])){s[t]._key=s[t+"_key"]||s["_"+t+"_key"];}r=l(s[t],u[t]);
if(typeof r!="undefined"){if(typeof p=="undefined"){p={};}p[t]=r;}};for(t in u){if(u.hasOwnProperty(t)){q(t);}}for(t in s){if(s.hasOwnProperty(t)){if(typeof u[t]=="undefined"){q(t);}}}return p;};var l=g.diff=function(v,w){var r,p,q,s,u;if(v===w){return;}if((v!==v)&&(w!==w)){return;}r=typeof w;p=typeof v;q=w===null;s=v===null;if(p=="object"&&m(v)){p="date";}if(r=="object"&&m(w)){r="date";if(p=="date"){if(v.getTime()===w.getTime()){return;}}}if(q||s||r=="undefined"||r!=p||r=="number"||p=="number"||r=="boolean"||p=="boolean"||r=="string"||p=="string"||r=="date"||p=="date"||((r==="object")&&(h(w)!=h(v)))){u=[];if(typeof v!="undefined"){if(typeof w!="undefined"){var t=(r=="string"&&p=="string"&&Math.min(v.length,w.length)>g.config.textDiffMinLength);if(t&&!g.config.textDiff){k();}if(t&&g.config.textDiff){u.push(g.config.textDiff(v,w),0,2);}else{u.push(v);u.push(w);}}else{u.push(v);u.push(0,0);}}else{u.push(w);}return u;}else{if(h(w)){if(w._key||v._key){return f(v,w,w._key||v._key);}else{return j(v,w);
}}else{return b(v,w);}}};var e=function(r,q){if(h(r)&&r._key){var o=r._key;if(typeof r._key!="function"){o=function(s){return s[r._key];};}for(var p=0;p<r.length;p++){if(o(r[p])===q){return r[p];}}return;}return r[q];};g.getByKey=e;var n=function(s,q,r){if(h(s)&&s._key){var o=s._key;if(typeof s._key!="function"){o=function(t){return t[s._key];};}for(var p=0;p<s.length;p++){if(o(s[p])===q){if(typeof r=="undefined"){s.splice(p,1);p--;}else{s[p]=r;}return;}}if(typeof r!="undefined"){s.push(r);}return;}if(typeof r=="undefined"){if(h(s)){s.splice(q,1);}else{delete s[q];}}else{s[q]=r;}};var d=function(o){if(!g.config.textDiffReverse){g.config.textDiffReverse=function(x){var s,p,A,B,t,u=null,w=/^@@ +\-(\d+),(\d+) +\+(\d+),(\d+) +@@$/,r,z,q;var y=function(){if(z!==null){A[z]="-"+A[z].slice(1);}if(q!==null){A[q]="+"+A[q].slice(1);if(z!==null){t=A[z];A[z]=A[q];A[q]=t;}}A[r]="@@ -"+u[3]+","+u[4]+" +"+u[1]+","+u[2]+" @@";u=null;r=null;z=null;q=null;};A=x.split("\n");for(s=0,p=A.length;s<p;s++){B=A[s];
var v=B.slice(0,1);if(v==="@"){if(u!==null){}u=w.exec(B);r=s;z=null;q=null;A[r]="@@ -"+u[3]+","+u[4]+" +"+u[1]+","+u[2]+" @@";}else{if(v=="+"){z=s;A[s]="-"+A[s].slice(1);}else{if(v=="-"){q=s;A[s]="+"+A[s].slice(1);}}}}if(u!==null){}return A.join("\n");};}return g.config.textDiffReverse(o);};var i=g.reverse=function(p){var q,o;if(typeof p=="undefined"){return;}else{if(p===null){return null;}else{if(typeof p=="object"&&!m(p)){if(h(p)){if(p.length<3){if(p.length==1){return[p[0],0,0];}else{return[p[1],p[0]];}}else{if(p[2]==0){return[p[0]];}else{if(p[2]==2){return[d(p[0]),0,2];}else{throw new Error("invalid diff type");}}}}else{o={};for(q in p){if(p.hasOwnProperty(q)){o[q]=i(p[q]);}}return o;}}else{if(typeof p==="string"&&p.slice(0,2)==="@@"){return d(p);}}}}return p;};var a=g.patch=function(r,t,w,y){var q,u,x="",v;if(typeof t!="string"){y=w;w=t;t=null;}else{if(typeof r!="object"){t=null;}}if(y){x+=y;}x+="/";if(t!==null){x+=t;}if(typeof w=="object"){if(h(w)){if(w.length<3){u=w[w.length-1];if(t!==null){n(r,t,u);
}return u;}else{if(w[2]==0){if(t!==null){n(r,t);}else{return;}}else{if(w[2]==2){if(!g.config.textPatch){k();}if(!g.config.textPatch){throw new Error("textPatch function not found");}try{u=g.config.textPatch(e(r,t),w[0]);}catch(s){throw new Error('cannot apply patch at "'+x+'": '+s);}if(t!==null){n(r,t,u);}return u;}else{throw new Error("invalid diff type");}}}}else{if(w._t=="a"){v=t===null?r:e(r,t);if(typeof v!="object"||!h(v)){throw new Error('cannot apply patch at "'+x+'": array expected');}else{for(q in w){if(q!=="_t"&&w.hasOwnProperty(q)){a(v,q,w[q],x);}}}}else{v=t===null?r:e(r,t);if(typeof v!="object"||h(v)){throw new Error('cannot apply patch at "'+x+'": object expected');}else{for(q in w){if(w.hasOwnProperty(q)){a(v,q,w[q],x);}}}}}}return r;};var c=g.unpatch=function(s,p,r,q){if(typeof p!="string"){return a(s,i(p),r);}return a(s,p,i(r),q);};if(typeof require==="function"&&typeof exports==="object"&&typeof module==="object"){module.exports=g;}else{if(typeof define==="function"&&define.amd){define(g);
}else{window.jsondiffpatch=g;}}})();