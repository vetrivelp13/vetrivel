(function(a){a.widget("ui.announcement",{setIntervalId:null,_init:function(){try{this.loggedUserId=this.getLearnerId();this.renderAnnouncementList();}catch(b){}},paintAnnouncement:function(b,q,i){try{var c=i.id;var o=i.personid;var l=i.screen_name;var m=i.image_url;var f=i.nid;var d=i.announce_shortdesc;var p=i.announce_fulldescription;var n=i.from_date;var j=i.css;var g="{'entityId':'1','entityType':'enr_crs_usr','url':'learning/ajax/myprofile/user/"+o+"','popupDispId':'profile-qtipid-"+c+"','qtipDisplayPosition':'tipfaceRight','catalogVisibleId':'qtipprofileqtip_visible_disp_"+c+"','dataloaderid':'div_announcement','dataIntId':'announcement','wBubble':'350','hBubble':'auto'}";var h="";if(!document.getElementById("qtipprofileqtip_visible_disp_"+c+"_disp")){h+='<div id="qtipprofileqtip_visible_disp_'+c+'_disp"></div>';}h+='<div class="profile-item clearfix '+j+'" id="announcement-qtipid-'+c+'">';h+='<a class="profile-image user-list-border-img" >';h+='<img class="vtip" title="'+htmlEntities(l)+'" src="'+m+'"/>';
h+="</a>";h+='<div class="announcement-profile-desc">';h+='<span class="user-profile-link">';h+='<a id="'+c+'" class="limit-title-row user-name user-profile" href="javascript:void(0);" onclick="$(\'body\').data(\'learningcore\').paintOtherUserProfile('+g+')">';h+='<span class="limit-title vtip" title="'+htmlEntities(i.screen_name)+'">'+l+"</span>";h+='<a title="'+Drupal.t("LBL286")+"\" onclick=\"$('#div_announcement').data('announcement').callDismissNotice("+f+","+a("#div_announcement").data("announcement").loggedUserId+')" class="activity-remove-link vtip">';h+='<span class="vtip" title="'+Drupal.t("LBL286")+'">'+Drupal.t("LBL286")+"</span>";h+="</a>";h+='<span class="created-date">'+n+"</span>";h+='<div class="limit-desc-row"><span class="limit-desc announce-Description vtip">'+p+"</span></div>";h+="</span>";h+="</div>";h+="</div>";return h;}catch(k){}},paintAnnouncementNewTheme:function(h){try{var b=h.id;var n=h.personid;var k=h.screen_name;var l=h.image_url;var d=h.nid;var c=h.announce_shortdesc;
var o=h.announce_fulldescription;var m=h.from_date;var i=h.css;var f="{'entityId':'1','entityType':'enr_crs_usr','url':'learning/ajax/myprofile/user/"+n+"','popupDispId':'profile-qtipid-"+b+"','qtipDisplayPosition':'tipfaceRight','catalogVisibleId':'qtipprofileqtip_visible_disp_"+b+"','dataloaderid':'announcement_new','dataIntId':'announcement','wBubble':'350','hBubble':'auto'}";var g="";if(!document.getElementById("qtipprofileqtip_visible_disp_"+b+"_disp")){g+='<div id="qtipprofileqtip_visible_disp_'+b+'_disp"></div>';}g+='<div class="profile-item clearfix '+i+'" id="announcement-qtipid-'+b+'">';g+='<a class="profile-image user-list-border-img" >';g+='<img class="vtip" title="'+htmlEntities(k)+'" src="'+l+'" width="27px" height="27px"/>';g+="</a>";g+='<div class="announcement-profile-desc">';g+='<span class="user-profile-link">';g+='<a id="'+b+'" class="limit-title-row user-name user-profile" href="javascript:void(0);" onclick="$(\'body\').data(\'learningcore\').paintOtherUserProfile('+f+')">';
g+='<span class="vtip limit-title" title="'+htmlEntities(h.screen_name)+'">'+k.toUpperCase()+"</span>";g+="</a>";g+='<span class="created-date">'+m+"</span>";g+='<div class="announce-shortdescription-list limit-desc-row" data-noticeid="announcement-'+d+'"><span class="limit-desc announce-Description">'+o+"</span></div>";g+='<div id="announcement-'+d+'" class="announce-fulldescription-list"><span class="announce-Description">'+o+"</span></div>";g+="</span>";g+="</div>";g+="</div>";return g;}catch(j){console.log(j.stack);}},renderAnnouncementList:function(){try{this.createLoader("announcement_loader");var d=this;this.currTheme=Drupal.settings.ajaxPageState.theme;if(this.currTheme=="expertusoneV2"){var b=(navigator.userAgent.indexOf("Chrome")>=0)?258:253;var b=(navigator.userAgent.indexOf("Safari")!=-1)?258:253;}else{var b=265;}a("#announcement_jqgrid").jqGrid({url:this.constructUrl("learning/announcement/"+this.loggedUserId),datatype:"json",mtype:"GET",colNames:[""],colModel:[{name:"id",index:"id",width:b,title:false,sortable:false,formatter:d.paintAnnouncement}],rowNum:3,viewrecords:true,loadui:false,height:"auto",pager:"#announcement_pager",pgtext:"{0} "+Drupal.t("LBL981")+" {1}",toppager:false,emptyrecords:"",loadtext:"",recordtext:"",loadComplete:d.announcementLoadComplete,onPaging:function(){d.createLoader("announcement_loader");
}});a(".ui-jqgrid").css("margin","0px");}catch(c){}},announcementLoadComplete:function(b){try{if(b.total>1){a("#announcement_pager").css("display","block");}else{a("#announcement_pager").css("display","none");}if(b.records==0){a("#announcement_list").html("<div class='announcement-msg'  style='display: block;'>"+Drupal.t("MSG267")+"</div>");}vtip();a(".ui-pg-table").attr("align","right");a("#div_announcement").data("announcement").destroyLoader("announcement_loader");a("#announcement_list .limit-title").trunk8(trunk8.ann_title);a("#announcement_list .limit-desc").trunk8(trunk8.ann_desc);}catch(c){}},callDismissNotice:function(b,c){try{this.createLoader("announcement_loader");var f=this;url=f.constructUrl("learning/announcement/dismiss/"+b+"/"+c);a.ajax({type:"POST",url:url,data:"",success:function(e){a("#announcement_jqgrid").setGridParam({url:f.constructUrl("learning/announcement/"+c)});a("#announcement_jqgrid").trigger("reloadGrid",[{page:1}]);}});}catch(d){}}});a.extend(a.ui.announcement.prototype,EXPERTUS_SMARTPORTAL_AbstractManager,EXPERTUS_SMARTPORTAL_AbstractDetailsWidget);
})(jQuery);$(function(){try{$("#div_announcement").announcement();}catch(a){}});function addEditTimeField(a){try{var b=$(a).val();if(b==Drupal.t("hh:mm")||b==""){$(a).removeClass("narrow-search-filterset-daterange-nonempty");$(a).addClass("narrow-search-filterset-daterange-empty");$(a).val(Drupal.t("hh:mm"));}else{$(a).removeClass("narrow-search-filterset-daterange-empty");$(a).addClass("narrow-search-filterset-daterange-nonempty");}}catch(c){}}