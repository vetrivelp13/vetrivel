Drupal.behaviors.ahah=function(a){for(var b in Drupal.settings.ahah){if(!$("#"+b+".ahah-processed").size()){var c=Drupal.settings.ahah[b];$(c.selector).each(function(){c.element=this;var d=new Drupal.ahah(b,c);});$("#"+b).addClass("ahah-processed");}}};Drupal.ahah=function(c,e){this.element=e.element;this.selector=e.selector;this.event=e.event;this.keypress=e.keypress;this.url=e.url;this.wrapper="#"+e.wrapper;this.effect=e.effect;this.method=e.method;this.progress=e.progress;this.button=e.button||{};if(this.effect=="none"){this.showEffect="show";this.hideEffect="hide";this.showSpeed="";}else{if(this.effect=="fade"){this.showEffect="fadeIn";this.hideEffect="fadeOut";this.showSpeed="slow";}else{this.showEffect=this.effect+"Toggle";this.hideEffect=this.effect+"Toggle";this.showSpeed="slow";}}var b=$(this.element).parents("form");this.form_action=b.attr("action");this.form_target=b.attr("target");this.form_encattr=b.attr("encattr");var d=this;var a={url:d.url,data:d.button,beforeSubmit:function(h,g,f){return d.beforeSubmit(h,g,f);
},success:function(g,f){if(typeof(g)=="string"){g=Drupal.parseJson(g);}return d.success(g,f);},complete:function(g,f){if(f=="error"||f=="parsererror"){return d.error(g,d.url);}},dataType:"json",type:"POST"};$(e.element).bind(e.event,function(){$(e.element).parents("form").ajaxSubmit(a);return false;});if(e.keypress){$(e.element).keypress(function(f){if(f.keyCode==13){$(e.element).trigger(e.event);return false;}});}};Drupal.ahah.prototype.beforeSubmit=function(form_values,element,options){$(this.element).addClass("progress-disabled").attr("disabled",true);if(this.progress.type=="bar"){var progressBar=new Drupal.progressBar("ahah-progress-"+this.element.id,eval(this.progress.update_callback),this.progress.method,eval(this.progress.error_callback));if(this.progress.message){progressBar.setProgress(-1,this.progress.message);}if(this.progress.url){progressBar.startMonitoring(this.progress.url,this.progress.interval||1500);}this.progress.element=$(progressBar.element).addClass("ahah-progress ahah-progress-bar");
this.progress.object=progressBar;$(this.element).after(this.progress.element);}else{if(this.progress.type=="throbber"){this.progress.element=$('<div class="ahah-progress ahah-progress-throbber"><div class="throbber">&nbsp;</div></div>');if(this.progress.message){$(".throbber",this.progress.element).after('<div class="message">'+this.progress.message+"</div>");}$(this.element).after(this.progress.element);}}};Drupal.ahah.prototype.success=function(b,a){var e=$(this.wrapper);var c=$(this.element).parents("form");var d=$("<div></div>").html(b.data);c.attr("action",this.form_action);this.form_target?c.attr("target",this.form_target):c.removeAttr("target");this.form_encattr?c.attr("target",this.form_encattr):c.removeAttr("encattr");if(this.progress.element){$(this.progress.element).remove();}if(this.progress.object){this.progress.object.stopMonitoring();}$(this.element).removeClass("progress-disabled").attr("disabled",false);Drupal.freezeHeight();if(this.method=="replace"){e.empty().append(d);
}else{e[this.method](d);}if(this.showEffect!="show"){d.hide();}if($(".ahah-new-content",d).size()>0){$(".ahah-new-content",d).hide();d.show();$(".ahah-new-content",d)[this.showEffect](this.showSpeed);}else{if(this.showEffect!="show"){d[this.showEffect](this.showSpeed);}}if(d.parents("html").length>0){Drupal.attachBehaviors(d);}Drupal.unfreezeHeight();};Drupal.ahah.prototype.error=function(a,b){alert(Drupal.ahahError(a,b));$(this.element).parent("form").attr({action:this.form_action,target:this.form_target});if(this.progress.element){$(this.progress.element).remove();}if(this.progress.object){this.progress.object.stopMonitoring();}$(this.wrapper).show();$(this.element).removeClass("progess-disabled").attr("disabled",false);};