(function(a){a.jgrid.extend({getColProp:function(d){var b={},f=this[0];if(!f.grid){return false;}var e=f.p.colModel;for(var c=0;c<e.length;c++){if(e[c].name==d){b=e[c];break;}}return b;},setColProp:function(c,b){return this.each(function(){if(this.grid){if(b){var e=this.p.colModel;for(var d=0;d<e.length;d++){if(e[d].name==c){a.extend(this.p.colModel[d],b);break;}}}}});},sortGrid:function(c,b,d){return this.each(function(){var h=this,e=-1;if(!h.grid){return;}if(!c){c=h.p.sortname;}for(var g=0;g<h.p.colModel.length;g++){if(h.p.colModel[g].index==c||h.p.colModel[g].name==c){e=g;break;}}if(e!=-1){var f=h.p.colModel[e].sortable;if(typeof f!=="boolean"){f=true;}if(typeof b!=="boolean"){b=false;}if(f){h.sortData("jqgh_"+h.p.id+"_"+c,e,b,d);}}});},GridDestroy:function(){return this.each(function(){if(this.grid){if(this.p.pager){a(this.p.pager).remove();}var c=this.id;try{a("#gbox_"+c).remove();}catch(b){}}});},GridUnload:function(){return this.each(function(){if(!this.grid){return;}var d={id:a(this).attr("id"),cl:a(this).attr("class")};
if(this.p.pager){a(this.p.pager).empty().removeClass("ui-state-default ui-jqgrid-pager corner-bottom");}var b=document.createElement("table");a(b).attr({id:d.id});b.className=d.cl;var c=this.id;a(b).removeClass("ui-jqgrid-btable");if(a(this.p.pager).parents("#gbox_"+c).length===1){a(b).insertBefore("#gbox_"+c).show();a(this.p.pager).insertBefore("#gbox_"+c);}else{a(b).insertBefore("#gbox_"+c).show();}a("#gbox_"+c).remove();});},setGridState:function(b){return this.each(function(){if(!this.grid){return;}var c=this;if(b=="hidden"){a(".ui-jqgrid-bdiv, .ui-jqgrid-hdiv","#gview_"+c.p.id).slideUp("fast");if(c.p.pager){a(c.p.pager).slideUp("fast");}if(c.p.toppager){a(c.p.toppager).slideUp("fast");}if(c.p.toolbar[0]===true){if(c.p.toolbar[1]=="both"){a(c.grid.ubDiv).slideUp("fast");}a(c.grid.uDiv).slideUp("fast");}if(c.p.footerrow){a(".ui-jqgrid-sdiv","#gbox_"+c.p.id).slideUp("fast");}a(".ui-jqgrid-titlebar-close span",c.grid.cDiv).removeClass("ui-icon-circle-triangle-n").addClass("ui-icon-circle-triangle-s");
c.p.gridstate="hidden";}else{if(b=="visible"){a(".ui-jqgrid-hdiv, .ui-jqgrid-bdiv","#gview_"+c.p.id).slideDown("fast");if(c.p.pager){a(c.p.pager).slideDown("fast");}if(c.p.toppager){a(c.p.toppager).slideDown("fast");}if(c.p.toolbar[0]===true){if(c.p.toolbar[1]=="both"){a(c.grid.ubDiv).slideDown("fast");}a(c.grid.uDiv).slideDown("fast");}if(c.p.footerrow){a(".ui-jqgrid-sdiv","#gbox_"+c.p.id).slideDown("fast");}a(".ui-jqgrid-titlebar-close span",c.grid.cDiv).removeClass("ui-icon-circle-triangle-s").addClass("ui-icon-circle-triangle-n");c.p.gridstate="visible";}}});},filterToolbar:function(b){b=a.extend({autosearch:true,searchOnEnter:true,beforeSearch:null,afterSearch:null,beforeClear:null,afterClear:null,searchurl:"",stringResult:false,groupOp:"AND",defaultSearch:"bw"},b||{});return this.each(function(){var i=this;if(this.ftoolbar){return;}var c=function(){var o={},n=0,t,u,k={},l;a.each(i.p.colModel,function(j,x){u=this.index||this.name;switch(this.stype){case"select":l=(this.searchoptions&&this.searchoptions.sopt)?this.searchoptions.sopt[0]:"eq";
t=a("#gs_"+a.jgrid.jqID(this.name),i.grid.hDiv).val();if(t){o[u]=t;k[u]=l;n++;}else{try{delete i.p.postData[u];}catch(v){}}break;case"text":l=(this.searchoptions&&this.searchoptions.sopt)?this.searchoptions.sopt[0]:b.defaultSearch;t=a("#gs_"+a.jgrid.jqID(this.name),i.grid.hDiv).val();if(t){o[u]=t;k[u]=l;n++;}else{try{delete i.p.postData[u];}catch(w){}}break;}});var r=n>0?true:false;if(b.stringResult===true||i.p.datatype=="local"){var s='{"groupOp":"'+b.groupOp+'","rules":[';var q=0;a.each(o,function(j,v){if(q>0){s+=",";}s+='{"field":"'+j+'",';s+='"op":"'+k[j]+'",';v+="";s+='"data":"'+v.replace(/\\/g,"\\\\").replace(/\"/g,'\\"')+'"}';q++;});s+="]}";a.extend(i.p.postData,{filters:s});a.each(["searchField","searchString","searchOper"],function(j,v){if(i.p.postData.hasOwnProperty(v)){delete i.p.postData[v];}});}else{a.extend(i.p.postData,o);}var p;if(i.p.searchurl){p=i.p.url;a(i).jqGrid("setGridParam",{url:i.p.searchurl});}var m=false;if(a.isFunction(b.beforeSearch)){m=b.beforeSearch.call(i);
}if(!m){a(i).jqGrid("setGridParam",{search:r}).trigger("reloadGrid",[{page:1}]);}if(p){a(i).jqGrid("setGridParam",{url:p});}if(a.isFunction(b.afterSearch)){b.afterSearch();}};var g=function(k){var m={},s,l=0,t;k=(typeof k!="boolean")?true:k;a.each(i.p.colModel,function(j,x){s=(this.searchoptions&&this.searchoptions.defaultValue)?this.searchoptions.defaultValue:"";t=this.index||this.name;switch(this.stype){case"select":var w;a("#gs_"+a.jgrid.jqID(t)+" option",i.grid.hDiv).each(function(y){if(y===0){this.selected=true;}if(a(this).text()==s){this.selected=true;w=a(this).val();return false;}});if(w){m[t]=w;l++;}else{try{delete i.p.postData[t];}catch(u){}}break;case"text":a("#gs_"+a.jgrid.jqID(t),i.grid.hDiv).val(s);if(s){m[t]=s;l++;}else{try{delete i.p.postData[t];}catch(v){}}break;}});var p=l>0?true:false;if(b.stringResult===true||i.p.datatype=="local"){var q='{"groupOp":"'+b.groupOp+'","rules":[';var o=0;a.each(m,function(j,u){if(o>0){q+=",";}q+='{"field":"'+j+'",';q+='"op":"eq",';u+="";q+='"data":"'+u.replace(/\\/g,"\\\\").replace(/\"/g,'\\"')+'"}';
o++;});q+="]}";a.extend(i.p.postData,{filters:q});a.each(["searchField","searchString","searchOper"],function(j,u){if(i.p.postData.hasOwnProperty(u)){delete i.p.postData[u];}});}else{a.extend(i.p.postData,m);}var n;if(i.p.searchurl){n=i.p.url;a(i).jqGrid("setGridParam",{url:i.p.searchurl});}var r=false;if(a.isFunction(b.beforeClear)){r=b.beforeClear.call(i);}if(!r){if(k){a(i).jqGrid("setGridParam",{search:p}).trigger("reloadGrid",[{page:1}]);}}if(n){a(i).jqGrid("setGridParam",{url:n});}if(a.isFunction(b.afterClear)){b.afterClear();}};var e=function(){var j=a("tr.ui-search-toolbar",i.grid.hDiv);if(j.css("display")=="none"){j.show();}else{j.hide();}};function h(j,l){var k=a(j);if(k[0]){jQuery.each(l,function(){if(this.data!==undefined){k.bind(this.type,this.data,this.fn);}else{k.bind(this.type,this.fn);}});}}var f=a("<tr class='ui-search-toolbar' role='rowheader'></tr>");var d;a.each(i.p.colModel,function(u,p){var x=this,v,m,s,j,A;m=a("<th role='columnheader' class='ui-state-default ui-th-column ui-th-"+i.p.direction+"'></th>");
v=a("<div style='width:100%;position:relative;height:100%;padding-right:0.3em;'></div>");if(this.hidden===true){a(m).css("display","none");}this.search=this.search===false?false:true;if(typeof this.stype=="undefined"){this.stype="text";}s=a.extend({},this.searchoptions||{});if(this.search){switch(this.stype){case"select":j=this.surl||s.dataUrl;if(j){A=v;a.ajax(a.extend({url:j,dataType:"html",complete:function(n,k){if(s.buildSelect!==undefined){var B=s.buildSelect(n);if(B){a(A).append(B);}}else{a(A).append(n.responseText);}if(s.defaultValue){a("select",A).val(s.defaultValue);}a("select",A).attr({name:x.index||x.name,id:"gs_"+x.name});if(s.attr){a("select",A).attr(s.attr);}a("select",A).css({width:"100%"});if(s.dataInit!==undefined){s.dataInit(a("select",A)[0]);}if(s.dataEvents!==undefined){h(a("select",A)[0],s.dataEvents);}if(b.autosearch===true){a("select",A).change(function(C){c();return false;});}n=null;}},a.jgrid.ajaxOptions,i.p.ajaxSelectOptions||{}));}else{var l;if(x.searchoptions&&x.searchoptions.value){l=x.searchoptions.value;
}else{if(x.editoptions&&x.editoptions.value){l=x.editoptions.value;}}if(l){var r=document.createElement("select");r.style.width="100%";a(r).attr({name:x.index||x.name,id:"gs_"+x.name});var o,z,q;if(typeof l==="string"){o=l.split(";");for(var t=0;t<o.length;t++){z=o[t].split(":");q=document.createElement("option");q.value=z[0];q.innerHTML=z[1];r.appendChild(q);}}else{if(typeof l==="object"){for(var y in l){if(l.hasOwnProperty(y)){q=document.createElement("option");q.value=y;q.innerHTML=l[y];r.appendChild(q);}}}}if(s.defaultValue){a(r).val(s.defaultValue);}if(s.attr){a(r).attr(s.attr);}if(s.dataInit!==undefined){s.dataInit(r);}if(s.dataEvents!==undefined){h(r,s.dataEvents);}a(v).append(r);if(b.autosearch===true){a(r).change(function(k){c();return false;});}}}break;case"text":var w=s.defaultValue?s.defaultValue:"";a(v).append("<input type='text' style='width:95%;padding:0px;' name='"+(x.index||x.name)+"' id='gs_"+x.name+"' value='"+w+"'/>");if(s.attr){a("input",v).attr(s.attr);}if(s.dataInit!==undefined){s.dataInit(a("input",v)[0]);
}if(s.dataEvents!==undefined){h(a("input",v)[0],s.dataEvents);}if(b.autosearch===true){if(b.searchOnEnter){a("input",v).keypress(function(n){var k=n.charCode?n.charCode:n.keyCode?n.keyCode:0;if(k==13){c();return false;}return this;});}else{a("input",v).keydown(function(n){var k=n.which;switch(k){case 13:return false;case 9:case 16:case 37:case 38:case 39:case 40:case 27:break;default:if(d){clearTimeout(d);}d=setTimeout(function(){c();},500);}});}}break;}}a(m).append(v);a(f).append(m);});a("table thead",i.grid.hDiv).append(f);this.ftoolbar=true;this.triggerToolbar=c;this.clearToolbar=g;this.toggleToolbar=e;});}});})(jQuery);