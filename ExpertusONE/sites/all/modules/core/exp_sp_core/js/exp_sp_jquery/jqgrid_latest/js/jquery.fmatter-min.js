(function(a){a.fmatter={};a.extend(a.fmatter,{isBoolean:function(b){return typeof b==="boolean";},isObject:function(b){return(b&&(typeof b==="object"||a.isFunction(b)))||false;},isString:function(b){return typeof b==="string";},isNumber:function(b){return typeof b==="number"&&isFinite(b);},isNull:function(b){return b===null;},isUndefined:function(b){return typeof b==="undefined";},isValue:function(b){return(this.isObject(b)||this.isString(b)||this.isNumber(b)||this.isBoolean(b));},isEmpty:function(b){if(!this.isString(b)&&this.isValue(b)){return false;}else{if(!this.isValue(b)){return true;}}b=a.trim(b).replace(/\&nbsp\;/ig,"").replace(/\&#160\;/ig,"");return b==="";}});a.fn.fmatter=function(f,g,e,b,c){var d=g;e=a.extend({},a.jgrid.formatter,e);if(a.fn.fmatter[f]){d=a.fn.fmatter[f](g,e,b,c);}return d;};a.fmatter.util={NumberFormat:function(d,b){if(!a.fmatter.isNumber(d)){d*=1;}if(a.fmatter.isNumber(d)){var f=(d<0);var l=d+"";var h=(b.decimalSeparator)?b.decimalSeparator:".";var j;if(a.fmatter.isNumber(b.decimalPlaces)){var k=b.decimalPlaces;
var e=Math.pow(10,k);l=Math.round(d*e)/e+"";j=l.lastIndexOf(".");if(k>0){if(j<0){l+=h;j=l.length-1;}else{if(h!=="."){l=l.replace(".",h);}}while((l.length-1-j)<k){l+="0";}}}if(b.thousandsSeparator){var n=b.thousandsSeparator;j=l.lastIndexOf(h);j=(j>-1)?j:l.length;var m=l.substring(j);var c=-1;for(var g=j;g>0;g--){c++;if((c%3===0)&&(g!==j)&&(!f||(g>1))){m=n+m;}m=l.charAt(g-1)+m;}l=m;}l=(b.prefix)?b.prefix+l:l;l=(b.suffix)?l+b.suffix:l;return l;}else{return d;}},DateFormat:function(J,M,P,y){var m=/\\.|[dDjlNSwzWFmMntLoYyaABgGhHisueIOPTZcrU]/g,D=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,L=/[^-+\dA-Z]/g,p=new RegExp("^/Date\\((([-+])?[0-9]+)(([-+])([0-9]{2})([0-9]{2}))?\\)/$"),f=((typeof M==="string")?M.match(p):null),K=function(j,i){j=String(j);i=parseInt(i,10)||2;while(j.length<i){j="0"+j;}return j;},b={m:1,d:1,y:1970,h:0,i:0,s:0,u:0},e=0,r,F,d,E=["i18n"];E.i18n={dayNames:y.dayNames,monthNames:y.monthNames};
if(J in y.masks){J=y.masks[J];}if(M.constructor===Number){if(String(J).toLowerCase()=="u"){M=M*1000;}e=new Date(M);}else{if(M.constructor===Date){e=M;}else{if(f!==null){e=new Date(parseInt(f[1],10));if(f[3]){var g=Number(f[5])*60+Number(f[6]);g*=((f[4]=="-")?1:-1);g-=e.getTimezoneOffset();e.setTime(Number(Number(e)+(g*60*1000)));}}else{M=String(M).split(/[\\\/:_;.,\t\T\s-]/);J=J.split(/[\\\/:_;.,\t\T\s-]/);for(F=0,d=J.length;F<d;F++){if(J[F]=="M"){r=a.inArray(M[F],E.i18n.monthNames);if(r!==-1&&r<12){M[F]=r+1;}}if(J[F]=="F"){r=a.inArray(M[F],E.i18n.monthNames);if(r!==-1&&r>11){M[F]=r+1-12;}}if(M[F]){b[J[F].toLowerCase()]=parseInt(M[F],10);}}if(b.f){b.m=b.f;}if(b.m===0&&b.y===0&&b.d===0){return"&#160;";}b.m=parseInt(b.m,10)-1;var O=b.y;if(O>=70&&O<=99){b.y=1900+b.y;}else{if(O>=0&&O<=69){b.y=2000+b.y;}}e=new Date(b.y,b.m,b.d,b.h,b.i,b.s,b.u);}}}if(P in y.masks){P=y.masks[P];}else{if(!P){P="Y-m-d";}}var v=e.getHours(),I=e.getMinutes(),H=e.getDate(),C=e.getMonth()+1,B=e.getTimezoneOffset(),A=e.getSeconds(),x=e.getMilliseconds(),t=e.getDay(),c=e.getFullYear(),l=(t+6)%7+1,q=(new Date(c,C-1,H)-new Date(c,0,1))/86400000,h={d:K(H),D:E.i18n.dayNames[t],j:H,l:E.i18n.dayNames[t+7],N:l,S:y.S(H),w:t,z:q,W:l<5?Math.floor((q+l-1)/7)+1:Math.floor((q+l-1)/7)||((new Date(c-1,0,1).getDay()+6)%7<4?53:52),F:E.i18n.monthNames[C-1+12],m:K(C),M:E.i18n.monthNames[C-1],n:C,t:"?",L:"?",o:"?",Y:c,y:String(c).substring(2),a:v<12?y.AmPm[0]:y.AmPm[1],A:v<12?y.AmPm[2]:y.AmPm[3],B:"?",g:v%12||12,G:v,h:K(v%12||12),H:K(v),i:K(I),s:K(A),u:x,e:"?",I:"?",O:(B>0?"-":"+")+K(Math.floor(Math.abs(B)/60)*100+Math.abs(B)%60,4),P:"?",T:(String(e).match(D)||[""]).pop().replace(L,""),Z:"?",c:"?",r:"?",U:Math.floor(e/1000)};
return P.replace(m,function(i){return i in h?h[i]:i.substring(1);});}};a.fn.fmatter.defaultFormat=function(c,b){return(a.fmatter.isValue(c)&&c!=="")?c:b.defaultValue?b.defaultValue:"&#160;";};a.fn.fmatter.email=function(c,b){if(!a.fmatter.isEmpty(c)){return'<a href="mailto:'+c+'">'+c+"</a>";}else{return a.fn.fmatter.defaultFormat(c,b);}};a.fn.fmatter.checkbox=function(e,c){var f=a.extend({},c.checkbox),d;if(!a.fmatter.isUndefined(c.colModel.formatoptions)){f=a.extend({},f,c.colModel.formatoptions);}if(f.disabled===true){d='disabled="disabled"';}else{d="";}if(a.fmatter.isEmpty(e)||a.fmatter.isUndefined(e)){e=a.fn.fmatter.defaultFormat(e,f);}e=e+"";e=e.toLowerCase();var b=e.search(/(false|0|no|off)/i)<0?" checked='checked' ":"";return'<input type="checkbox" '+b+' value="'+e+'" offval="no" '+d+"/>";};a.fn.fmatter.link=function(d,b){var e={target:b.target};var c="";if(!a.fmatter.isUndefined(b.colModel.formatoptions)){e=a.extend({},e,b.colModel.formatoptions);}if(e.target){c="target="+e.target;
}if(!a.fmatter.isEmpty(d)){return"<a "+c+' href="'+d+'">'+d+"</a>";}else{return a.fn.fmatter.defaultFormat(d,b);}};a.fn.fmatter.showlink=function(d,b){var f={baseLinkUrl:b.baseLinkUrl,showAction:b.showAction,addParam:b.addParam||"",target:b.target,idName:b.idName},c="",e;if(!a.fmatter.isUndefined(b.colModel.formatoptions)){f=a.extend({},f,b.colModel.formatoptions);}if(f.target){c="target="+f.target;}e=f.baseLinkUrl+f.showAction+"?"+f.idName+"="+b.rowId+f.addParam;if(a.fmatter.isString(d)||a.fmatter.isNumber(d)){return"<a "+c+' href="'+e+'">'+d+"</a>";}else{return a.fn.fmatter.defaultFormat(d,b);}};a.fn.fmatter.integer=function(c,b){var d=a.extend({},b.integer);if(!a.fmatter.isUndefined(b.colModel.formatoptions)){d=a.extend({},d,b.colModel.formatoptions);}if(a.fmatter.isEmpty(c)){return d.defaultValue;}return a.fmatter.util.NumberFormat(c,d);};a.fn.fmatter.number=function(c,b){var d=a.extend({},b.number);if(!a.fmatter.isUndefined(b.colModel.formatoptions)){d=a.extend({},d,b.colModel.formatoptions);
}if(a.fmatter.isEmpty(c)){return d.defaultValue;}return a.fmatter.util.NumberFormat(c,d);};a.fn.fmatter.currency=function(c,b){var d=a.extend({},b.currency);if(!a.fmatter.isUndefined(b.colModel.formatoptions)){d=a.extend({},d,b.colModel.formatoptions);}if(a.fmatter.isEmpty(c)){return d.defaultValue;}return a.fmatter.util.NumberFormat(c,d);};a.fn.fmatter.date=function(e,d,b,c){var f=a.extend({},d.date);if(!a.fmatter.isUndefined(d.colModel.formatoptions)){f=a.extend({},f,d.colModel.formatoptions);}if(!f.reformatAfterEdit&&c=="edit"){return a.fn.fmatter.defaultFormat(e,d);}else{if(!a.fmatter.isEmpty(e)){return a.fmatter.util.DateFormat(f.srcformat,e,f.newformat,f);}else{return a.fn.fmatter.defaultFormat(e,d);}}};a.fn.fmatter.select=function(g,b,c,l){g=g+"";var e=false,k=[];if(!a.fmatter.isUndefined(b.colModel.formatoptions)){e=b.colModel.formatoptions.value;}else{if(!a.fmatter.isUndefined(b.colModel.editoptions)){e=b.colModel.editoptions.value;}}if(e){var o=b.colModel.editoptions.multiple===true?true:false,n=[],m;
if(o){n=g.split(",");n=a.map(n,function(i){return a.trim(i);});}if(a.fmatter.isString(e)){var d=e.split(";"),f=0;for(var h=0;h<d.length;h++){m=d[h].split(":");if(m.length>2){m[1]=jQuery.map(m,function(p,j){if(j>0){return p;}}).join(":");}if(o){if(jQuery.inArray(m[0],n)>-1){k[f]=m[1];f++;}}else{if(a.trim(m[0])==a.trim(g)){k[0]=m[1];break;}}}}else{if(a.fmatter.isObject(e)){if(o){k=jQuery.map(n,function(p,j){return e[p];});}else{k[0]=e[g]||"";}}}}g=k.join(", ");return g===""?a.fn.fmatter.defaultFormat(g,b):g;};a.fn.fmatter.rowactions=function(f,e,c,i){var h={keys:false,onEdit:null,onSuccess:null,afterSave:null,onError:null,afterRestore:null,extraparam:{oper:"edit"},url:null,delOptions:{},editOptions:{}};f=a.jgrid.jqID(f);e=a.jgrid.jqID(e);var b=a("#"+e)[0].p.colModel[i];if(!a.fmatter.isUndefined(b.formatoptions)){h=a.extend(h,b.formatoptions);}if(!a.fmatter.isUndefined(a("#"+e)[0].p.editOptions)){h.editOptions=a("#"+e)[0].p.editOptions;}if(!a.fmatter.isUndefined(a("#"+e)[0].p.delOptions)){h.delOptions=a("#"+e)[0].p.delOptions;
}var d=function(j){if(h.afterSave){h.afterSave(j);}a("tr#"+f+" div.ui-inline-edit, tr#"+f+" div.ui-inline-del","#"+e+".ui-jqgrid-btable:first").show();a("tr#"+f+" div.ui-inline-save, tr#"+f+" div.ui-inline-cancel","#"+e+".ui-jqgrid-btable:first").hide();},g=function(j){if(h.afterRestore){h.afterRestore(j);}a("tr#"+f+" div.ui-inline-edit, tr#"+f+" div.ui-inline-del","#"+e+".ui-jqgrid-btable:first").show();a("tr#"+f+" div.ui-inline-save, tr#"+f+" div.ui-inline-cancel","#"+e+".ui-jqgrid-btable:first").hide();};switch(c){case"edit":a("#"+e).jqGrid("editRow",f,h.keys,h.onEdit,h.onSuccess,h.url,h.extraparam,d,h.onError,g);a("tr#"+f+" div.ui-inline-edit, tr#"+f+" div.ui-inline-del","#"+e+".ui-jqgrid-btable:first").hide();a("tr#"+f+" div.ui-inline-save, tr#"+f+" div.ui-inline-cancel","#"+e+".ui-jqgrid-btable:first").show();break;case"save":if(a("#"+e).jqGrid("saveRow",f,h.onSuccess,h.url,h.extraparam,d,h.onError,g)){a("tr#"+f+" div.ui-inline-edit, tr#"+f+" div.ui-inline-del","#"+e+".ui-jqgrid-btable:first").show();
a("tr#"+f+" div.ui-inline-save, tr#"+f+" div.ui-inline-cancel","#"+e+".ui-jqgrid-btable:first").hide();}break;case"cancel":a("#"+e).jqGrid("restoreRow",f,g);a("tr#"+f+" div.ui-inline-edit, tr#"+f+" div.ui-inline-del","#"+e+".ui-jqgrid-btable:first").show();a("tr#"+f+" div.ui-inline-save, tr#"+f+" div.ui-inline-cancel","#"+e+".ui-jqgrid-btable:first").hide();break;case"del":a("#"+e).jqGrid("delGridRow",f,h.delOptions);break;case"formedit":a("#"+e).jqGrid("setSelection",f);a("#"+e).jqGrid("editGridRow",f,h.editOptions);break;}};a.fn.fmatter.actions=function(f,d,b){var h={keys:false,editbutton:true,delbutton:true,editformbutton:false};if(!a.fmatter.isUndefined(d.colModel.formatoptions)){h=a.extend(h,d.colModel.formatoptions);}var c=d.rowId,g="",e;if(typeof(c)=="undefined"||a.fmatter.isEmpty(c)){return"";}if(h.editformbutton){e="onclick=$.fn.fmatter.rowactions('"+c+"','"+d.gid+"','formedit',"+d.pos+"); onmouseover=jQuery(this).addClass('ui-state-hover'); onmouseout=jQuery(this).removeClass('ui-state-hover'); ";
g=g+"<div title='"+a.jgrid.nav.edittitle+"' style='float:left;cursor:pointer;' class='ui-pg-div ui-inline-edit' "+e+"><span class='ui-icon ui-icon-pencil'></span></div>";}else{if(h.editbutton){e="onclick=$.fn.fmatter.rowactions('"+c+"','"+d.gid+"','edit',"+d.pos+"); onmouseover=jQuery(this).addClass('ui-state-hover'); onmouseout=jQuery(this).removeClass('ui-state-hover') ";g=g+"<div title='"+a.jgrid.nav.edittitle+"' style='float:left;cursor:pointer;' class='ui-pg-div ui-inline-edit' "+e+"><span class='ui-icon ui-icon-pencil'></span></div>";}}if(h.delbutton){e="onclick=$.fn.fmatter.rowactions('"+c+"','"+d.gid+"','del',"+d.pos+"); onmouseover=jQuery(this).addClass('ui-state-hover'); onmouseout=jQuery(this).removeClass('ui-state-hover'); ";g=g+"<div title='"+a.jgrid.nav.deltitle+"' style='float:left;margin-left:5px;' class='ui-pg-div ui-inline-del' "+e+"><span class='ui-icon ui-icon-trash'></span></div>";}e="onclick=$.fn.fmatter.rowactions('"+c+"','"+d.gid+"','save',"+d.pos+"); onmouseover=jQuery(this).addClass('ui-state-hover'); onmouseout=jQuery(this).removeClass('ui-state-hover'); ";
g=g+"<div title='"+a.jgrid.edit.bSubmit+"' style='float:left;display:none' class='ui-pg-div ui-inline-save' "+e+"><span class='ui-icon ui-icon-disk'></span></div>";e="onclick=$.fn.fmatter.rowactions('"+c+"','"+d.gid+"','cancel',"+d.pos+"); onmouseover=jQuery(this).addClass('ui-state-hover'); onmouseout=jQuery(this).removeClass('ui-state-hover'); ";g=g+"<div title='"+a.jgrid.edit.bCancel+"' style='float:left;display:none;margin-left:5px;' class='ui-pg-div ui-inline-cancel' "+e+"><span class='ui-icon ui-icon-cancel'></span></div>";return"<div style='margin-left:8px;'>"+g+"</div>";};a.unformat=function(e,m,j,c){var h,f=m.colModel.formatter,g=m.colModel.formatoptions||{},n,l=/([\.\*\_\'\(\)\{\}\+\?\\])/g,i=m.colModel.unformat||(a.fn.fmatter[f]&&a.fn.fmatter[f].unformat);if(typeof i!=="undefined"&&a.isFunction(i)){h=i(a(e).text(),m,e);}else{if(!a.fmatter.isUndefined(f)&&a.fmatter.isString(f)){var b=a.jgrid.formatter||{},k;switch(f){case"integer":g=a.extend({},b.integer,g);n=g.thousandsSeparator.replace(l,"\\$1");
k=new RegExp(n,"g");h=a(e).text().replace(k,"");break;case"number":g=a.extend({},b.number,g);n=g.thousandsSeparator.replace(l,"\\$1");k=new RegExp(n,"g");h=a(e).text().replace(k,"").replace(g.decimalSeparator,".");break;case"currency":g=a.extend({},b.currency,g);n=g.thousandsSeparator.replace(l,"\\$1");k=new RegExp(n,"g");h=a(e).text().replace(k,"").replace(g.decimalSeparator,".").replace(g.prefix,"").replace(g.suffix,"");break;case"checkbox":var d=(m.colModel.editoptions)?m.colModel.editoptions.value.split(":"):["Yes","No"];h=a("input",e).attr("checked")?d[0]:d[1];break;case"select":h=a.unformat.select(e,m,j,c);break;case"actions":return"";default:h=a(e).text();}}}return h!==undefined?h:c===true?a(e).text():a.jgrid.htmlDecode(a(e).html());};a.unformat.select=function(f,q,l,c){var k=[];var o=a(f).text();if(c===true){return o;}var h=a.extend({},q.colModel.editoptions);if(h.value){var d=h.value,p=h.multiple===true?true:false,n=[],m;if(p){n=o.split(",");n=a.map(n,function(i){return a.trim(i);
});}if(a.fmatter.isString(d)){var b=d.split(";"),e=0;for(var g=0;g<b.length;g++){m=b[g].split(":");if(m.length>2){m[1]=jQuery.map(m,function(r,j){if(j>0){return r;}}).join(":");}if(p){if(jQuery.inArray(m[1],n)>-1){k[e]=m[0];e++;}}else{if(a.trim(m[1])==a.trim(o)){k[0]=m[0];break;}}}}else{if(a.fmatter.isObject(d)||a.isArray(d)){if(!p){n[0]=o;}k=jQuery.map(n,function(j){var i;a.each(d,function(r,s){if(s==j){i=r;return false;}});if(typeof(i)!="undefined"){return i;}});}}return k.join(", ");}else{return o||"";}};a.unformat.date=function(c,b){var d=a.jgrid.formatter.date||{};if(!a.fmatter.isUndefined(b.formatoptions)){d=a.extend({},d,b.formatoptions);}if(!a.fmatter.isEmpty(c)){return a.fmatter.util.DateFormat(d.newformat,c,d.srcformat,d);}else{return a.fn.fmatter.defaultFormat(c,b);}};})(jQuery);