registernamespace("EXPERTUS.SMARTPORTAL.AbstractManager");EXPERTUS.SMARTPORTAL.AbstractManager={asyncReq:true,requestXml:"",connectionStatus:"",httpRequest:null,url:"",soapAction:"",methodName:"",actionKey:null,callback:"",timeOut:null,serviceAttributes:null,xmlResponseBaseURL:null,widgetObject:null,callback:null,loaderobj:null,initialize:function(a){this.setwidgetObject(a);this.setActionKey(a.getActionKey());this.setEndPointURL(a.getEndPointURL());},setLoaderObj:function(a){this.loaderobj=a;},getLoaderObj:function(){return this.loaderobj;},setwidgetObject:function(a){this.widgetObject=a;},setCallBack:function(c,b){this.callback=c;if(b!=null&&b!=undefined&&b!=""&&typeof b=="object"){var a=this.convertJsonToString(b);this.callback=this.callback+"("+a+")";}else{if(b!=null&&b!=undefined&&b!=""&&typeof b=="string"){this.callback=this.callback+'("'+b+'")';}else{this.callback=this.callback+"()";}}},convertJsonToString:function(d){var c="";if(d!=null&&d!=undefined&&d!=""&&typeof d=="object"){c="{";
for(var b in d){if(c.length>2){c+=",";}var a=(typeof d[b]=="object")?this.convertJsonToString(d[b]):(typeof d[b]=="string"?(d[b].indexOf('"')>0?"'"+d[b]+"'":'"'+d[b]+'"'):d[b]);a=String(a).length>0?a:'""';c+='"'+b+'":'+a;}c+="}";}return c;},getCallBack:function(){return this.callback;},getwidgetObject:function(){return this.widgetObject;},execute:function(){var returnFunction=(this.getCallBack()==null||this.getCallBack()==undefined)?"renderResults()":this.getCallBack();var widgetObj=this.getwidgetObject();var loader="";if(this.getLoaderObj()!=null&&this.getLoaderObj()!=undefined&&this.getLoaderObj()!="null"){if(document.getElementById(this.getLoaderObj())!=null){loader=this.getLoaderObj();}else{loader=widgetObj.getUniqueWidgetId()+((this.getLoaderObj()!=null&&this.getLoaderObj()!=undefined)?this.getLoaderObj():"");}}else{loader=null;}if(loader!=null){widgetObj.createLoader(loader);}$("#msgDiv").css("display","none");var mgr=this;jQuery.ajaxSetup({xhr:function(){try{if(window.ActiveXObject){return new window.ActiveXObject("Microsoft.XMLHTTP");
}}catch(e){}return new window.XMLHttpRequest();}});jQuery.ajax({type:"POST",url:this.url,processData:false,data:this.requestXml,dataType:"text",contentType:"text/xml",async:true,beforeSend:function(req){req.setRequestHeader("SOAPAction",mgr.getActionKey());req.setRequestHeader("Accept-Encoding","gzip, deflate");},success:function(respText){widgetObj.responseText=widgetObj.Trim(respText);widgetObj.convertResponseXml();if(loader!=null){widgetObj.destroyLoader(loader);}eval("widgetObj."+returnFunction);},failure:function(msg){widgetObj.responseText=widgetObj.Trim(msg);widgetObj.convertResponseXml();if(loader!=null){widgetObj.destroyLoader(loader);}widgetObj.renderErrorCommon();},error:function(XMLHttpRequest,textStatus,errorThrown){widgetObj.responseText=widgetObj.Trim(XMLHttpRequest.responseText);widgetObj.convertResponseXml();if(loader!=null){widgetObj.destroyLoader(loader);}widgetObj.renderErrorCommon();}});},getRequestXML:function(){return this.requestXml;},Trim:function(a){return $.trim(a);
},LTrim:function(a){return $.trim(a);},RTrim:function(a){return $.trim(a);},getResponseXML:function(){return this.responseXml;},getRequestObj:function(){return this.httpRequest;},setMethodName:function(a){this.methodName=a;},setActionKey:function(a){this.actionKey=a;},getActionKey:function(){return this.actionKey;},setSOAPAction:function(a){this.soapAction=a;},setEndPointURL:function(b){var a=this.getwidgetObject();if(a.getUniqueWidgetId().toLowerCase().indexOf("lnr")>=0||a.getUniqueWidgetId().toLowerCase().indexOf("team")>=0){this.url=b+a.getUniqueWidgetId();}else{this.url=b+this.getActionKey();}},generateQueryString:function(){var qstr="";var widgetObj=this.getwidgetObject();if(this.getActionKey()!=null&&this.getActionKey()!=undefined&&this.getActionKey().length>0){qstr+=qstr.length>0?"&actionkey="+this.getActionKey():"?actionkey="+this.getActionKey();}if(config.data[2].licensekey[0].admin_licensekey!=null&&config.data[2].licensekey[0].admin_licensekey!=undefined&&config.data[2].licensekey[0].admin_licensekey!=""){qstr+=qstr.length>0?"&licensekey="+config.data[2].licensekey[0].admin_licensekey:"?licensekey="+config.data[2].licensekey[0].admin_licensekey;
var srvno=eval("config.data[3].SCServiceno[0]."+widgetObj.getUniqueWidgetId());qstr+=srvno==undefined?"&SCServiceno="+config.data[3].SCServiceno[0].all:"&SCServiceno="+srvno;}return qstr;},setCallbackFunctions:function(a){this.callback=a;},getLovRequest:function(obj){var widgetObj=this.getwidgetObject();this.setActionKey(eval("config.data[1].serviceaction[0].PickListService"));this.setEndPointURL(widgetObj.getEndPointURL());var request=new Object();request.query=new SOAPObject("PickList").attr("xsi:type","null");if(obj!=undefined&&obj.length>0){for(var i=0;i<obj.length;i++){var request1=new Object();var code=(obj[i].code!=null&&obj[i].code!=undefined)?obj[i].code:"";var language=(obj[i].language!=null&&obj[i].language!=undefined)?obj[i].language:"";request1.query=new SOAPObject("Lists").attr("xsi:type","null");request1.query.appendChild(new SOAPObject("Code").attr("xsi:type","null").val(code));request1.query.appendChild(new SOAPObject("Language").attr("xsi:type","null").val(language));request.query.appendChild(request1.query);
}}var sr=new SOAPRequest("PickList",request,this.getSOAPHeader());sr="<?xml version='1.0' encoding='UTF-8'?>"+sr;sr=sr.toString();return sr;},getLinkPathRequest:function(obj){var widgetObj=this.getwidgetObject();this.setActionKey(eval("config.data[1].serviceaction[0].LinkPathService"));this.setEndPointURL(widgetObj.getEndPointURL());var request=new Object();request.query=new SOAPObject("LinkPath").attr("xsi:type","null");request.query.appendChild(new SOAPObject("LinkTitle").attr("xsi:type","null").val(obj.LinkTitle));var sr=new SOAPRequest("LinkPath",request,this.getSOAPHeader());sr="<?xml version='1.0' encoding='UTF-8'?>"+sr;sr=sr.toString();return sr;},getSOAPRequest:function(c,b){var a=new SOAPRequest(c,b,this.getSOAPHeader());a="<?xml version='1.0' encoding='UTF-8'?>"+a;a=a.toString();return a;},getSOAPHeader:function(){var a=new Object();a.query=new SOAPObject("MessageHeaderInfo").attr("xsi:type","null");a.query.appendChild(new SOAPObject("PortalLicenseKey").attr("xsi:type","null").val(this.getCookie("SPLearnerLicense")));
a.query.appendChild(new SOAPObject("PortalAuthKey").attr("xsi:type","null").val(this.getCookie("SPCertificate")));return a;},getCookie:function(a){if(document.cookie.length>0){c_start=document.cookie.indexOf(a+"=");if(c_start!=-1){c_start=c_start+a.length+1;c_end=document.cookie.indexOf(";",c_start);if(c_end==-1){c_end=document.cookie.length;}return unescape(document.cookie.substring(c_start,c_end));}}return"";}};