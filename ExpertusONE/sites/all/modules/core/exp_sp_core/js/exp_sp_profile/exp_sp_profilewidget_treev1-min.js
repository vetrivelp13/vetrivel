registernamespace("EXPERTUS.SMARTPORTAL.ProfileManager");EXPERTUS.SMARTPORTAL.ProfileManager=function(){try{this.generateCreateRequest=function(f){try{var c=new Object();c.query=new SOAPObject("InsertProfile").attr("xsi:type","null");c.query.appendChild(new SOAPObject("parent_id").attr("xsi:type","null").val(f.parent_id));c.query.appendChild(new SOAPObject("level").attr("xsi:type","null").val(f.level));c.query.appendChild(new SOAPObject("name").attr("xsi:type","null").val(f.name));c.query.appendChild(new SOAPObject("description").attr("xsi:type","null").val(f.description));c.query.appendChild(new SOAPObject("type").attr("xsi:type","null").val(f.type));c.query.appendChild(new SOAPObject("is_active").attr("xsi:type","null").val(f.is_active));var b=new SOAPRequest("InsertProfile",c);b="<?xml version='1.0' encoding='UTF-8'?>"+b;b=b.toString();return b;}catch(d){}};this.generateProfileRequest=function(f){try{var c=new Object();c.query=new SOAPObject("GetProfile").attr("xsi:type","null");c.query.appendChild(new SOAPObject("dummy").attr("xsi:type","null").val(""));
var b=new SOAPRequest("GetProfile",c);b="<?xml version='1.0' encoding='UTF-8'?>"+b;b=b.toString();return b;}catch(d){}};this.generateProfileDetsRequest=function(f){try{var c=new Object();c.query=new SOAPObject("GetProfileDets").attr("xsi:type","null");c.query.appendChild(new SOAPObject("id").attr("xsi:type","null").val(f.id));var b=new SOAPRequest("GetProfile",c);b="<?xml version='1.0' encoding='UTF-8'?>"+b;b=b.toString();return b;}catch(d){}};this.generateRenameProfileRequest=function(f){try{var c=new Object();c.query=new SOAPObject("RenameProfile").attr("xsi:type","null");c.query.appendChild(new SOAPObject("id").attr("xsi:type","null").val(f.id));c.query.appendChild(new SOAPObject("newname").attr("xsi:type","null").val(f.newname));c.query.appendChild(new SOAPObject("level").attr("xsi:type","null").val(f.level));var b=new SOAPRequest("RenameProfile",c);b="<?xml version='1.0' encoding='UTF-8'?>"+b;b=b.toString();return b;}catch(d){}};this.generateDeleteProfileRequest=function(f){try{var c=new Object();
c.query=new SOAPObject("DeleteProfile").attr("xsi:type","null");c.query.appendChild(new SOAPObject("id").attr("xsi:type","null").val(f.id));c.query.appendChild(new SOAPObject("level").attr("xsi:type","null").val(f.level));var b=new SOAPRequest("DeleteProfile",c);b="<?xml version='1.0' encoding='UTF-8'?>"+b;b=b.toString();return b;}catch(d){}};this.generateUpdateProfileRequest=function(f){try{var c=new Object();c.query=new SOAPObject("UpdateProfile").attr("xsi:type","null");c.query.appendChild(new SOAPObject("id").attr("xsi:type","null").val(f.id));c.query.appendChild(new SOAPObject("name").attr("xsi:type","null").val(f.name));c.query.appendChild(new SOAPObject("description").attr("xsi:type","null").val(f.description));c.query.appendChild(new SOAPObject("type").attr("xsi:type","null").val(f.type));c.query.appendChild(new SOAPObject("is_active").attr("xsi:type","null").val(f.is_active));var b=new SOAPRequest("UpdateProfile",c);b="<?xml version='1.0' encoding='UTF-8'?>"+b;b=b.toString();return b;
}catch(d){}};this.generateProfileByTypeRequest=function(f){try{var c=new Object();c.query=new SOAPObject("getProfileByType").attr("xsi:type","null");c.query.appendChild(new SOAPObject("type").attr("xsi:type","null").val(f.type));var b=new SOAPRequest("getProfileByType",c);b="<?xml version='1.0' encoding='UTF-8'?>"+b;b=b.toString();return b;}catch(d){}};this.exec=function(c){try{var b="<img src='sites/"+resourse.admin_site_name+"/modules/jquery_update/jstree/source/themes/classic/throbber.gif' id='throbber'/>";$(c).find("a:first").after(b);this.execute();}catch(d){}};}catch(a){}};$.extend(EXPERTUS.SMARTPORTAL.ProfileManager.prototype,EXPERTUS.SMARTPORTAL.AbstractManager);registernamespace("EXPERTUS.SMARTPORTAL.ProfileWidget");EXPERTUS.SMARTPORTAL.ProfileWidget=function(){try{this.widgetGlobalName="EXPERTUS.SMARTPORTAL.ProfileWidget";this.mode="";this.current_node;this.created=0;this.tree;this.level;this.type;this.render=function(f){try{var b="<div id='"+this.getUniqueWidgetId()+"profilemain' style='width:700px;'></div><div id='"+this.getUniqueWidgetId()+"profilecontent'></div><div id='"+this.getUniqueWidgetId()+"languagecontent'></div>";
this.renderBase(f,this);this.mode="getprofile";var c=new EXPERTUS.SMARTPORTAL.ProfileManager();c.initialize(this);c.requestXml=c.generateProfileRequest();c.execute();$("#"+this.getUniqueWidgetId()).html(b);}catch(d){}};this.showTree=function(){try{var f=this;var b=$(this.responseText).find("GetProfileResponse").text();var g;$("#"+this.getUniqueWidgetId()+"profilemain").tree({callback:{beforecreate:function(j,e,i,h){f.current_node=e;f.tree=h;f.type=i;g=getLevel(e,h,-1);f.level=g;if((g==0||(g==1&&i!="inside"))&&f.mode!="createnode"){f.mode="createnode";f.showDialog();return false;}else{f.mode="createnode";return true;}},oncreate:function(h,e,i){f.created=1;f.current_node=h;},beforerename:function(i,j,h){if(f.mode=="createnode"){return true;}if(f.mode=="updatenode"){f.mode="";return true;}f.mode="renamenode";f.current_node=i;g=getLevel(i,h,-1);f.level=g;if(g==1){var e=new EXPERTUS.SMARTPORTAL.ProfileManager();e.initialize(f);e.requestXml=e.generateProfileDetsRequest({id:i.id});e.exec(i);return false;
}else{return true;}},onrename:function(j,h,k){g=getLevel(j,h,-1);if(f.created==1){f.created=0;var i=h.parent(j);var l={parent_id:$(i).attr("id"),level:g,name:h.get_text(j),description:"test"};f.mode="createnode";var e=new EXPERTUS.SMARTPORTAL.ProfileManager();e.initialize(f);e.requestXml=e.generateCreateRequest(l);e.exec(j);}else{if(f.level==1){return;}else{var i=h.parent(j);var l={id:j.id,newname:h.get_text(j),level:g};f.mode="renamenode";var e=new EXPERTUS.SMARTPORTAL.ProfileManager();e.initialize(f);e.requestXml=e.generateRenameProfileRequest(l);e.exec(j);}}},beforedelete:function(h,e,i){g=getLevel(h,e,-1);this.current_node=e.parent(h);return true;},ondelete:function(i,h,j){var k={id:i.id,level:g};f.mode="deletenode";var e=new EXPERTUS.SMARTPORTAL.ProfileManager();e.initialize(f);e.requestXml=e.generateDeleteProfileRequest(k);e.exec(this.current_node);},check_move:function(j,e,i,h,k){return false;},onmove:function(j,e,i,h,k){alert(h.get_text(j)+" "+i+" "+h.get_text(e));}},data:{type:"xml_flat",opts:{"static":b}}});
$("#"+this.getUniqueWidgetId()+"profilemain").append('<div style="clear:both;padding:20px;">');$("#"+this.getUniqueWidgetId()+"profilemain").append('<input type="button" value="Add" onclick="'+this.getWidgetInstanceName()+'.addNode();" />');$("#"+this.getUniqueWidgetId()+"profilemain").append('<input type="button" value="Edit" onclick="renNode();" />');$("#"+this.getUniqueWidgetId()+"profilemain").append('<input type="button" value="Delete" onclick="deleteNode();" />');$("#"+this.getUniqueWidgetId()+"profilemain").append("</div>");var c=$.tree.focused;}catch(d){}};this.test=function(){try{var b=new EXPERTUS.SMARTPORTAL.ProfileManager();b.initialize(this);b.requestXml=b.generateProfileByTypeRequest({type:"1"});b.execute();}catch(c){}};this.showDialog=function(){try{var d=$.tree.focused();var b=getLevel(this.current_node,$.tree.focused(),-1);var c='<div id="newprofile" style="display:none;padding:5px 0;"><table><tr><td>'+SMARTPORTAL.t("Name :")+'</td><td><input type="text" id="prof_name" size="10"/></td>';
c+="<td>"+SMARTPORTAL.t("Type : ")+'</td><td><select id="prof_type"><option value="1">1</option><option value="2">2</option><option value="3">3</option></select></td></tr>';c+="<tr><td>"+SMARTPORTAL.t("Description :")+'</td><td><input type="text" id="prof_desc" value="" /></td>';c+="<td>"+SMARTPORTAL.t("Active :")+'</td><td><select id="prof_active"><option value="Y">'+SMARTPORTAL.t("Yes")+'</option><option value="N">'+SMARTPORTAL.t("No")+"</option></select></td></tr>";c+='<tr><td colspan="2" align="center"><input type="button" value="'+SMARTPORTAL.t("Save")+'" onclick="'+this.getWidgetInstanceName();saveNode(b);+'" /></td><td colspan="2"><input type="button" value="'+SMARTPORTAL.t("Close")+'" onclick="$("#newprofile").remove();"/></td></tr></table></div>';$("#R").append(c);$("#newprofile").show("slow");}catch(f){}};this.renderError=function(){try{alert(this.responseText);}catch(b){}};this.renderResults=function(){try{if(this.mode=="getprofile"){this.showTree();}else{if(this.mode=="createnode"){this.current_node.id=$(this.responseText).find("InsertProfileResponse").text();
this.mode="";}else{if(this.mode=="renamenode"){if(this.level==1){var b='<div id="newprofile" style="display:none;padding:5px 0;"><table><tr><td>'+SMARTPORTAL.t("Name :")+'</td><td><input type="text" id="prof_name" size="10"/></td>';b+="<td>"+SMARTPORTAL.t("Type : ")+'</td><td><select id="prof_type"><option value="1">1</option><option value="2">2</option><option value="3">3</option></select></td></tr>';b+="<tr><td>"+SMARTPORTAL.t("Description :")+'</td><td><input type="text" id="prof_desc" value="" /></td>';b+="<td>"+SMARTPORTAL.t("Active :")+'</td><td><select id="prof_active"><option value="Y">'+SMARTPORTAL.t("Yes")+'</option><option value="N">'+SMARTPORTAL.t("No")+"</option></select></td></tr>";b+='<tr><td colspan="2" align="center"><input type="button" value="Save" onclick="'+this.getWidgetInstanceName()+'.updateRootNode();" /></td><td colspan="2"><input type="button" value="Close" onclick="$("#newprofile").remove();"/></td></tr></table></div>';$("#newprofile").remove();$("#"+this.current_node.id).append(b);
$("#prof_name").val($(this.responseText).find("name").text());$("#prof_desc").val($(this.responseText).find("description").text());$("#prof_active").val($(this.responseText).find("is_active").text());$("#prof_type").val($(this.responseText).find("type").text());$("#newprofile").show("slow");}}else{if(this.mode=="updatenode"){$.tree.focused().rename(this.current_node,$("#prof_name").val());$("#newprofile").hide("slow");$("#newprofile").remove();}}}}$("#throbber").remove();}catch(c){}};this.updateRootNode=function(){try{this.mode="updatenode";var f=$("#prof_name").val();var i=$("#prof_type").val();var c=$("#prof_desc").val();var b=$("#prof_active").val();var h={id:this.current_node.id,name:f,type:i,description:c,is_active:b};var d=new EXPERTUS.SMARTPORTAL.ProfileManager();d.initialize(this);d.requestXml=d.generateUpdateProfileRequest(h);$("#newprofile").hide("slow");d.exec(this.current_node);}catch(g){}};this.addNode=function(){try{var b=$.tree.focused();if(b.selected){b.create();}else{alert("select a node first");
}}catch(c){}};this.saveNode=function(b){try{var j=$.tree.focused();var d=$("#prof_name").val();var i=$("#prof_type").val();var h=$("#prof_desc").val();var k=$("#prof_active").val();var c={data:d,name:d,type:i,description:h,is_active:k,level:"1"};this.mode="createnode";var f=new EXPERTUS.SMARTPORTAL.ProfileManager();f.initialize(this);f.requestXml=f.generateCreateRequest(c);j.create(c,this.current_node,this.type);f.exec(this.current_node);$("#newprofile").hide("slow");$("#newprofile").remove();}catch(g){}};}catch(a){}};$.extend(EXPERTUS.SMARTPORTAL.ProfileWidget.prototype,EXPERTUS.SMARTPORTAL.AbstractDetailsWidget);function callprofiledetail(){try{var a=new EXPERTUS.SMARTPORTAL.ProfileWidget();a.setUniqueWidgetId("ProfileService");a.setWidgetObject(a);a.setWidgetTitle("Profile Master");a.render({id:"ProfileService"});}catch(b){}}function getLevel(c,a,f){try{var b=a.parent(c);if(b==false||b==-1){return f+1;}return getLevel(b,a,f+1);}catch(d){}}function renNode(){try{var a=$.tree.focused();
if(a.selected){a.rename();}else{alert("select a node first");}}catch(b){}}function deleteNode(){try{var a=$.tree.focused();if(a.selected){a.remove();}else{alert("select a node first");}}catch(b){}}