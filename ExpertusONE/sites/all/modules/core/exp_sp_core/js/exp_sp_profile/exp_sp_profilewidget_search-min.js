registernamespace("EXPERTUS.SMARTPORTAL.ProfileManager");EXPERTUS.SMARTPORTAL.ProfileManager=function(){try{this.generateCreateRequest=function(f){try{var c=new Object();c.query=new SOAPObject("InsertProfile").attr("xsi:type","null");c.query.appendChild(new SOAPObject("parent_id").attr("xsi:type","null").val(f.parent_id));c.query.appendChild(new SOAPObject("level").attr("xsi:type","null").val(f.level));c.query.appendChild(new SOAPObject("name").attr("xsi:type","null").val(f.name));c.query.appendChild(new SOAPObject("description").attr("xsi:type","null").val(f.description));c.query.appendChild(new SOAPObject("type").attr("xsi:type","null").val(f.type));c.query.appendChild(new SOAPObject("is_active").attr("xsi:type","null").val(f.is_active));var b=new SOAPRequest("InsertProfile",c);b="<?xml version='1.0' encoding='UTF-8'?>"+b;b=b.toString();return b;}catch(d){}};this.generateProfileRequest=function(f){try{var c=new Object();c.query=new SOAPObject("GetProfile").attr("xsi:type","null");c.query.appendChild(new SOAPObject("dummy").attr("xsi:type","null").val(""));
var b=new SOAPRequest("GetProfile",c);b="<?xml version='1.0' encoding='UTF-8'?>"+b;b=b.toString();return b;}catch(d){}};this.generateProfileDetsRequest=function(f){try{var c=new Object();c.query=new SOAPObject("GetProfileDets").attr("xsi:type","null");c.query.appendChild(new SOAPObject("id").attr("xsi:type","null").val(f.id));var b=new SOAPRequest("GetProfile",c);b="<?xml version='1.0' encoding='UTF-8'?>"+b;b=b.toString();return b;}catch(d){}};this.generateRenameProfileRequest=function(f){try{var c=new Object();c.query=new SOAPObject("RenameProfile").attr("xsi:type","null");c.query.appendChild(new SOAPObject("id").attr("xsi:type","null").val(f.id));c.query.appendChild(new SOAPObject("newname").attr("xsi:type","null").val(f.newname));c.query.appendChild(new SOAPObject("level").attr("xsi:type","null").val(f.level));var b=new SOAPRequest("RenameProfile",c);b="<?xml version='1.0' encoding='UTF-8'?>"+b;b=b.toString();return b;}catch(d){}};this.generateDeleteProfileRequest=function(f){try{var c=new Object();
c.query=new SOAPObject("DeleteProfile").attr("xsi:type","null");c.query.appendChild(new SOAPObject("id").attr("xsi:type","null").val(f.id));c.query.appendChild(new SOAPObject("level").attr("xsi:type","null").val(f.level));var b=new SOAPRequest("DeleteProfile",c);b="<?xml version='1.0' encoding='UTF-8'?>"+b;b=b.toString();return b;}catch(d){}};this.generateUpdateProfileRequest=function(f){try{var c=new Object();c.query=new SOAPObject("UpdateProfile").attr("xsi:type","null");c.query.appendChild(new SOAPObject("id").attr("xsi:type","null").val(f.id));c.query.appendChild(new SOAPObject("name").attr("xsi:type","null").val(f.name));c.query.appendChild(new SOAPObject("description").attr("xsi:type","null").val(f.description));c.query.appendChild(new SOAPObject("type").attr("xsi:type","null").val(f.type));c.query.appendChild(new SOAPObject("is_active").attr("xsi:type","null").val(f.is_active));var b=new SOAPRequest("UpdateProfile",c);b="<?xml version='1.0' encoding='UTF-8'?>"+b;b=b.toString();return b;
}catch(d){}};this.generateProfileByTypeRequest=function(f){try{var c=new Object();c.query=new SOAPObject("getProfileByType").attr("xsi:type","null");c.query.appendChild(new SOAPObject("type").attr("xsi:type","null").val(f.type));var b=new SOAPRequest("getProfileByType",c);b="<?xml version='1.0' encoding='UTF-8'?>"+b;b=b.toString();return b;}catch(d){}};this.exec=function(c){try{var b="<img src='sites/"+resourse.admin_site_name+"/modules/jquery_update/jstree/source/themes/classic/throbber.gif' id='throbber'/>";$(c).find("a:first").after(b);this.execute();}catch(d){}};}catch(a){}};$.extend(EXPERTUS.SMARTPORTAL.ProfileManager.prototype,EXPERTUS.SMARTPORTAL.AbstractManager);registernamespace("EXPERTUS.SMARTPORTAL.ProfileWidget");EXPERTUS.SMARTPORTAL.ProfileWidget=function(){try{this.widgetGlobalName="EXPERTUS.SMARTPORTAL.ProfileWidget";this.mode="";this.current_node;this.created=0;this.tree;this.level;this.type;this.render=function(d){try{var b="<div id='"+this.getUniqueWidgetId()+"profilemain' style='width:700px;'></div><div id='"+this.getUniqueWidgetId()+"profilecontent'></div><div id='"+this.getUniqueWidgetId()+"languagecontent'></div>";
this.renderBase(d,this);this.bodyHtml=this.mapper(d);$("#"+this.getUniqueWidgetId()).html(this.bodyHtml);paramObj={searchServiceWidgetId:d.id,searchParams:[{title:SMARTPORTAL.t("Profile Name"),key:"prof_name",autocomplete_type:"location"},{title:SMARTPORTAL.t("Type"),key:"prof_type",autocomplete_type:"location"}],searchParamsDivId:this.getUniqueWidgetId()+"Search",searchResults:{colNames:[{title:"Profile Type ID",sort:true,filter:true},{title:"Profile Type Name",sort:true,filter:true},{title:"Profile Value ID",sort:true,filter:true},{title:"Profile Value",sort:true,filter:true},{title:"Actions",sort:false,filter:false}],colModel:[{xmlmap:"profiletype_id",width:200,align:"left"},{xmlmap:"profiletype_name",width:150,align:"center"},{xmlmap:"profilevalue_name",width:100,align:"center"},{xmlmap:"profilevalue_id",width:100,align:"center"}],height:320,width:700},searchResultsDivId:this.getUniqueWidgetId()+"Details",parentWidgetObj:this.widgetGlobalName,childView:false,actionView:true,searchConfig:{advanced:false,faq:false},parentWidgetUniqueId:this.getUniqueWidgetId()};
callSearchWidget(paramObj);}catch(c){}};this.mapper=function(c){var b="<div id='"+c.id+"Search'></div>";b+="<div id='"+c.id+"AdditionalDetails'><a href='javascript:void(0)' onclick='"+this.getWidgetInstanceName()+".displayAddResourceLocationDetails();'>"+SMARTPORTAL.t("Configure Profile Tree")+"</a></div>";b+="<div id='"+c.id+"Details'></div>";return b;};this.showTree=function(){try{var f=this;var b=$(this.responseText).find("GetProfileResponse").text();var h;$("#"+this.getUniqueWidgetId()+"profilemain").tree({callback:{beforecreate:function(k,e,j,i){f.current_node=e;f.tree=i;f.type=j;h=getLevel(e,i,-1);f.level=h;if((h==0||(h==1&&j!="inside"))&&f.mode!="createnode"){f.mode="createnode";f.showDialog();return false;}else{f.mode="createnode";return true;}},oncreate:function(i,e,j){f.created=1;f.current_node=i;},beforerename:function(j,k,i){if(f.mode=="createnode"){return true;}if(f.mode=="updatenode"){f.mode="";return true;}f.mode="renamenode";f.current_node=j;h=getLevel(j,i,-1);f.level=h;
if(h==1){var e=new EXPERTUS.SMARTPORTAL.ProfileManager();e.initialize(f);e.requestXml=e.generateProfileDetsRequest({id:j.id});e.exec(j);return false;}else{return true;}},onrename:function(k,i,l){h=getLevel(k,i,-1);if(f.created==1){f.created=0;var j=i.parent(k);var m={parent_id:$(j).attr("id"),level:h,name:i.get_text(k),description:"test"};f.mode="createnode";var e=new EXPERTUS.SMARTPORTAL.ProfileManager();e.initialize(f);e.requestXml=e.generateCreateRequest(m);e.exec(k);}else{if(f.level==1){return;}else{var j=i.parent(k);var m={id:k.id,newname:i.get_text(k),level:h};f.mode="renamenode";var e=new EXPERTUS.SMARTPORTAL.ProfileManager();e.initialize(f);e.requestXml=e.generateRenameProfileRequest(m);e.exec(k);}}},beforedelete:function(i,e,j){h=getLevel(i,e,-1);this.current_node=e.parent(i);return true;},ondelete:function(j,i,k){var l={id:j.id,level:h};f.mode="deletenode";var e=new EXPERTUS.SMARTPORTAL.ProfileManager();e.initialize(f);e.requestXml=e.generateDeleteProfileRequest(l);e.exec(this.current_node);
},check_move:function(k,e,j,i,l){return false;},onmove:function(k,e,j,i,l){alert(i.get_text(k)+" "+j+" "+i.get_text(e));}},data:{type:"xml_flat",opts:{"static":b}}});$("#"+this.getUniqueWidgetId()+"profilemain").append('<div style="clear:both;padding:20px;">');$("#"+this.getUniqueWidgetId()+"profilemain").append('<input type="button" value="Add" onclick="'+this.getWidgetInstanceName()+'.addNode();" />');$("#"+this.getUniqueWidgetId()+"profilemain").append('<input type="button" value="Edit" onclick="renNode();" />');$("#"+this.getUniqueWidgetId()+"profilemain").append('<input type="button" value="Delete" onclick="deleteNode();" />');$("#"+this.getUniqueWidgetId()+"profilemain").append("</div>");var c=$.tree.focused;var g;}catch(d){}};this.test=function(){try{var b=new EXPERTUS.SMARTPORTAL.ProfileManager();b.initialize(this);b.requestXml=b.generateProfileByTypeRequest({type:"1"});b.execute();}catch(c){}};this.showDialog=function(){try{var d=$.tree.focused();var b=getLevel(this.current_node,$.tree.focused(),-1);
var c='<div id="newprofile" style="display:none;padding:5px 0;"><table><tr><td>'+SMARTPORTAL.t("Name :")+'</td><td><input type="text" id="prof_name" size="10"/></td>';c+="<td>"+SMARTPORTAL.t("Type : ")+'</td><td><select id="prof_type"><option value="1">1</option><option value="2">2</option><option value="3">3</option></select></td></tr>';c+="<tr><td>"+SMARTPORTAL.t("Description :")+'</td><td><input type="text" id="prof_desc" value="" /></td>';c+="<td>"+SMARTPORTAL.t("Active :")+'</td><td><select id="prof_active"><option value="Y">'+SMARTPORTAL.t("Yes")+'</option><option value="N">'+SMARTPORTAL.t("No")+"</option></select></td></tr>";c+='<tr><td colspan="2" align="center"><input type="button" value="'+SMARTPORTAL.t("Save")+'" onclick="'+this.getWidgetInstanceName();saveNode(b);+'" /></td><td colspan="2"><input type="button" value="'+SMARTPORTAL.t("Close")+'" onclick="$("#newprofile").remove();"/></td></tr></table></div>';$("#R").append(c);$("#newprofile").show("slow");}catch(f){}};this.renderError=function(){try{alert(this.responseText);
}catch(b){}};this.renderResults=function(){try{if(this.mode=="getprofile"){this.showTree();}else{if(this.mode=="createnode"){this.current_node.id=$(this.responseText).find("InsertProfileResponse").text();this.mode="";}else{if(this.mode=="renamenode"){if(this.level==1){var b='<div id="newprofile" style="display:none;padding:5px 0;"><table><tr><td>'+SMARTPORTAL.t("Name :")+'</td><td><input type="text" id="prof_name" size="10"/></td>';b+="<td>"+SMARTPORTAL.t("Type : ")+'</td><td><select id="prof_type"><option value="1">1</option><option value="2">2</option><option value="3">3</option></select></td></tr>';b+="<tr><td>"+SMARTPORTAL.t("Description :")+'</td><td><input type="text" id="prof_desc" value="" /></td>';b+="<td>"+SMARTPORTAL.t("Active :")+'</td><td><select id="prof_active"><option value="Y">'+SMARTPORTAL.t("Yes")+'</option><option value="N">'+SMARTPORTAL.t("No")+"</option></select></td></tr>";b+='<tr><td colspan="2" align="center"><input type="button" value="'+SMARTPORTAL.t("Save")+'" onclick="'+this.getWidgetInstanceName();
updateRootNode();+'" /></td><td colspan="2"><input type="button" value="'+SMARTPORTAL.t("Close")+'" onclick="$("#newprofile").remove();"/></td></tr></table></div>';$("#newprofile").remove();$("#"+this.current_node.id).append(b);$("#prof_name").val($(this.responseText).find("name").text());$("#prof_desc").val($(this.responseText).find("description").text());$("#prof_active").val($(this.responseText).find("is_active").text());$("#prof_type").val($(this.responseText).find("type").text());$("#newprofile").show("slow");}}else{if(this.mode=="updatenode"){$.tree.focused().rename(this.current_node,$("#prof_name").val());$("#newprofile").hide("slow");$("#newprofile").remove();}}}}$("#throbber").remove();}catch(c){}};this.updateRootNode=function(){try{this.mode="updatenode";var f=$("#prof_name").val();var i=$("#prof_type").val();var c=$("#prof_desc").val();var b=$("#prof_active").val();var h={id:this.current_node.id,name:f,type:i,description:c,is_active:b};var d=new EXPERTUS.SMARTPORTAL.ProfileManager();
d.initialize(this);d.requestXml=d.generateUpdateProfileRequest(h);$("#newprofile").hide("slow");d.exec(this.current_node);}catch(g){}};this.addNode=function(d){try{var b=$.tree.focused();if(b.selected){b.create();}else{alert("select a node first");}}catch(c){}};this.saveNode=function(b){try{var j=$.tree.focused();var d=$("#prof_name").val();var i=$("#prof_type").val();var h=$("#prof_desc").val();var k=$("#prof_active").val();var c={data:d,name:d,type:i,description:h,is_active:k,level:"1"};this.mode="createnode";var f=new EXPERTUS.SMARTPORTAL.ProfileManager();f.initialize(this);f.requestXml=f.generateCreateRequest(c);j.create(c,this.current_node,this.type);f.exec(this.current_node);$("#newprofile").hide("slow");$("#newprofile").remove();}catch(g){}};}catch(a){}};$.extend(EXPERTUS.SMARTPORTAL.ProfileWidget.prototype,EXPERTUS.SMARTPORTAL.AbstractDetailsWidget);function callprofiledetail(){try{var a=new EXPERTUS.SMARTPORTAL.ProfileWidget();a.setUniqueWidgetId("ProfileService");a.setWidgetObject(a);
a.setWidgetTitle("Profile Master");a.render({id:"ProfileService"});}catch(b){}}function getLevel(c,a,f){try{var b=a.parent(c);if(b==false||b==-1){return f+1;}return getLevel(b,a,f+1);}catch(d){}}function renNode(){try{var a=$.tree.focused();if(a.selected){a.rename();}else{alert(SMARTPORTAL.t("select a node first"));}}catch(b){}}function deleteNode(){try{var a=$.tree.focused();if(a.selected){a.remove();}else{alert(SMARTPORTAL.t("select a node first"));}}catch(b){}}